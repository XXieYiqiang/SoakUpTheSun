{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"C:/Users/Administrator/Desktop/GimChat/gimChatVue/node_modules/@babel/runtime/helpers/interopRequireDefault.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _index = _interopRequireDefault(require(\"@/store/index.js\"));\n// import VideoPlayer from './VideoPlayer.vue'\nvar _default = exports.default = {\n  name: 'VideoPreview',\n  components: {\n    // VideoPlayer\n  },\n  data() {\n    return {\n      visible: false,\n      activeIndex: 0,\n      isFoldVideoList: false,\n      customOptions: {\n        autoplay: true,\n        muted: true,\n        fluid: true // 建议开启，让video.js自适应容器大小\n      }\n    };\n  },\n  computed: {\n    activeFileObj() {\n      return this.videoList.length ? this.videoList[this.activeIndex] : {};\n    },\n    activeVideoSource() {\n      console.log('this.activeIndex=', this.activeIndex);\n      console.log('activeVideoSource==', this.videoList);\n      console.log('type=', `video/${this.videoList[this.activeIndex].extendName}`);\n      console.log('src=', this.videoList[this.activeIndex].fileUrl);\n\n      // 增加非空校验防止报错\n      if (!this.videoList || !this.videoList[this.activeIndex]) return {};\n      return {\n        type: `video/${this.videoList[this.activeIndex].extendName}`,\n        // src: this.videoList[this.activeIndex].fileUrl\n        src: 'http://127.0.0.1:9876/upload/20251203/32e1f79b588ddb5b8f600054b5a322b5.mp4'\n      };\n    },\n    screenWidth() {\n      return _index.default.state.common.screenWidth;\n    }\n  },\n  watch: {\n    visible(newValue) {\n      if (newValue) {\n        // 确保 activeIndex 不越界\n        this.activeIndex = typeof this.defaultIndex === 'number' ? this.defaultIndex : 0;\n      }\n    },\n    screenWidth(newValue) {\n      if (newValue <= 768) {\n        this.isFoldVideoList = true;\n      }\n    }\n  },\n  mounted() {\n    console.log('activeVideoSource=-xxxxx', this.activeVideoSource);\n    if (this.screenWidth <= 768) {\n      this.isFoldVideoList = true;\n    }\n  },\n  methods: {\n    handleClosePreview() {\n      this.visible = false;\n      this.callback && this.callback('cancel');\n    }\n  }\n};","map":{"version":3,"names":["_index","_interopRequireDefault","require","_default","exports","default","name","components","data","visible","activeIndex","isFoldVideoList","customOptions","autoplay","muted","fluid","computed","activeFileObj","videoList","length","activeVideoSource","console","log","extendName","fileUrl","type","src","screenWidth","store","state","common","watch","newValue","defaultIndex","mounted","methods","handleClosePreview","callback"],"sources":["src/components/file/box/videoPreview/BoxMask.vue"],"sourcesContent":["<template>\r\n  <transition name=\"el-zoom-in-top\">\r\n    <div class=\"video-preview-wrapper\" v-show=\"visible\">\r\n      <div class=\"top-bar\">\r\n        <div class=\"file-info\">\r\n          <span class=\"file-name\" :title=\"`${activeFileObj.fileName}.${activeFileObj.extendName}`\">\r\n            {{ activeFileObj.fileName }}.{{ activeFileObj.extendName }}\r\n          </span>\r\n          <span class=\"file-size\">{{ $file.calculateFileSize(activeFileObj.fileSize) }}</span>\r\n        </div>\r\n\r\n        <div class=\"action-group\">\r\n          <a class=\"action-btn\" :href=\"$file.getDownloadFilePath(activeFileObj)\" target=\"_blank\">\r\n            <i class=\"el-icon-download\" title=\"下载\"></i>\r\n          </a>\r\n          <div class=\"action-btn\" @click=\"isFoldVideoList = !isFoldVideoList\">\r\n            <i :class=\"isFoldVideoList ? 'el-icon-s-fold' : 'el-icon-s-unfold'\"\r\n              :title=\"isFoldVideoList ? '展开列表' : '折叠列表'\"></i>\r\n          </div>\r\n          <div class=\"action-btn close-btn\" @click=\"handleClosePreview\">\r\n            <i class=\"el-icon-close\" title=\"关闭\"></i>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"main-content\">\r\n        <div class=\"player-container\">\r\n          <video-player class=\"video-player-instance\" ref=\"VideoPlayer\" :source=\"activeVideoSource\"\r\n            :options=\"customOptions\" v-if=\"visible\">\r\n          </video-player>\r\n        </div>\r\n\r\n        <el-collapse-transition>\r\n          <div class=\"playlist-sidebar\" v-show=\"!isFoldVideoList\">\r\n            <div class=\"list-header\">\r\n              <span>播放列表</span>\r\n              <span class=\"list-count\">({{ videoList.length }})</span>\r\n            </div>\r\n            <ul class=\"video-list\">\r\n              <li class=\"video-item\" v-for=\"(item, index) in videoList\" :key=\"index\"\r\n                :class=\"{ 'is-active': activeIndex === index }\" @click=\"activeIndex = index\">\r\n\r\n                <div class=\"item-icon\">\r\n                  <i class=\"el-icon-video-play\" v-if=\"activeIndex === index\"></i>\r\n                  <i class=\"el-icon-video-camera\" v-else></i>\r\n                </div>\r\n\r\n                <div class=\"item-info\">\r\n                  <div class=\"name\" :title=\"`${item.fileName}.${item.extendName}`\">\r\n                    {{ item.fileName }}.{{ item.extendName }}\r\n                  </div>\r\n                  <div class=\"size\">{{ $file.calculateFileSize(item.fileSize) }}</div>\r\n                </div>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </el-collapse-transition>\r\n      </div>\r\n    </div>\r\n  </transition>\r\n</template>\r\n\r\n<script>\r\n// import VideoPlayer from './VideoPlayer.vue'\r\nimport store from '@/store/index.js'\r\n\r\nexport default {\r\n  name: 'VideoPreview',\r\n  components: {\r\n    // VideoPlayer\r\n  },\r\n  data() {\r\n    return {\r\n      visible: false,\r\n      activeIndex: 0,\r\n      isFoldVideoList: false,\r\n      customOptions: {\r\n        autoplay: true,\r\n        muted: true,\r\n        fluid: true // 建议开启，让video.js自适应容器大小\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    activeFileObj() {\r\n      return this.videoList.length ? this.videoList[this.activeIndex] : {}\r\n    },\r\n    activeVideoSource() {\r\n      console.log('this.activeIndex=',this.activeIndex)\r\n      console.log('activeVideoSource==', this.videoList)\r\n\r\n      console.log('type=', `video/${this.videoList[this.activeIndex].extendName}`)\r\n\r\n      console.log('src=', this.videoList[this.activeIndex].fileUrl)\r\n\r\n      // 增加非空校验防止报错\r\n      if (!this.videoList || !this.videoList[this.activeIndex]) return {}\r\n\r\n      return {\r\n        type: `video/${this.videoList[this.activeIndex].extendName}`,\r\n        // src: this.videoList[this.activeIndex].fileUrl\r\n        src: 'http://127.0.0.1:9876/upload/20251203/32e1f79b588ddb5b8f600054b5a322b5.mp4'\r\n      }\r\n    },\r\n    screenWidth() {\r\n      return store.state.common.screenWidth\r\n    }\r\n  },\r\n  watch: {\r\n    visible(newValue) {\r\n      if (newValue) {\r\n        // 确保 activeIndex 不越界\r\n        this.activeIndex = typeof this.defaultIndex === 'number' ? this.defaultIndex : 0\r\n      }\r\n    },\r\n    screenWidth(newValue) {\r\n      if (newValue <= 768) {\r\n        this.isFoldVideoList = true\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    console.log('activeVideoSource=-xxxxx',this.activeVideoSource)\r\n    if (this.screenWidth <= 768) {\r\n      this.isFoldVideoList = true\r\n    }\r\n  },\r\n  methods: {\r\n    handleClosePreview() {\r\n      this.visible = false\r\n      this.callback && this.callback('cancel')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n/* 定义本地变量，替代外部引入 */\r\n@primary-color: #409EFF; // 主题色\r\n@bg-overlay: rgba(20, 20, 20, 0.98); // 整体遮罩背景\r\n@bg-sidebar: #1f1f1f; // 侧边栏背景\r\n@text-main: #ffffff; // 主要文字\r\n@text-sub: #909399; // 次要文字\r\n@border-color: rgba(255, 255, 255, 0.1); // 边框颜色\r\n\r\n.video-preview-wrapper {\r\n  background: @bg-overlay;\r\n  backdrop-filter: blur(10px);\r\n  /* 毛玻璃效果 */\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  z-index: 9999;\r\n  display: flex;\r\n  flex-direction: column;\r\n\r\n  /* 顶部栏样式 */\r\n  .top-bar {\r\n    height: 60px;\r\n    /* 增加高度 */\r\n    background: rgba(0, 0, 0, 0.3);\r\n    border-bottom: 1px solid @border-color;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    padding: 0 24px;\r\n    flex-shrink: 0;\r\n    /* 防止被压缩 */\r\n\r\n    .file-info {\r\n      display: flex;\r\n      align-items: baseline;\r\n      overflow: hidden;\r\n\r\n      .file-name {\r\n        font-size: 18px;\r\n        color: @text-main;\r\n        font-weight: 500;\r\n        margin-right: 12px;\r\n        max-width: 500px;\r\n        white-space: nowrap;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n      }\r\n\r\n      .file-size {\r\n        font-size: 12px;\r\n        color: @text-sub;\r\n      }\r\n    }\r\n\r\n    .action-group {\r\n      display: flex;\r\n      align-items: center;\r\n\r\n      .action-btn {\r\n        width: 36px;\r\n        height: 36px;\r\n        border-radius: 50%;\r\n        /* 圆形按钮 */\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        margin-left: 12px;\r\n        cursor: pointer;\r\n        transition: all 0.3s;\r\n        text-decoration: none; // 针对a标签\r\n\r\n        i {\r\n          font-size: 20px;\r\n          color: #ddd;\r\n        }\r\n\r\n        &:hover {\r\n          background: rgba(255, 255, 255, 0.15);\r\n\r\n          i {\r\n            color: #fff;\r\n          }\r\n        }\r\n\r\n        /* 关闭按钮特殊样式 */\r\n        &.close-btn:hover {\r\n          background: #f56c6c;\r\n\r\n          i {\r\n            color: #fff;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /* 底部主体内容 */\r\n  .main-content {\r\n    flex: 1;\r\n    /* 占据剩余高度 */\r\n    display: flex;\r\n    overflow: hidden;\r\n    /* 防止出现双滚动条 */\r\n\r\n    .player-container {\r\n      flex: 1;\r\n      height: 100%;\r\n      background: #000;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      position: relative;\r\n\r\n      .video-player-instance {\r\n        width: 100%;\r\n        height: 100%;\r\n\r\n        /* 深度选择器确保 video.js 填满容器 */\r\n        /deep/ .video-js {\r\n          width: 100%;\r\n          height: 100%;\r\n        }\r\n      }\r\n    }\r\n\r\n    /* 播放列表侧边栏 */\r\n    .playlist-sidebar {\r\n      width: 300px;\r\n      background: @bg-sidebar;\r\n      border-left: 1px solid @border-color;\r\n      display: flex;\r\n      flex-direction: column;\r\n      color: @text-main;\r\n\r\n      .list-header {\r\n        height: 50px;\r\n        line-height: 50px;\r\n        padding: 0 16px;\r\n        border-bottom: 1px solid @border-color;\r\n        font-size: 14px;\r\n        font-weight: bold;\r\n        letter-spacing: 1px;\r\n\r\n        .list-count {\r\n          font-weight: normal;\r\n          color: @text-sub;\r\n          font-size: 12px;\r\n          margin-left: 4px;\r\n        }\r\n      }\r\n\r\n      .video-list {\r\n        flex: 1;\r\n        overflow-y: auto;\r\n        padding: 10px;\r\n        list-style: none;\r\n        margin: 0;\r\n\r\n        /* 自定义滚动条样式 (替代 mixin) */\r\n        &::-webkit-scrollbar {\r\n          width: 6px;\r\n        }\r\n\r\n        &::-webkit-scrollbar-thumb {\r\n          background: rgba(255, 255, 255, 0.2);\r\n          border-radius: 3px;\r\n        }\r\n\r\n        &::-webkit-scrollbar-track {\r\n          background: transparent;\r\n        }\r\n\r\n        .video-item {\r\n          display: flex;\r\n          align-items: center;\r\n          padding: 12px;\r\n          margin-bottom: 8px;\r\n          border-radius: 6px;\r\n          cursor: pointer;\r\n          transition: background 0.2s ease;\r\n          border: 1px solid transparent;\r\n          /* 预留边框位置避免抖动 */\r\n\r\n          &:hover {\r\n            background: rgba(255, 255, 255, 0.08);\r\n\r\n            .name {\r\n              color: #fff;\r\n            }\r\n          }\r\n\r\n          /* 选中状态 */\r\n          &.is-active {\r\n            background: rgba(@primary-color, 0.15);\r\n            border-color: rgba(@primary-color, 0.3);\r\n\r\n            .item-icon i {\r\n              color: @primary-color;\r\n            }\r\n\r\n            .item-info .name {\r\n              color: @primary-color;\r\n              font-weight: 500;\r\n            }\r\n          }\r\n\r\n          .item-icon {\r\n            margin-right: 10px;\r\n\r\n            i {\r\n              font-size: 16px;\r\n              color: @text-sub;\r\n            }\r\n          }\r\n\r\n          .item-info {\r\n            flex: 1;\r\n            overflow: hidden;\r\n\r\n            .name {\r\n              font-size: 13px;\r\n              line-height: 1.4;\r\n              color: #ccc;\r\n              margin-bottom: 4px;\r\n              /* 单行省略 */\r\n              white-space: nowrap;\r\n              overflow: hidden;\r\n              text-overflow: ellipsis;\r\n            }\r\n\r\n            .size {\r\n              font-size: 12px;\r\n              color: @text-sub;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>"],"mappings":";;;;;;;AAgEA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AADA;AAAA,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAGA;EACAC,IAAA;EACAC,UAAA;IACA;EAAA,CACA;EACAC,KAAA;IACA;MACAC,OAAA;MACAC,WAAA;MACAC,eAAA;MACAC,aAAA;QACAC,QAAA;QACAC,KAAA;QACAC,KAAA;MACA;IACA;EACA;EACAC,QAAA;IACAC,cAAA;MACA,YAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,MAAAR,WAAA;IACA;IACAU,kBAAA;MACAC,OAAA,CAAAC,GAAA,2BAAAZ,WAAA;MACAW,OAAA,CAAAC,GAAA,6BAAAJ,SAAA;MAEAG,OAAA,CAAAC,GAAA,wBAAAJ,SAAA,MAAAR,WAAA,EAAAa,UAAA;MAEAF,OAAA,CAAAC,GAAA,cAAAJ,SAAA,MAAAR,WAAA,EAAAc,OAAA;;MAEA;MACA,UAAAN,SAAA,UAAAA,SAAA,MAAAR,WAAA;MAEA;QACAe,IAAA,gBAAAP,SAAA,MAAAR,WAAA,EAAAa,UAAA;QACA;QACAG,GAAA;MACA;IACA;IACAC,YAAA;MACA,OAAAC,cAAA,CAAAC,KAAA,CAAAC,MAAA,CAAAH,WAAA;IACA;EACA;EACAI,KAAA;IACAtB,QAAAuB,QAAA;MACA,IAAAA,QAAA;QACA;QACA,KAAAtB,WAAA,eAAAuB,YAAA,qBAAAA,YAAA;MACA;IACA;IACAN,YAAAK,QAAA;MACA,IAAAA,QAAA;QACA,KAAArB,eAAA;MACA;IACA;EACA;EACAuB,QAAA;IACAb,OAAA,CAAAC,GAAA,kCAAAF,iBAAA;IACA,SAAAO,WAAA;MACA,KAAAhB,eAAA;IACA;EACA;EACAwB,OAAA;IACAC,mBAAA;MACA,KAAA3B,OAAA;MACA,KAAA4B,QAAA,SAAAA,QAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}