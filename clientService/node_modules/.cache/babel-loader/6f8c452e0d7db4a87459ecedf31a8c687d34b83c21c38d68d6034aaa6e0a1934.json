{"ast":null,"code":"import Vue from 'vue';\n// 导入上传组件\nimport UploadFile from './Box.vue';\n\n// 创建组件构造器\nconst UploadFileConstructor = Vue.extend(UploadFile);\nlet uploadFileInstance = null;\n\n/**\r\n * 初始化上传组件实例\r\n */\nconst initInstanceUploadFile = () => {\n  uploadFileInstance = new UploadFileConstructor({\n    el: document.createElement('div')\n  });\n};\n\n/**\r\n * 展示上传组件\r\n * @param {Object} obj 参数对象\r\n * @param {Object} obj.params 上传参数（如 headers）\r\n * @param {Number} obj.uploadWay 上传方式 0=文件 1=文件夹 2=粘贴/拖拽\r\n * @param {VueComponent} obj.serviceEl 触发组件实例\r\n * @param {String|Number} obj.callType 调用方式\r\n * @returns Promise\r\n */\nconst showUploadFileBox = obj => {\n  const {\n    params = {},\n    uploadWay = 0,\n    serviceEl = null,\n    callType = ''\n  } = obj;\n  if (uploadFileInstance !== null) {\n    // 已存在，直接复用\n    uploadFileInstance.params = params;\n    uploadFileInstance.uploadWay = uploadWay;\n    uploadFileInstance.serviceEl = serviceEl;\n    uploadFileInstance.callType = callType;\n    uploadFileInstance.handlePrepareUpload();\n    return;\n  }\n\n  // 首次调用，创建实例\n  return new Promise(resolve => {\n    initInstanceUploadFile();\n    uploadFileInstance.params = params;\n    uploadFileInstance.uploadWay = uploadWay;\n    uploadFileInstance.serviceEl = serviceEl;\n    uploadFileInstance.callType = callType;\n    uploadFileInstance.callback = res => {\n      resolve(res);\n      // 取消时移除组件\n      if (res === 'cancel' && uploadFileInstance !== null) {\n        document.body.removeChild(uploadFileInstance.$el);\n        uploadFileInstance = null;\n      }\n    };\n    document.body.appendChild(uploadFileInstance.$el);\n    Vue.nextTick(() => {\n      uploadFileInstance.handlePrepareUpload();\n    });\n  });\n};\nexport default showUploadFileBox;","map":{"version":3,"names":["Vue","UploadFile","UploadFileConstructor","extend","uploadFileInstance","initInstanceUploadFile","el","document","createElement","showUploadFileBox","obj","params","uploadWay","serviceEl","callType","handlePrepareUpload","Promise","resolve","callback","res","body","removeChild","$el","appendChild","nextTick"],"sources":["C:/Users/Administrator/Desktop/GimChat/front/gim-chat/src/components/uploadFile/index.js"],"sourcesContent":["import Vue from 'vue'\r\n// 导入上传组件\r\nimport UploadFile from './Box.vue'\r\n\r\n// 创建组件构造器\r\nconst UploadFileConstructor = Vue.extend(UploadFile)\r\n\r\nlet uploadFileInstance = null\r\n\r\n/**\r\n * 初始化上传组件实例\r\n */\r\nconst initInstanceUploadFile = () => {\r\n\tuploadFileInstance = new UploadFileConstructor({\r\n\t\tel: document.createElement('div')\r\n\t})\r\n}\r\n\r\n/**\r\n * 展示上传组件\r\n * @param {Object} obj 参数对象\r\n * @param {Object} obj.params 上传参数（如 headers）\r\n * @param {Number} obj.uploadWay 上传方式 0=文件 1=文件夹 2=粘贴/拖拽\r\n * @param {VueComponent} obj.serviceEl 触发组件实例\r\n * @param {String|Number} obj.callType 调用方式\r\n * @returns Promise\r\n */\r\nconst showUploadFileBox = (obj) => {\r\n\tconst { params = {}, uploadWay = 0, serviceEl = null, callType = '' } = obj\r\n\r\n\tif (uploadFileInstance !== null) {\r\n\t\t// 已存在，直接复用\r\n\t\tuploadFileInstance.params = params\r\n\t\tuploadFileInstance.uploadWay = uploadWay\r\n\t\tuploadFileInstance.serviceEl = serviceEl\r\n\t\tuploadFileInstance.callType = callType\r\n\t\tuploadFileInstance.handlePrepareUpload()\r\n\t\treturn\r\n\t}\r\n\r\n\t// 首次调用，创建实例\r\n\treturn new Promise((resolve) => {\r\n\t\tinitInstanceUploadFile()\r\n\r\n\t\tuploadFileInstance.params = params\r\n\t\tuploadFileInstance.uploadWay = uploadWay\r\n\t\tuploadFileInstance.serviceEl = serviceEl\r\n\t\tuploadFileInstance.callType = callType\r\n\r\n\t\tuploadFileInstance.callback = (res) => {\r\n\t\t\tresolve(res)\r\n\t\t\t// 取消时移除组件\r\n\t\t\tif (res === 'cancel' && uploadFileInstance !== null) {\r\n\t\t\t\tdocument.body.removeChild(uploadFileInstance.$el)\r\n\t\t\t\tuploadFileInstance = null\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tdocument.body.appendChild(uploadFileInstance.$el)\r\n\t\tVue.nextTick(() => {\r\n\t\t\tuploadFileInstance.handlePrepareUpload()\r\n\t\t})\r\n\t})\r\n}\r\n\r\nexport default showUploadFileBox\r\n"],"mappings":"AAAA,OAAOA,GAAG,MAAM,KAAK;AACrB;AACA,OAAOC,UAAU,MAAM,WAAW;;AAElC;AACA,MAAMC,qBAAqB,GAAGF,GAAG,CAACG,MAAM,CAACF,UAAU,CAAC;AAEpD,IAAIG,kBAAkB,GAAG,IAAI;;AAE7B;AACA;AACA;AACA,MAAMC,sBAAsB,GAAGA,CAAA,KAAM;EACpCD,kBAAkB,GAAG,IAAIF,qBAAqB,CAAC;IAC9CI,EAAE,EAAEC,QAAQ,CAACC,aAAa,CAAC,KAAK;EACjC,CAAC,CAAC;AACH,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,iBAAiB,GAAIC,GAAG,IAAK;EAClC,MAAM;IAAEC,MAAM,GAAG,CAAC,CAAC;IAAEC,SAAS,GAAG,CAAC;IAAEC,SAAS,GAAG,IAAI;IAAEC,QAAQ,GAAG;EAAG,CAAC,GAAGJ,GAAG;EAE3E,IAAIN,kBAAkB,KAAK,IAAI,EAAE;IAChC;IACAA,kBAAkB,CAACO,MAAM,GAAGA,MAAM;IAClCP,kBAAkB,CAACQ,SAAS,GAAGA,SAAS;IACxCR,kBAAkB,CAACS,SAAS,GAAGA,SAAS;IACxCT,kBAAkB,CAACU,QAAQ,GAAGA,QAAQ;IACtCV,kBAAkB,CAACW,mBAAmB,CAAC,CAAC;IACxC;EACD;;EAEA;EACA,OAAO,IAAIC,OAAO,CAAEC,OAAO,IAAK;IAC/BZ,sBAAsB,CAAC,CAAC;IAExBD,kBAAkB,CAACO,MAAM,GAAGA,MAAM;IAClCP,kBAAkB,CAACQ,SAAS,GAAGA,SAAS;IACxCR,kBAAkB,CAACS,SAAS,GAAGA,SAAS;IACxCT,kBAAkB,CAACU,QAAQ,GAAGA,QAAQ;IAEtCV,kBAAkB,CAACc,QAAQ,GAAIC,GAAG,IAAK;MACtCF,OAAO,CAACE,GAAG,CAAC;MACZ;MACA,IAAIA,GAAG,KAAK,QAAQ,IAAIf,kBAAkB,KAAK,IAAI,EAAE;QACpDG,QAAQ,CAACa,IAAI,CAACC,WAAW,CAACjB,kBAAkB,CAACkB,GAAG,CAAC;QACjDlB,kBAAkB,GAAG,IAAI;MAC1B;IACD,CAAC;IAEDG,QAAQ,CAACa,IAAI,CAACG,WAAW,CAACnB,kBAAkB,CAACkB,GAAG,CAAC;IACjDtB,GAAG,CAACwB,QAAQ,CAAC,MAAM;MAClBpB,kBAAkB,CAACW,mBAAmB,CAAC,CAAC;IACzC,CAAC,CAAC;EACH,CAAC,CAAC;AACH,CAAC;AAED,eAAeN,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}