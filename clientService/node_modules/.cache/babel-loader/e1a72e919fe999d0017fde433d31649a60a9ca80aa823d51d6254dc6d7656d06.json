{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n/**\r\n * 消息分发器 （系统 / 用户 / 群组 / 广播）\r\n */\n// store/modules/messageDispatcher.js\nvar _default = exports.default = {\n  namespaced: true,\n  actions: {\n    dispatch({\n      dispatch\n    }, message) {\n      const {\n        type,\n        data\n      } = message;\n      switch (type) {\n        case 'chat':\n          // 普通私聊或群聊消息\n          dispatch('handleChatMessage', data);\n          break;\n        case 'system':\n          // 系统通知\n          dispatch('handleSystemMessage', data);\n          break;\n        case 'broadcast':\n          // 全局广播\n          dispatch('handleBroadcast', data);\n          break;\n        case 'ping':\n          // 可加时间戳响应\n          break;\n        default:\n          console.warn('未知消息类型：', type);\n      }\n    },\n    handleChatMessage({\n      commit,\n      rootState\n    }, data) {\n      const currentId = rootState.chat.currentContactId;\n      const contactId = data.target_type === 'user' ? data.sender_id : data.target_id;\n      commit('message/ADD_MESSAGE', {\n        contactId,\n        message: data\n      }, {\n        root: true\n      });\n\n      // 当前窗口不是这个人/群 → 增加未读\n      if (contactId !== currentId) {\n        commit('message/INCREMENT_UNREAD', contactId, {\n          root: true\n        });\n      }\n    },\n    handleSystemMessage({\n      commit\n    }, data) {\n      // TODO: 可以弹出通知、保存系统消息\n      console.info('系统通知:', data.title || data.content);\n    },\n    handleBroadcast({\n      commit\n    }, data) {\n      // TODO: 广播可记录、也可直接 toast\n      console.info('广播消息:', data);\n    }\n  }\n};","map":{"version":3,"names":["_default","exports","default","namespaced","actions","dispatch","message","type","data","console","warn","handleChatMessage","commit","rootState","currentId","chat","currentContactId","contactId","target_type","sender_id","target_id","root","handleSystemMessage","info","title","content","handleBroadcast"],"sources":["C:/Users/Administrator/Desktop/GimChat/gimChatVue/src/store/module/messageDispatcher.js"],"sourcesContent":["/**\r\n * 消息分发器 （系统 / 用户 / 群组 / 广播）\r\n */\r\n\r\n// store/modules/messageDispatcher.js\r\nexport default {\r\n  namespaced: true,\r\n  actions: {\r\n    dispatch({ dispatch }, message) {\r\n      const { type, data } = message;\r\n\r\n      switch (type) {\r\n        case 'chat':        // 普通私聊或群聊消息\r\n          dispatch('handleChatMessage', data);\r\n          break;\r\n        case 'system':      // 系统通知\r\n          dispatch('handleSystemMessage', data);\r\n          break;\r\n        case 'broadcast':   // 全局广播\r\n          dispatch('handleBroadcast', data);\r\n          break;\r\n        case 'ping':\r\n          // 可加时间戳响应\r\n          break;\r\n        default:\r\n          console.warn('未知消息类型：', type);\r\n      }\r\n    },\r\n\r\n    handleChatMessage({ commit, rootState }, data) {\r\n      const currentId = rootState.chat.currentContactId;\r\n      const contactId = data.target_type === 'user' ? data.sender_id : data.target_id;\r\n\r\n      commit('message/ADD_MESSAGE', { contactId, message: data }, { root: true });\r\n\r\n      // 当前窗口不是这个人/群 → 增加未读\r\n      if (contactId !== currentId) {\r\n        commit('message/INCREMENT_UNREAD', contactId, { root: true });\r\n      }\r\n    },\r\n\r\n    handleSystemMessage({ commit }, data) {\r\n      // TODO: 可以弹出通知、保存系统消息\r\n      console.info('系统通知:', data.title || data.content);\r\n    },\r\n\r\n    handleBroadcast({ commit }, data) {\r\n      // TODO: 广播可记录、也可直接 toast\r\n      console.info('广播消息:', data);\r\n    }\r\n  }\r\n}\r\n"],"mappings":";;;;;;AAAA;AACA;AACA;AAEA;AAAA,IAAAA,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACe;EACbC,UAAU,EAAE,IAAI;EAChBC,OAAO,EAAE;IACPC,QAAQA,CAAC;MAAEA;IAAS,CAAC,EAAEC,OAAO,EAAE;MAC9B,MAAM;QAAEC,IAAI;QAAEC;MAAK,CAAC,GAAGF,OAAO;MAE9B,QAAQC,IAAI;QACV,KAAK,MAAM;UAAS;UAClBF,QAAQ,CAAC,mBAAmB,EAAEG,IAAI,CAAC;UACnC;QACF,KAAK,QAAQ;UAAO;UAClBH,QAAQ,CAAC,qBAAqB,EAAEG,IAAI,CAAC;UACrC;QACF,KAAK,WAAW;UAAI;UAClBH,QAAQ,CAAC,iBAAiB,EAAEG,IAAI,CAAC;UACjC;QACF,KAAK,MAAM;UACT;UACA;QACF;UACEC,OAAO,CAACC,IAAI,CAAC,SAAS,EAAEH,IAAI,CAAC;MACjC;IACF,CAAC;IAEDI,iBAAiBA,CAAC;MAAEC,MAAM;MAAEC;IAAU,CAAC,EAAEL,IAAI,EAAE;MAC7C,MAAMM,SAAS,GAAGD,SAAS,CAACE,IAAI,CAACC,gBAAgB;MACjD,MAAMC,SAAS,GAAGT,IAAI,CAACU,WAAW,KAAK,MAAM,GAAGV,IAAI,CAACW,SAAS,GAAGX,IAAI,CAACY,SAAS;MAE/ER,MAAM,CAAC,qBAAqB,EAAE;QAAEK,SAAS;QAAEX,OAAO,EAAEE;MAAK,CAAC,EAAE;QAAEa,IAAI,EAAE;MAAK,CAAC,CAAC;;MAE3E;MACA,IAAIJ,SAAS,KAAKH,SAAS,EAAE;QAC3BF,MAAM,CAAC,0BAA0B,EAAEK,SAAS,EAAE;UAAEI,IAAI,EAAE;QAAK,CAAC,CAAC;MAC/D;IACF,CAAC;IAEDC,mBAAmBA,CAAC;MAAEV;IAAO,CAAC,EAAEJ,IAAI,EAAE;MACpC;MACAC,OAAO,CAACc,IAAI,CAAC,OAAO,EAAEf,IAAI,CAACgB,KAAK,IAAIhB,IAAI,CAACiB,OAAO,CAAC;IACnD,CAAC;IAEDC,eAAeA,CAAC;MAAEd;IAAO,CAAC,EAAEJ,IAAI,EAAE;MAChC;MACAC,OAAO,CAACc,IAAI,CAAC,OAAO,EAAEf,IAAI,CAAC;IAC7B;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}