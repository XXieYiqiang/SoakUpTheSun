{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"C:/Users/Administrator/Desktop/GimChat/gimChatVue/node_modules/@babel/runtime/helpers/interopRequireDefault.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _vue = _interopRequireDefault(require(\"vue\"));\nvar _BoxMask = _interopRequireDefault(require(\"./BoxMask.vue\"));\n// 导入组件\n\n// 使用基础 Vue 构造器，创建一个“子类”\nconst VideoPreviewConstructor = _vue.default.extend(_BoxMask.default);\nlet videoPreviewInstance = null;\n/**\r\n * 初始化视频预览实例\r\n * @param {string} videoList 视频列表\r\n * @param {object} defaultIndex 当前查看的视频索引\r\n */\nconst initInstanceVideoPreview = (videoList, defaultIndex) => {\n  videoPreviewInstance = new VideoPreviewConstructor({\n    el: document.createElement('div'),\n    data() {\n      return {\n        videoList,\n        defaultIndex\n      };\n    }\n  });\n};\n/**\r\n * 视频预览 Promise 函数\r\n * @returns {Promise} 抛出确认和取消回调函数\r\n */\nconst showVideoPreviewBox = obj => {\n  // 非首次调用服务时，在 DOM 中移除上个实例\n  if (videoPreviewInstance !== null) {\n    document.body.removeChild(videoPreviewInstance.$el);\n  }\n  let {\n    videoList,\n    defaultIndex\n  } = obj;\n  return new Promise(reslove => {\n    initInstanceVideoPreview(videoList, defaultIndex);\n    videoPreviewInstance.callback = res => {\n      reslove(res);\n      // 服务取消时卸载 DOM\n      if (res === 'cancel' && videoPreviewInstance !== null) {\n        document.body.removeChild(videoPreviewInstance.$el);\n        videoPreviewInstance = null;\n      }\n    };\n    document.body.appendChild(videoPreviewInstance.$el); //  挂载 DOM\n    _vue.default.nextTick(() => {\n      videoPreviewInstance.visible = true; //  打开视频预览遮罩层\n    });\n  });\n};\nvar _default = exports.default = showVideoPreviewBox;","map":{"version":3,"names":["_vue","_interopRequireDefault","require","_BoxMask","VideoPreviewConstructor","Vue","extend","VideoPreview","videoPreviewInstance","initInstanceVideoPreview","videoList","defaultIndex","el","document","createElement","data","showVideoPreviewBox","obj","body","removeChild","$el","Promise","reslove","callback","res","appendChild","nextTick","visible","_default","exports","default"],"sources":["C:/Users/Administrator/Desktop/GimChat/gimChatVue/src/components/file/box/videoPreview/index.js"],"sourcesContent":["import Vue from 'vue'\r\n// 导入组件\r\nimport VideoPreview from './BoxMask.vue'\r\n// 使用基础 Vue 构造器，创建一个“子类”\r\nconst VideoPreviewConstructor = Vue.extend(VideoPreview)\r\n\r\nlet videoPreviewInstance = null\r\n/**\r\n * 初始化视频预览实例\r\n * @param {string} videoList 视频列表\r\n * @param {object} defaultIndex 当前查看的视频索引\r\n */\r\nconst initInstanceVideoPreview = (videoList, defaultIndex) => {\r\n\tvideoPreviewInstance = new VideoPreviewConstructor({\r\n\t\tel: document.createElement('div'),\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tvideoList,\r\n\t\t\t\tdefaultIndex\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n}\r\n/**\r\n * 视频预览 Promise 函数\r\n * @returns {Promise} 抛出确认和取消回调函数\r\n */\r\nconst showVideoPreviewBox = (obj) => {\r\n\t// 非首次调用服务时，在 DOM 中移除上个实例\r\n\tif (videoPreviewInstance !== null) {\r\n\t\tdocument.body.removeChild(videoPreviewInstance.$el)\r\n\t}\r\n\tlet { videoList, defaultIndex } = obj\r\n\treturn new Promise((reslove) => {\r\n\t\tinitInstanceVideoPreview(videoList, defaultIndex)\r\n\t\tvideoPreviewInstance.callback = (res) => {\r\n\t\t\treslove(res)\r\n\t\t\t// 服务取消时卸载 DOM\r\n\t\t\tif (res === 'cancel' && videoPreviewInstance !== null) {\r\n\t\t\t\tdocument.body.removeChild(videoPreviewInstance.$el)\r\n\t\t\t\tvideoPreviewInstance = null\r\n\t\t\t}\r\n\t\t}\r\n\t\tdocument.body.appendChild(videoPreviewInstance.$el) //  挂载 DOM\r\n\t\tVue.nextTick(() => {\r\n\t\t\tvideoPreviewInstance.visible = true //  打开视频预览遮罩层\r\n\t\t})\r\n\t})\r\n}\r\n\r\nexport default showVideoPreviewBox\r\n"],"mappings":";;;;;;;AAAA,IAAAA,IAAA,GAAAC,sBAAA,CAAAC,OAAA;AAEA,IAAAC,QAAA,GAAAF,sBAAA,CAAAC,OAAA;AADA;;AAEA;AACA,MAAME,uBAAuB,GAAGC,YAAG,CAACC,MAAM,CAACC,gBAAY,CAAC;AAExD,IAAIC,oBAAoB,GAAG,IAAI;AAC/B;AACA;AACA;AACA;AACA;AACA,MAAMC,wBAAwB,GAAGA,CAACC,SAAS,EAAEC,YAAY,KAAK;EAC7DH,oBAAoB,GAAG,IAAIJ,uBAAuB,CAAC;IAClDQ,EAAE,EAAEC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;IACjCC,IAAIA,CAAA,EAAG;MACN,OAAO;QACNL,SAAS;QACTC;MACD,CAAC;IACF;EACD,CAAC,CAAC;AACH,CAAC;AACD;AACA;AACA;AACA;AACA,MAAMK,mBAAmB,GAAIC,GAAG,IAAK;EACpC;EACA,IAAIT,oBAAoB,KAAK,IAAI,EAAE;IAClCK,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACX,oBAAoB,CAACY,GAAG,CAAC;EACpD;EACA,IAAI;IAAEV,SAAS;IAAEC;EAAa,CAAC,GAAGM,GAAG;EACrC,OAAO,IAAII,OAAO,CAAEC,OAAO,IAAK;IAC/Bb,wBAAwB,CAACC,SAAS,EAAEC,YAAY,CAAC;IACjDH,oBAAoB,CAACe,QAAQ,GAAIC,GAAG,IAAK;MACxCF,OAAO,CAACE,GAAG,CAAC;MACZ;MACA,IAAIA,GAAG,KAAK,QAAQ,IAAIhB,oBAAoB,KAAK,IAAI,EAAE;QACtDK,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACX,oBAAoB,CAACY,GAAG,CAAC;QACnDZ,oBAAoB,GAAG,IAAI;MAC5B;IACD,CAAC;IACDK,QAAQ,CAACK,IAAI,CAACO,WAAW,CAACjB,oBAAoB,CAACY,GAAG,CAAC,EAAC;IACpDf,YAAG,CAACqB,QAAQ,CAAC,MAAM;MAClBlB,oBAAoB,CAACmB,OAAO,GAAG,IAAI,EAAC;IACrC,CAAC,CAAC;EACH,CAAC,CAAC;AACH,CAAC;AAAA,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEcd,mBAAmB","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}