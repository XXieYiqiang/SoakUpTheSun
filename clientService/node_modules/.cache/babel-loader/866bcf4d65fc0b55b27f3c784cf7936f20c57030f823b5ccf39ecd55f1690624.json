{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.array.push.js\");\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.filter.js\");\nrequire(\"core-js/modules/es.iterator.map.js\");\nrequire(\"core-js/modules/es.set.difference.v2.js\");\nrequire(\"core-js/modules/es.set.intersection.v2.js\");\nrequire(\"core-js/modules/es.set.is-disjoint-from.v2.js\");\nrequire(\"core-js/modules/es.set.is-subset-of.v2.js\");\nrequire(\"core-js/modules/es.set.is-superset-of.v2.js\");\nrequire(\"core-js/modules/es.set.symmetric-difference.v2.js\");\nrequire(\"core-js/modules/es.set.union.v2.js\");\nvar _default = exports.default = {\n  name: 'FileTimeLine',\n  props: {\n    // 文件列表\n    fileList: {\n      required: true,\n      type: Array\n    }\n  },\n  data() {\n    return {\n      reverse: true\n    };\n  },\n  computed: {\n    //  按年-月-日分组排序\n    imageTimelineData() {\n      let res = [];\n      //  去重，获取返回的所有日期年-月-日\n      let uploadTimeSet = new Set(this.fileList.map(item => item.uploadTime.split(' ')[0]));\n      let uploadDate = [...uploadTimeSet];\n      //  分组\n      uploadDate.forEach(element => {\n        res.push({\n          uploadDate: element,\n          imageList: this.fileList.filter(item => item.uploadTime.split(' ')[0] === element) //  过滤\n        });\n      });\n      return res;\n    },\n    // 图标大小\n    gridSize() {\n      return this.$store.getters.gridSize;\n    },\n    // 屏幕宽度\n    screenWidth() {\n      return this.$store.state.common.screenWidth;\n    }\n  },\n  methods: {\n    /**\r\n     * 文件鼠标右键事件\r\n     * @param {object} item 文件信息\r\n     * @param {number} index 文件索引\r\n     * @param {object} event 鼠标事件信息\r\n     */\n    handleContextMenu(item, index, event) {\n      // 阻止右键事件冒泡\n      event.cancelBubble = true;\n      // xs 以上的屏幕\n      if (this.screenWidth > 768) {\n        this.selectedFile = item;\n        if (!this.isBatchOperation) {\n          event.preventDefault();\n          this.$openBox.contextMenu({\n            selectedFile: item,\n            domEvent: event\n          }).then(res => {\n            this.selectedFile = {};\n            if (res === 'confirm') {\n              this.$emit('getTableDataByType'); //  刷新文件列表\n              this.$store.dispatch('showStorage'); //  刷新存储容量\n            }\n          });\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["name","props","fileList","required","type","Array","data","reverse","computed","imageTimelineData","res","uploadTimeSet","Set","map","item","uploadTime","split","uploadDate","forEach","element","push","imageList","filter","gridSize","$store","getters","screenWidth","state","common","methods","handleContextMenu","index","event","cancelBubble","selectedFile","isBatchOperation","preventDefault","$openBox","contextMenu","domEvent","then","$emit","dispatch"],"sources":["src/components/file/components/FileTimeLine.vue"],"sourcesContent":["<template>\r\n\t<!-- 时间线模式 -->\r\n\t<div class=\"image-timeline-wrapper\">\r\n\t\t<div class=\"radio\">\r\n\t\t\t排序：\r\n\t\t\t<el-radio-group v-model=\"reverse\">\r\n\t\t\t\t<el-radio :label=\"true\">倒序</el-radio>\r\n\t\t\t\t<el-radio :label=\"false\">正序</el-radio>\r\n\t\t\t</el-radio-group>\r\n\t\t</div>\r\n\t\t<el-timeline\r\n\t\t\tclass=\"image-timeline-list\"\r\n\t\t\t:reverse=\"reverse\"\r\n\t\t\tv-if=\"imageTimelineData.length\"\r\n\t\t>\r\n\t\t\t<el-timeline-item\r\n\t\t\t\tclass=\"image-timeline-item\"\r\n\t\t\t\tv-for=\"(item, index) in imageTimelineData\"\r\n\t\t\t\t:key=\"index\"\r\n\t\t\t\t:timestamp=\"item.uploadDate\"\r\n\t\t\t\tcolor=\"#409EFF\"\r\n\t\t\t\tplacement=\"top\"\r\n\t\t\t>\r\n\t\t\t\t<ul class=\"image-list\">\r\n\t\t\t\t\t<li\r\n\t\t\t\t\t\tclass=\"image-item\"\r\n\t\t\t\t\t\tv-for=\"(image, imageIndex) in item.imageList\"\r\n\t\t\t\t\t\t:key=\"`${index}-${imageIndex}`\"\r\n\t\t\t\t\t\t:style=\"`width: ${gridSize + 40}px; `\"\r\n\t\t\t\t\t\t@click=\"$file.handleImgPreview(imageIndex, {}, item.imageList)\"\r\n\t\t\t\t\t\t@contextmenu.prevent=\"handleContextMenu(item, imageIndex, $event)\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\tclass=\"image\"\r\n\t\t\t\t\t\t\t:src=\"$file.getMinImgStream(image)\"\r\n\t\t\t\t\t\t\t:alt=\"$file.getFileNameComplete(image)\"\r\n\t\t\t\t\t\t\t:style=\"`width: ${gridSize}px; height: ${gridSize}px;`\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\"image-name\"\r\n\t\t\t\t\t\t\tv-html=\"$file.getFileNameComplete(image, true)\"\r\n\t\t\t\t\t\t></div>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</el-timeline-item>\r\n\t\t</el-timeline>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\tname: 'FileTimeLine',\r\n\tprops: {\r\n\t\t// 文件列表\r\n\t\tfileList: {\r\n\t\t\trequired: true,\r\n\t\t\ttype: Array\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\treverse: true\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t//  按年-月-日分组排序\r\n\t\timageTimelineData() {\r\n\t\t\tlet res = []\r\n\t\t\t//  去重，获取返回的所有日期年-月-日\r\n\t\t\tlet uploadTimeSet = new Set(\r\n\t\t\t\tthis.fileList.map((item) => item.uploadTime.split(' ')[0])\r\n\t\t\t)\r\n\t\t\tlet uploadDate = [...uploadTimeSet]\r\n\t\t\t//  分组\r\n\t\t\tuploadDate.forEach((element) => {\r\n\t\t\t\tres.push({\r\n\t\t\t\t\tuploadDate: element,\r\n\t\t\t\t\timageList: this.fileList.filter(\r\n\t\t\t\t\t\t(item) => item.uploadTime.split(' ')[0] === element\r\n\t\t\t\t\t) //  过滤\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t\treturn res\r\n\t\t},\r\n\t\t// 图标大小\r\n\t\tgridSize() {\r\n\t\t\treturn this.$store.getters.gridSize\r\n\t\t},\r\n\t\t// 屏幕宽度\r\n\t\tscreenWidth() {\r\n\t\t\treturn this.$store.state.common.screenWidth\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 文件鼠标右键事件\r\n\t\t * @param {object} item 文件信息\r\n\t\t * @param {number} index 文件索引\r\n\t\t * @param {object} event 鼠标事件信息\r\n\t\t */\r\n\t\thandleContextMenu(item, index, event) {\r\n\t\t\t// 阻止右键事件冒泡\r\n\t\t\tevent.cancelBubble = true\r\n\t\t\t// xs 以上的屏幕\r\n\t\t\tif (this.screenWidth > 768) {\r\n\t\t\t\tthis.selectedFile = item\r\n\t\t\t\tif (!this.isBatchOperation) {\r\n\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\tthis.$openBox\r\n\t\t\t\t\t\t.contextMenu({\r\n\t\t\t\t\t\t\tselectedFile: item,\r\n\t\t\t\t\t\t\tdomEvent: event\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\t\tthis.selectedFile = {}\r\n\t\t\t\t\t\t\tif (res === 'confirm') {\r\n\t\t\t\t\t\t\t\tthis.$emit('getTableDataByType') //  刷新文件列表\r\n\t\t\t\t\t\t\t\tthis.$store.dispatch('showStorage') //  刷新存储容量\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n@import '~_a/styles/varibles.styl';\r\n@import '~_a/styles/mixins.styl';\r\n\r\n.image-timeline-wrapper {\r\n  margin-top: 20px;\r\n  height: calc(100vh - 215px);\r\n  overflow-y: auto;\r\n  setScrollbar(6px, transparent, #C0C4CC);\r\n\r\n  .image-timeline-list {\r\n    margin-top: 10px;\r\n\r\n    .image-timeline-item {\r\n      .image-list {\r\n        display: flex;\r\n        flex-wrap: wrap;\r\n        list-style: none;\r\n\r\n        .image-item {\r\n          margin: 0 16px 16px 0;\r\n          padding: 8px;\r\n          text-align: center;\r\n          cursor: pointer;\r\n\r\n          &:hover {\r\n            background: $tabBackColor;\r\n\r\n            .file-name {\r\n              font-weight: 550;\r\n            }\r\n          }\r\n\r\n          .image-name {\r\n            margin-top: 8px;\r\n            height: 44px;\r\n            line-height: 22px;\r\n            font-size: 12px;\r\n            word-break: break-all;\r\n            setEllipsis(2);\r\n            >>> .keyword {\r\n              color: $Danger;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"mappings":";;;;;;;;;;;;;;;;;iCAkDA;EACAA,IAAA;EACAC,KAAA;IACA;IACAC,QAAA;MACAC,QAAA;MACAC,IAAA,EAAAC;IACA;EACA;EACAC,KAAA;IACA;MACAC,OAAA;IACA;EACA;EACAC,QAAA;IACA;IACAC,kBAAA;MACA,IAAAC,GAAA;MACA;MACA,IAAAC,aAAA,OAAAC,GAAA,CACA,KAAAV,QAAA,CAAAW,GAAA,CAAAC,IAAA,IAAAA,IAAA,CAAAC,UAAA,CAAAC,KAAA,SACA;MACA,IAAAC,UAAA,OAAAN,aAAA;MACA;MACAM,UAAA,CAAAC,OAAA,CAAAC,OAAA;QACAT,GAAA,CAAAU,IAAA;UACAH,UAAA,EAAAE,OAAA;UACAE,SAAA,OAAAnB,QAAA,CAAAoB,MAAA,CACAR,IAAA,IAAAA,IAAA,CAAAC,UAAA,CAAAC,KAAA,aAAAG,OACA;QACA;MACA;MACA,OAAAT,GAAA;IACA;IACA;IACAa,SAAA;MACA,YAAAC,MAAA,CAAAC,OAAA,CAAAF,QAAA;IACA;IACA;IACAG,YAAA;MACA,YAAAF,MAAA,CAAAG,KAAA,CAAAC,MAAA,CAAAF,WAAA;IACA;EACA;EACAG,OAAA;IACA;AACA;AACA;AACA;AACA;AACA;IACAC,kBAAAhB,IAAA,EAAAiB,KAAA,EAAAC,KAAA;MACA;MACAA,KAAA,CAAAC,YAAA;MACA;MACA,SAAAP,WAAA;QACA,KAAAQ,YAAA,GAAApB,IAAA;QACA,UAAAqB,gBAAA;UACAH,KAAA,CAAAI,cAAA;UACA,KAAAC,QAAA,CACAC,WAAA;YACAJ,YAAA,EAAApB,IAAA;YACAyB,QAAA,EAAAP;UACA,GACAQ,IAAA,CAAA9B,GAAA;YACA,KAAAwB,YAAA;YACA,IAAAxB,GAAA;cACA,KAAA+B,KAAA;cACA,KAAAjB,MAAA,CAAAkB,QAAA;YACA;UACA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}