{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n/**\r\n * webSocket 配置类\r\n */\n// plugins/ws.js\nclass WebSocketService {\n  constructor(url, store) {\n    this.url = url;\n    this.store = store;\n    this.socket = null;\n    this.reconnectInterval = 5000;\n    this.heartbeatInterval = 30000;\n    this.heartbeatTimer = null;\n  }\n  connect() {\n    this.socket = new WebSocket(this.url);\n    this.socket.onopen = () => {\n      console.log('WebSocket 连接成功');\n      this.startHeartbeat();\n    };\n    this.socket.onmessage = event => {\n      const data = JSON.parse(event.data);\n      this.handleMessage(data);\n    };\n    this.socket.onclose = () => {\n      console.warn('WebSocket 断开，准备重连...');\n      this.reconnect();\n    };\n    this.socket.onerror = err => {\n      console.error('WebSocket 错误', err);\n      this.socket.close();\n    };\n  }\n  reconnect() {\n    setTimeout(() => this.connect(), this.reconnectInterval);\n  }\n  startHeartbeat() {\n    if (this.heartbeatTimer) clearInterval(this.heartbeatTimer);\n    this.heartbeatTimer = setInterval(() => {\n      this.send({\n        type: 'ping'\n      });\n    }, this.heartbeatInterval);\n  }\n  send(data) {\n    if (this.socket && this.socket.readyState === WebSocket.OPEN) {\n      this.socket.send(JSON.stringify(data));\n    }\n  }\n  handleMessage(msg) {\n    // 分发到消息中心处理\n    this.store.dispatch('messageDispatcher/dispatch', msg);\n  }\n}\nvar _default = exports.default = WebSocketService;","map":{"version":3,"names":["WebSocketService","constructor","url","store","socket","reconnectInterval","heartbeatInterval","heartbeatTimer","connect","WebSocket","onopen","console","log","startHeartbeat","onmessage","event","data","JSON","parse","handleMessage","onclose","warn","reconnect","onerror","err","error","close","setTimeout","clearInterval","setInterval","send","type","readyState","OPEN","stringify","msg","dispatch","_default","exports","default"],"sources":["C:/Users/Administrator/Desktop/GimChat/gimChatVue/src/plugins/ws.js"],"sourcesContent":["/**\r\n * webSocket 配置类\r\n */\r\n// plugins/ws.js\r\nclass WebSocketService {\r\n  constructor(url, store) {\r\n    this.url = url;\r\n    this.store = store;\r\n    this.socket = null;\r\n    this.reconnectInterval = 5000;\r\n    this.heartbeatInterval = 30000;\r\n    this.heartbeatTimer = null;\r\n  }\r\n\r\n  connect() {\r\n    this.socket = new WebSocket(this.url);\r\n\r\n    this.socket.onopen = () => {\r\n      console.log('WebSocket 连接成功');\r\n      this.startHeartbeat();\r\n    };\r\n\r\n    this.socket.onmessage = (event) => {\r\n      const data = JSON.parse(event.data);\r\n      this.handleMessage(data);\r\n    };\r\n\r\n    this.socket.onclose = () => {\r\n      console.warn('WebSocket 断开，准备重连...');\r\n      this.reconnect();\r\n    };\r\n\r\n    this.socket.onerror = (err) => {\r\n      console.error('WebSocket 错误', err);\r\n      this.socket.close();\r\n    };\r\n  }\r\n\r\n  reconnect() {\r\n    setTimeout(() => this.connect(), this.reconnectInterval);\r\n  }\r\n\r\n  startHeartbeat() {\r\n    if (this.heartbeatTimer) clearInterval(this.heartbeatTimer);\r\n    this.heartbeatTimer = setInterval(() => {\r\n      this.send({ type: 'ping' });\r\n    }, this.heartbeatInterval);\r\n  }\r\n\r\n  send(data) {\r\n    if (this.socket && this.socket.readyState === WebSocket.OPEN) {\r\n      this.socket.send(JSON.stringify(data));\r\n    }\r\n  }\r\n\r\n  handleMessage(msg) {\r\n    // 分发到消息中心处理\r\n    this.store.dispatch('messageDispatcher/dispatch', msg);\r\n  }\r\n}\r\n\r\nexport default WebSocketService;\r\n"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA,MAAMA,gBAAgB,CAAC;EACrBC,WAAWA,CAACC,GAAG,EAAEC,KAAK,EAAE;IACtB,IAAI,CAACD,GAAG,GAAGA,GAAG;IACd,IAAI,CAACC,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACC,MAAM,GAAG,IAAI;IAClB,IAAI,CAACC,iBAAiB,GAAG,IAAI;IAC7B,IAAI,CAACC,iBAAiB,GAAG,KAAK;IAC9B,IAAI,CAACC,cAAc,GAAG,IAAI;EAC5B;EAEAC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACJ,MAAM,GAAG,IAAIK,SAAS,CAAC,IAAI,CAACP,GAAG,CAAC;IAErC,IAAI,CAACE,MAAM,CAACM,MAAM,GAAG,MAAM;MACzBC,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAC;MAC7B,IAAI,CAACC,cAAc,CAAC,CAAC;IACvB,CAAC;IAED,IAAI,CAACT,MAAM,CAACU,SAAS,GAAIC,KAAK,IAAK;MACjC,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACH,KAAK,CAACC,IAAI,CAAC;MACnC,IAAI,CAACG,aAAa,CAACH,IAAI,CAAC;IAC1B,CAAC;IAED,IAAI,CAACZ,MAAM,CAACgB,OAAO,GAAG,MAAM;MAC1BT,OAAO,CAACU,IAAI,CAAC,sBAAsB,CAAC;MACpC,IAAI,CAACC,SAAS,CAAC,CAAC;IAClB,CAAC;IAED,IAAI,CAAClB,MAAM,CAACmB,OAAO,GAAIC,GAAG,IAAK;MAC7Bb,OAAO,CAACc,KAAK,CAAC,cAAc,EAAED,GAAG,CAAC;MAClC,IAAI,CAACpB,MAAM,CAACsB,KAAK,CAAC,CAAC;IACrB,CAAC;EACH;EAEAJ,SAASA,CAAA,EAAG;IACVK,UAAU,CAAC,MAAM,IAAI,CAACnB,OAAO,CAAC,CAAC,EAAE,IAAI,CAACH,iBAAiB,CAAC;EAC1D;EAEAQ,cAAcA,CAAA,EAAG;IACf,IAAI,IAAI,CAACN,cAAc,EAAEqB,aAAa,CAAC,IAAI,CAACrB,cAAc,CAAC;IAC3D,IAAI,CAACA,cAAc,GAAGsB,WAAW,CAAC,MAAM;MACtC,IAAI,CAACC,IAAI,CAAC;QAAEC,IAAI,EAAE;MAAO,CAAC,CAAC;IAC7B,CAAC,EAAE,IAAI,CAACzB,iBAAiB,CAAC;EAC5B;EAEAwB,IAAIA,CAACd,IAAI,EAAE;IACT,IAAI,IAAI,CAACZ,MAAM,IAAI,IAAI,CAACA,MAAM,CAAC4B,UAAU,KAAKvB,SAAS,CAACwB,IAAI,EAAE;MAC5D,IAAI,CAAC7B,MAAM,CAAC0B,IAAI,CAACb,IAAI,CAACiB,SAAS,CAAClB,IAAI,CAAC,CAAC;IACxC;EACF;EAEAG,aAAaA,CAACgB,GAAG,EAAE;IACjB;IACA,IAAI,CAAChC,KAAK,CAACiC,QAAQ,CAAC,4BAA4B,EAAED,GAAG,CAAC;EACxD;AACF;AAAC,IAAAE,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEcvC,gBAAgB","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}