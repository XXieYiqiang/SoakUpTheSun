{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"C:/Users/Administrator/Desktop/GimChat/gimChatVue/node_modules/@babel/runtime/helpers/interopRequireDefault.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.array.push.js\");\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.reduce.js\");\nvar _vue = _interopRequireDefault(require(\"vue\"));\n/**\r\n * ðŸ“¬ Vuex ç«™å†…ä¿¡æ¶ˆæ¯æ¨¡å—\r\n * - å­˜å‚¨æ¯ä¸ªè”ç³»äººæˆ–ç¾¤ç»„çš„æ¶ˆæ¯åˆ—è¡¨\r\n * - ç®¡ç†æ¯ä¸ªä¼šè¯çš„æœªè¯»æ¶ˆæ¯æ•°é‡\r\n */\nvar _default = exports.default = {\n  namespaced: true,\n  state: {\n    messageMap: {},\n    // { contactId: [message, ...] } æ¯ä¸ªä¼šè¯çš„æ¶ˆæ¯åˆ—è¡¨\n    unreadMap: {},\n    // { contactId: unreadCount } æ¯ä¸ªä¼šè¯çš„æœªè¯»æ•°\n    userList: [] // âœ… å½“å‰ç”¨æˆ·çš„è”ç³»äºº/åœ¨çº¿ç”¨æˆ·åˆ—è¡¨\n  },\n  mutations: {\n    /**\r\n    * âœ… è®¾ç½®ç”¨æˆ·åˆ—è¡¨\r\n    * @param {Array} users ç”¨æˆ·æ•°ç»„\r\n    */\n    SET_USER_LIST(state, users) {\n      console.log('[Vuex:message] ðŸ‘¥ è®¾ç½®ç”¨æˆ·åˆ—è¡¨:', users);\n      state.userList = users;\n    },\n    /**\r\n    * âœ… æ¸…ç©ºç”¨æˆ·åˆ—è¡¨\r\n    */\n    CLEAR_USER_LIST(state) {\n      console.warn('[Vuex:message] âš ï¸ æ¸…ç©ºç”¨æˆ·åˆ—è¡¨');\n      state.userList = [];\n    },\n    /**\r\n    * âœ… å‘æŸä¸ªä¼šè¯è¿½åŠ ä¸€æ¡æ¶ˆæ¯\r\n    * @param {String} contactId ä¼šè¯ IDï¼ˆç”¨æˆ·ID æˆ– ç¾¤IDï¼‰\r\n    * @param {Object} message æ¶ˆæ¯å¯¹è±¡\r\n    */\n    ADD_MESSAGE(state, {\n      contactId,\n      message\n    }) {\n      if (!state.messageMap[contactId]) {\n        console.log(`[Vuex:message] åˆå§‹åŒ–ä¼šè¯æ¶ˆæ¯åˆ—è¡¨: ${contactId}`);\n        _vue.default.set(state.messageMap, contactId, []); // âœ… å“åº”å¼æ–°å¢ž key\n      }\n      console.log(`[Vuex:message] âž• æ·»åŠ æ¶ˆæ¯åˆ° ${contactId}:`, message);\n      state.messageMap[contactId].push(message);\n    },\n    /**\r\n     * âœ… æŒ‡å®šä¼šè¯æœªè¯»æ•° +1\r\n     * @param {String} contactId ä¼šè¯ ID\r\n     */\n    INCREMENT_UNREAD(state, contactId) {\n      if (!state.unreadMap[contactId]) {\n        console.log(`[Vuex:message] åˆå§‹åŒ–æœªè¯»è®¡æ•°: ${contactId}`);\n        state.unreadMap[contactId] = 0;\n      }\n      state.unreadMap[contactId]++;\n      console.log(`[Vuex:message] ðŸ”´ æœªè¯»æ•° +1 (${contactId}):`, state.unreadMap[contactId]);\n    },\n    /**\r\n     * âœ… é‡ç½®æŒ‡å®šä¼šè¯æœªè¯»æ¶ˆæ¯æ•°ä¸º 0ï¼ˆå·²è¯»ï¼‰\r\n     * @param {String} contactId ä¼šè¯ ID\r\n     */\n    RESET_UNREAD(state, contactId) {\n      console.log(`[Vuex:message] âœ… æ¸…é™¤æœªè¯»æ•°: ${contactId}`);\n      state.unreadMap[contactId] = 0;\n    },\n    /**\r\n     * âœ… æ¸…ç©ºæŒ‡å®šä¼šè¯æ‰€æœ‰æ¶ˆæ¯\r\n     * @param {String} contactId ä¼šè¯ ID\r\n     */\n    CLEAR_MESSAGES(state, contactId) {\n      console.warn(`[Vuex:message] âš ï¸ æ¸…ç©ºæ¶ˆæ¯: ${contactId}`);\n      state.messageMap[contactId] = [];\n    }\n  },\n  getters: {\n    /**\r\n    * âœ… èŽ·å–ç”¨æˆ·åˆ—è¡¨\r\n    */\n    getUserList: state => {\n      return state.userList;\n    },\n    /**\r\n     * ðŸŸ¢ èŽ·å–æŒ‡å®šä¼šè¯çš„æ¶ˆæ¯æ•°ç»„\r\n     */\n    getMessages: state => contactId => {\n      return state.messageMap[contactId] || [];\n    },\n    /**\r\n     * ðŸŸ¡ èŽ·å–æŒ‡å®šä¼šè¯çš„æœªè¯»æ•°\r\n     */\n    getUnread: state => contactId => {\n      return state.unreadMap[contactId] || 0;\n    },\n    /**\r\n     * ðŸ”´ èŽ·å–æ‰€æœ‰ä¼šè¯çš„æœªè¯»æ¶ˆæ¯æ€»å’Œ\r\n     */\n    getTotalUnread: state => {\n      const total = Object.values(state.unreadMap).reduce((a, b) => a + b, 0);\n      console.log(`[Vuex:message] ðŸ”¢ æ€»æœªè¯»æ•°: ${total}`);\n      return total;\n    }\n  }\n};","map":{"version":3,"names":["_vue","_interopRequireDefault","require","_default","exports","default","namespaced","state","messageMap","unreadMap","userList","mutations","SET_USER_LIST","users","console","log","CLEAR_USER_LIST","warn","ADD_MESSAGE","contactId","message","Vue","set","push","INCREMENT_UNREAD","RESET_UNREAD","CLEAR_MESSAGES","getters","getUserList","getMessages","getUnread","getTotalUnread","total","Object","values","reduce","a","b"],"sources":["C:/Users/Administrator/Desktop/GimChat/gimChatVue/src/store/module/message.js"],"sourcesContent":["/**\r\n * ðŸ“¬ Vuex ç«™å†…ä¿¡æ¶ˆæ¯æ¨¡å—\r\n * - å­˜å‚¨æ¯ä¸ªè”ç³»äººæˆ–ç¾¤ç»„çš„æ¶ˆæ¯åˆ—è¡¨\r\n * - ç®¡ç†æ¯ä¸ªä¼šè¯çš„æœªè¯»æ¶ˆæ¯æ•°é‡\r\n */\r\nimport Vue from 'vue';\r\n\r\nexport default {\r\n  namespaced: true,\r\n\r\n  state: {\r\n    messageMap: {},   // { contactId: [message, ...] } æ¯ä¸ªä¼šè¯çš„æ¶ˆæ¯åˆ—è¡¨\r\n    unreadMap: {},     // { contactId: unreadCount } æ¯ä¸ªä¼šè¯çš„æœªè¯»æ•°\r\n    userList: []      // âœ… å½“å‰ç”¨æˆ·çš„è”ç³»äºº/åœ¨çº¿ç”¨æˆ·åˆ—è¡¨\r\n  },\r\n\r\n  mutations: {\r\n    /**\r\n   * âœ… è®¾ç½®ç”¨æˆ·åˆ—è¡¨\r\n   * @param {Array} users ç”¨æˆ·æ•°ç»„\r\n   */\r\n    SET_USER_LIST(state, users) {\r\n      console.log('[Vuex:message] ðŸ‘¥ è®¾ç½®ç”¨æˆ·åˆ—è¡¨:', users);\r\n      state.userList = users;\r\n    },\r\n    /**\r\n * âœ… æ¸…ç©ºç”¨æˆ·åˆ—è¡¨\r\n */\r\n    CLEAR_USER_LIST(state) {\r\n      console.warn('[Vuex:message] âš ï¸ æ¸…ç©ºç”¨æˆ·åˆ—è¡¨');\r\n      state.userList = [];\r\n    },\r\n    /**\r\n * âœ… å‘æŸä¸ªä¼šè¯è¿½åŠ ä¸€æ¡æ¶ˆæ¯\r\n * @param {String} contactId ä¼šè¯ IDï¼ˆç”¨æˆ·ID æˆ– ç¾¤IDï¼‰\r\n * @param {Object} message æ¶ˆæ¯å¯¹è±¡\r\n */\r\n    ADD_MESSAGE(state, { contactId, message }) {\r\n      if (!state.messageMap[contactId]) {\r\n        console.log(`[Vuex:message] åˆå§‹åŒ–ä¼šè¯æ¶ˆæ¯åˆ—è¡¨: ${contactId}`);\r\n        Vue.set(state.messageMap, contactId, []); // âœ… å“åº”å¼æ–°å¢ž key\r\n      }\r\n      console.log(`[Vuex:message] âž• æ·»åŠ æ¶ˆæ¯åˆ° ${contactId}:`, message);\r\n      state.messageMap[contactId].push(message);\r\n    },\r\n\r\n    /**\r\n     * âœ… æŒ‡å®šä¼šè¯æœªè¯»æ•° +1\r\n     * @param {String} contactId ä¼šè¯ ID\r\n     */\r\n    INCREMENT_UNREAD(state, contactId) {\r\n      if (!state.unreadMap[contactId]) {\r\n        console.log(`[Vuex:message] åˆå§‹åŒ–æœªè¯»è®¡æ•°: ${contactId}`);\r\n        state.unreadMap[contactId] = 0;\r\n      }\r\n      state.unreadMap[contactId]++;\r\n      console.log(`[Vuex:message] ðŸ”´ æœªè¯»æ•° +1 (${contactId}):`, state.unreadMap[contactId]);\r\n    },\r\n\r\n    /**\r\n     * âœ… é‡ç½®æŒ‡å®šä¼šè¯æœªè¯»æ¶ˆæ¯æ•°ä¸º 0ï¼ˆå·²è¯»ï¼‰\r\n     * @param {String} contactId ä¼šè¯ ID\r\n     */\r\n    RESET_UNREAD(state, contactId) {\r\n      console.log(`[Vuex:message] âœ… æ¸…é™¤æœªè¯»æ•°: ${contactId}`);\r\n      state.unreadMap[contactId] = 0;\r\n    },\r\n\r\n    /**\r\n     * âœ… æ¸…ç©ºæŒ‡å®šä¼šè¯æ‰€æœ‰æ¶ˆæ¯\r\n     * @param {String} contactId ä¼šè¯ ID\r\n     */\r\n    CLEAR_MESSAGES(state, contactId) {\r\n      console.warn(`[Vuex:message] âš ï¸ æ¸…ç©ºæ¶ˆæ¯: ${contactId}`);\r\n      state.messageMap[contactId] = [];\r\n    }\r\n  },\r\n\r\n  getters: {\r\n    /**\r\n * âœ… èŽ·å–ç”¨æˆ·åˆ—è¡¨\r\n */\r\n    getUserList: (state) => {\r\n      return state.userList;\r\n    },\r\n    /**\r\n     * ðŸŸ¢ èŽ·å–æŒ‡å®šä¼šè¯çš„æ¶ˆæ¯æ•°ç»„\r\n     */\r\n    getMessages: (state) => (contactId) => {\r\n      return state.messageMap[contactId] || [];\r\n    },\r\n\r\n    /**\r\n     * ðŸŸ¡ èŽ·å–æŒ‡å®šä¼šè¯çš„æœªè¯»æ•°\r\n     */\r\n    getUnread: (state) => (contactId) => {\r\n      return state.unreadMap[contactId] || 0;\r\n    },\r\n\r\n    /**\r\n     * ðŸ”´ èŽ·å–æ‰€æœ‰ä¼šè¯çš„æœªè¯»æ¶ˆæ¯æ€»å’Œ\r\n     */\r\n    getTotalUnread: (state) => {\r\n      const total = Object.values(state.unreadMap).reduce((a, b) => a + b, 0);\r\n      console.log(`[Vuex:message] ðŸ”¢ æ€»æœªè¯»æ•°: ${total}`);\r\n      return total;\r\n    }\r\n  }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}