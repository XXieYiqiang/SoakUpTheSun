{"ast":null,"code":"import { getFoldTree, copyFile } from '@/api/file.js';\nexport default {\n  name: 'CopyFileDialog',\n  data() {\n    return {\n      visible: false,\n      //  对话框是否可见\n      targetPath: '/',\n      //  目标路径\n      fileTree: [],\n      //  文件夹目录树\n      loading: false,\n      //  文件夹目录树 loading 状态\n      defaultExpandedKeys: [],\n      sureBtnLoading: false //  确定按钮 loading 状态\n    };\n  },\n  methods: {\n    /**\r\n     * 取消按钮点击事件 & 对话框关闭的回调\r\n     */\n    handleDialogClose() {\n      this.visible = false;\n      this.callback('cancel');\n    },\n    /**\r\n     * 对话框打开的回调\r\n     */\n    handleDialogOpen() {\n      this.initFileTree();\n    },\n    /**\r\n     * 初始化文件目录树\r\n     */\n    initFileTree(id) {\n      this.loading = true;\n      getFoldTree().then(res => {\n        this.loading = false;\n        if (res.data.code === 200) {\n          this.fileTree = [res.data.data];\n          this.defaultExpandedKeys = id ? [id] : [this.fileTree[0].id];\n        } else {\n          this.$message.error(res.message);\n        }\n      });\n    },\n    /**\r\n     * 目录树节点点击回调函数\r\n     * @description 将当前节点中的文件夹路径传递给父组件\r\n     * @param {object} data 当前点击的节点信息\r\n     */\n    handleNodeClick(data) {\n      this.targetPath = data.filePath ? data.filePath : '/';\n    },\n    /**\r\n     * 新建文件夹按钮点击事件\r\n     * @description 调用新建文件夹服务，并在弹窗确认回调事件中刷新文件夹树\r\n     */\n    handleAddFolderBtnClick(data) {\n      this.$openDialog.addFolder({\n        filePath: data.filePath || '/'\n      }).then(() => {\n        this.initFileTree(data.id);\n      });\n    },\n    /**\r\n     * 确定按钮点击事件\r\n     * @description 调用复制文件接口\r\n     */\n    handleDialogSure() {\n      this.sureBtnLoading = true;\n      let data = {\n        filePath: this.targetPath,\n        userFileIds: this.fileInfo.userFileId\n      };\n      copyFile(data).then(res => {\n        this.sureBtnLoading = false;\n        if (res.data.code === 200) {\n          this.$message.success('复制成功');\n          this.visible = false;\n          this.callback('confirm');\n        } else {\n          this.$message.error(res.message);\n        }\n      }).catch(() => {\n        this.sureBtnLoading = false;\n      });\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}