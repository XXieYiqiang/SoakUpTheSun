{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.array.push.js\");\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.filter.js\");\nrequire(\"core-js/modules/es.iterator.find.js\");\nrequire(\"core-js/modules/es.iterator.for-each.js\");\nrequire(\"core-js/modules/es.iterator.map.js\");\nvar _ai = require(\"@/api/ai\");\nlet idCounter = 3; // ä» 3 å¼€å§‹ï¼Œå› ä¸ºåˆå§‹ nodes ä¸­ n1 å’Œ n2 å·²å ç”¨\nconst genId = prefix => prefix + idCounter++;\nvar _default = exports.default = {\n  name: 'InfiniteCanvasMedia',\n  data() {\n    return {\n      taskId: '',\n      labelPosition: 'left',\n      form: {\n        modelType: '',\n        modelStyle: ''\n      },\n      styleOptions: [{\n        label: 'å†™å®é£æ ¼',\n        value: 'å†™å®é£æ ¼'\n      }, {\n        label: 'åŠ¨æ¼«é£æ ¼',\n        value: 'åŠ¨æ¼«é£æ ¼'\n      }],\n      //æ¨¡å‹ä¸‹æ‹‰æ¡†\n      modelOptions: [{\n        value: 'gpt-4.1',\n        label: 'GPT-4.1ï¼ˆé»˜è®¤æ¨èï¼‰'\n      }, {\n        value: 'gpt-4o',\n        label: 'GPT-4o'\n      }, {\n        value: 'gpt-4',\n        label: 'GPT-4'\n      }, {\n        value: 'gpt-3.5-turbo',\n        label: 'GPT-3.5 Turbo'\n      }, {\n        value: 'o3',\n        label: 'O3'\n      }],\n      modelType: '',\n      //æ¨¡å‹é€‰æ‹©\n      //=============================\n      // --- å¤šé€‰ & æ¡†é€‰çŠ¶æ€ (æ–°å¢/ä¿®æ”¹) ---\n      selectedNodeIds: [],\n      // å­˜å‚¨æ‰€æœ‰é€‰ä¸­èŠ‚ç‚¹çš„ ID\n      isBoxSelecting: false,\n      // æ˜¯å¦å¤„äºæ¡†é€‰æ¨¡å¼ (ç”±å³é”®è§¦å‘)\n      boxSelectStart: {\n        x: 0,\n        y: 0\n      },\n      // æ¡†é€‰èµ·å§‹ç‚¹ (å±å¹•åæ ‡)\n      boxSelectEnd: {\n        x: 0,\n        y: 0\n      },\n      // æ¡†é€‰ç»“æŸç‚¹ (å±å¹•åæ ‡)\n      boxSelectStyle: {},\n      // æ·»åŠ  boxSelectStyle åˆ° data\n      // --- äº¤äº’çŠ¶æ€ (ä¿®æ”¹ groupDragOrigin) ---\n      draggingNode: null,\n      nodeDragStart: {\n        x: 0,\n        y: 0\n      },\n      // å­˜å‚¨è¢«æ‹–æ‹½ç»„å†…æ‰€æœ‰èŠ‚ç‚¹çš„åˆå§‹ä½ç½® { id: {x, y} }\n      groupDragOrigin: {},\n      //============================\n      // æ‚¬æµ®è¾“å…¥æ¡†çŠ¶æ€\n      globalSearchText: 'pav',\n      // ç¤ºä¾‹æ–‡æœ¬ï¼Œæ¨¡ä»¿å›¾ç‰‡ä¸­çš„è¾“å…¥\n      // æ–°å¢ï¼šModal çŠ¶æ€ç®¡ç†\n      isModalVisible: false,\n      pendingParentNode: null,\n      // æš‚å­˜çš„çˆ¶èŠ‚ç‚¹å¯¹è±¡\n      newChildType: 'text',\n      // æ–°å­èŠ‚ç‚¹ç±»å‹\n      newChildText: '',\n      // æ–°å­èŠ‚ç‚¹æ–‡æœ¬å†…å®¹\n      newChildSrc: '',\n      // æ–°å­èŠ‚ç‚¹ URL (ç”¨äºå›¾ç‰‡/è§†é¢‘)\n      modalPos: {\n        x: 0,\n        y: 0\n      },\n      // å¼¹æ¡†åœ¨**ç”»å¸ƒåæ ‡ç³»**ä¸­çš„ä½ç½® (æ–°å¢åŠ )\n      // è§†å›¾å˜æ¢\n      offsetX: 0,\n      offsetY: 0,\n      scale: 1,\n      // äº¤äº’çŠ¶æ€\n      isPanning: false,\n      panStart: {\n        x: 0,\n        y: 0\n      },\n      panOrigin: {\n        x: 0,\n        y: 0\n      },\n      draggingNode: null,\n      nodeDragStart: {\n        x: 0,\n        y: 0\n      },\n      nodeOrigin: {\n        x: 0,\n        y: 0\n      },\n      resizingNode: null,\n      resizeStart: {\n        x: 0,\n        y: 0\n      },\n      resizeOriginSize: {\n        w: 0,\n        h: 0\n      },\n      selectedNodeId: null,\n      selectedNodeIds: [],\n      //ä»¥é€‰ä¸­çš„ç»“ç‚¹æ•°ç»„\n      // æ•°æ®æ¨¡å‹\n      nodes: [{\n        id: genId('n'),\n        x: 0,\n        y: 0,\n        width: 100,\n        height: 150,\n        title: 'æ¬¢è¿ä½¿ç”¨',\n        contentType: 'text',\n        // text | image | video\n        content: 'åˆå§‹èŠ‚ç‚¹',\n        src: '',\n        status: 'ready',\n        // æ–°å¢: èŠ‚ç‚¹çŠ¶æ€ (ready, processing, success, failed)\n        timer: null // æ–°å¢: å­˜å‚¨æŸ¥è¯¢å®šæ—¶å™¨ ID\n      }],\n      edges: [],\n      // æ–°å¢: å­˜å‚¨æ­£åœ¨å¤„ç†çš„ AI ä»»åŠ¡çš„èŠ‚ç‚¹å¼•ç”¨\n      processingNode: null,\n      // æ–°å¢: å­˜å‚¨æŸ¥è¯¢å®šæ—¶å™¨IDçš„Map\n      queryTimers: new Map()\n    };\n  },\n  mounted() {\n    // ç»‘å®šå…¨å±€äº‹ä»¶ï¼Œé˜²æ­¢é¼ æ ‡æ‹–å‡ºç”»å¸ƒåŒºåŸŸå¯¼è‡´çŠ¶æ€å¡æ­»\n    window.addEventListener('mousemove', this.onWindowMouseMove);\n    window.addEventListener('mouseup', this.onWindowMouseUp);\n    // å¢åŠ ç‚¹å‡»ç”»å¸ƒå¤–éƒ¨å…³é—­å¼¹çª—çš„ç›‘å¬ (é‡è¦)\n    window.addEventListener('mousedown', this.onWindowMouseDownCloseModal);\n\n    //ç»„ä»¶åŠ è½½æ—¶å°è¯•åŠ è½½æœ¬åœ°æ•°æ®\n    this.loadState();\n  },\n  computed: {\n    /**\r\n     * è®¡ç®—æµ®åŠ¨å¼¹æ¡†çš„æ ·å¼ (å±å¹•åæ ‡)\r\n     */\n    getModalStyle() {\n      if (!this.isModalVisible) return {};\n      const screenPos = this.worldToScreen(this.modalPos.x, this.modalPos.y);\n      return {\n        transform: `translate(${screenPos.x}px, ${screenPos.y}px)`\n        // å¼¹æ¡†ä¸éšç¼©æ”¾å˜åŒ–ï¼Œä¿æŒå›ºå®šå¤§å°\n        // transform: `translate(${screenPos.x}px, ${screenPos.y}px) scale(1)`, \n        // transform-origin: 0 0;\n      };\n    }\n  },\n  beforeDestroy() {\n    window.removeEventListener('mousemove', this.onWindowMouseMove);\n    window.removeEventListener('mouseup', this.onWindowMouseUp);\n    window.removeEventListener('mousedown', this.onWindowMouseDownCloseModal);\n    this.nodes.forEach(node => {\n      if (node.timer) {\n        this.stopQueryTimer(node);\n      }\n    });\n    console.log('ç»„ä»¶é”€æ¯ï¼Œæ‰€æœ‰ AI ä»»åŠ¡å®šæ—¶å™¨å·²åœæ­¢ã€‚');\n  },\n  methods: {\n    /**\r\n     * å¼€å§‹æ¡†é€‰\r\n     */\n    onCanvasMouseMove(e) {\n      console.log('æ¡†é€‰çŠ¶æ€ï¼š', this.isBoxSelecting);\n      if (!this.isBoxSelecting) return; // å¦‚æœæ²¡æœ‰æ¡†é€‰ï¼Œå¿½ç•¥äº‹ä»¶\n\n      // è®¡ç®—æ¡†é€‰çš„ç»“æŸä½ç½®\n      this.boxSelectEnd = {\n        x: e.clientX,\n        y: e.clientY\n      };\n\n      // è®¡ç®—æ¡†é€‰åŒºåŸŸçš„å®½åº¦å’Œé«˜åº¦\n      const width = this.boxSelectEnd.x - this.boxSelectStart.x;\n      const height = this.boxSelectEnd.y - this.boxSelectStart.y;\n\n      // åŠ¨æ€æ›´æ–°é€‰æ¡†çš„æ ·å¼ï¼Œæ˜¾ç¤ºæ¡†é€‰åŒºåŸŸ\n      this.boxSelectStyle = {\n        left: this.boxSelectStart.x + 'px',\n        top: this.boxSelectStart.y + 'px',\n        width: `${width}px`,\n        height: `${height}px`\n      };\n    },\n    /**\r\n     * å®Œæˆæ¡†é€‰\r\n     */\n    onCanvasMouseUp(e) {\n      this.isBoxSelecting = false; // åœæ­¢æ¡†é€‰\n\n      // è®¡ç®—æ¡†é€‰åŒºåŸŸçš„å®é™…ä½ç½®å’Œå°ºå¯¸\n      const startX = Math.min(this.boxSelectStart.x, this.boxSelectEnd.x);\n      const startY = Math.min(this.boxSelectStart.y, this.boxSelectEnd.y);\n      const endX = Math.max(this.boxSelectStart.x, this.boxSelectEnd.x);\n      const endY = Math.max(this.boxSelectStart.y, this.boxSelectEnd.y);\n\n      // é€‰ä¸­æ‰€æœ‰åœ¨æ¡†é€‰åŒºåŸŸå†…çš„èŠ‚ç‚¹\n      this.selectedNodeIds = this.nodes.filter(node => {\n        const nodePos = this.getNodePosition(node);\n        return nodePos.x >= startX && nodePos.x + node.width <= endX && nodePos.y >= startY && nodePos.y + node.height <= endY;\n      }).map(node => node.id);\n\n      // æ¸…é™¤æ¡†é€‰åŒºåŸŸæ ·å¼\n      this.boxSelectStyle = {};\n    },\n    // è·å–èŠ‚ç‚¹ä½ç½®ï¼ˆåŒ…æ‹¬å®½åº¦å’Œé«˜åº¦ï¼‰\n    getNodePosition(node) {\n      const pos = this.worldToScreen(node.x, node.y);\n      return {\n        x: pos.x,\n        y: pos.y,\n        width: node.width * this.scale,\n        height: node.height * this.scale\n      };\n    },\n    /**\r\n     * æç¤ºç”¨æˆ·ç¡®è®¤æ¸…ç©ºç”»å¸ƒ\r\n     */\n    clearData() {\n      this.$confirm('æ­¤æ“ä½œå°†æ¸…ç©ºæ‰€æœ‰èŠ‚ç‚¹ã€è¿çº¿ï¼Œå¹¶åˆ é™¤æœ¬åœ°ä¿å­˜çš„æ•°æ®ï¼Œæ˜¯å¦ç»§ç»­?', 'è­¦å‘Š', {\n        confirmButtonText: 'ç¡®å®šæ¸…ç©º',\n        cancelButtonText: 'å–æ¶ˆ',\n        type: 'warning'\n      }).then(() => {\n        this.clearCanvas();\n        this.$message.success('ç”»å¸ƒå·²æ¸…ç©ºå¹¶åˆ é™¤æœ¬åœ°æ•°æ®ã€‚');\n      }).catch(() => {\n        this.$message.error('å·²å–æ¶ˆæ¸…ç©ºæ“ä½œã€‚');\n      });\n    },\n    /**\r\n     * æ¸…ç©ºç”»å¸ƒæ•°æ®å’Œè§†å›¾çŠ¶æ€\r\n     */\n    clearCanvas() {\n      // 1. åœæ­¢æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ AI ä»»åŠ¡å®šæ—¶å™¨\n      this.nodes.forEach(node => {\n        if (node.timer) {\n          this.stopQueryTimer(node);\n        }\n      });\n\n      // 2. é‡ç½®æ•°æ®æ¨¡å‹\n      this.nodes = [];\n      this.edges = [];\n      this.selectedNodeId = null;\n      this.queryTimers.clear();\n\n      // 3. é‡ç½®è§†å›¾çŠ¶æ€\n      this.offsetX = 0;\n      this.offsetY = 0;\n      this.scale = 1;\n\n      // 4. æ¸…é™¤æœ¬åœ°å­˜å‚¨\n      try {\n        localStorage.removeItem('infiniteCanvasState');\n      } catch (error) {\n        console.error('Error removing state from localStorage:', error);\n      }\n\n      // 5. é‡æ–°æ·»åŠ ä¸€ä¸ªåˆå§‹èŠ‚ç‚¹ï¼Œè®©ç”»å¸ƒä¸è‡³äºå®Œå…¨ç©ºç™½\n      this.$nextTick(() => {\n        this.nodes.push({\n          id: genId('n'),\n          x: 0,\n          y: 0,\n          width: 100,\n          height: 200,\n          title: 'æ¬¢è¿ä½¿ç”¨',\n          contentType: 'text',\n          content: 'åˆå§‹èŠ‚ç‚¹',\n          src: '',\n          status: 'ready',\n          timer: null\n        });\n      });\n    },\n    /**\r\n     * å°†å½“å‰ç”»å¸ƒçŠ¶æ€ï¼ˆèŠ‚ç‚¹ã€è¿çº¿ã€è§†å›¾ï¼‰ä¿å­˜åˆ° LocalStorage\r\n     */\n    // saveState() {\n    //     const state = {\n    //         nodes: this.nodes,\n    //         edges: this.edges,\n    //         offsetX: this.offsetX,\n    //         offsetY: this.offsetY,\n    //         scale: this.scale\n    //     };\n    //     try {\n    //         localStorage.setItem('infiniteCanvasState', JSON.stringify(state));\n    //         this.$message.success('ç”»å¸ƒçŠ¶æ€å·²æˆåŠŸä¿å­˜åˆ°æœ¬åœ°ï¼');\n    //     } catch (error) {\n    //         console.error('Error saving state to localStorage:', error);\n    //         this.$message.error('ä¿å­˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®ã€‚');\n    //     }\n    // },\n    /**\r\n     * å°†å½“å‰ç”»å¸ƒçŠ¶æ€ï¼ˆèŠ‚ç‚¹ã€è¿çº¿ã€è§†å›¾ï¼‰ä¿å­˜åˆ° LocalStorage\r\n     * ã€ä¼˜åŒ–ç‚¹ã€‘åœ¨ä¿å­˜æ—¶ï¼Œæ˜ç¡®æ’é™¤èŠ‚ç‚¹å¯¹è±¡ä¸Šçš„ 'timer' å¼•ç”¨ã€‚\r\n     */\n    saveState() {\n      // 1. å‡†å¤‡è¦ä¿å­˜çš„æ•°æ®ç»“æ„ï¼Œå»é™¤ä¸å¯åºåˆ—åŒ–çš„ timer\n      const serializableNodes = this.nodes.map(node => {\n        // ä½¿ç”¨è§£æ„èµ‹å€¼åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä¸åŒ…å« timer\n        const {\n          timer,\n          ...rest\n        } = node;\n        return rest;\n      });\n      const state = {\n        nodes: serializableNodes,\n        // ä½¿ç”¨å»é™¤ timer çš„èŠ‚ç‚¹åˆ—è¡¨\n        edges: this.edges,\n        offsetX: this.offsetX,\n        offsetY: this.offsetY,\n        scale: this.scale\n      };\n      try {\n        localStorage.setItem('infiniteCanvasState', JSON.stringify(state));\n        this.$message.success('ç”»å¸ƒçŠ¶æ€å·²æˆåŠŸä¿å­˜åˆ°æœ¬åœ°ï¼');\n      } catch (error) {\n        console.error('Error saving state to localStorage:', error);\n        this.$message.error('ä¿å­˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®ã€‚');\n      }\n    },\n    /**\r\n     * ä» LocalStorage åŠ è½½ç”»å¸ƒçŠ¶æ€\r\n     */\n    // loadState() {\n    //     try {\n    //         const savedState = localStorage.getItem('infiniteCanvasState');\n    //         if (savedState) {\n    //             const state = JSON.parse(savedState);\n\n    //             // ä»…åœ¨åˆå§‹ nodes ä¸ºç©ºæ—¶åŠ è½½ä¿å­˜çš„çŠ¶æ€ï¼Œé¿å…è¦†ç›–\n    //             if (this.nodes.length === 1 && this.nodes[0].content === 'åˆå§‹èŠ‚ç‚¹') {\n    //                 this.nodes = state.nodes || [];\n    //                 this.edges = state.edges || [];\n    //                 this.offsetX = state.offsetX || 0;\n    //                 this.offsetY = state.offsetY || 0;\n    //                 this.scale = state.scale || 1;\n\n    //                 // é‡æ–°å¯åŠ¨ä»»åŠ¡æ£€æŸ¥ï¼ˆé‡è¦ï¼šå¦‚æœèŠ‚ç‚¹å¤„äº processing çŠ¶æ€ï¼‰\n    //                 this.nodes.forEach(node => {\n    //                     // ç¡®ä¿åŠ è½½è¿›æ¥çš„èŠ‚ç‚¹æ¸…ç†äº†æ—§çš„å®šæ—¶å™¨å¼•ç”¨\n    //                     node.timer = null;\n\n    //                     if (node.status === 'processing' && node.taskId) {\n    //                         // é‡æ–°å¯åŠ¨è½®è¯¢ï¼Œå‡è®¾ AI ä»»åŠ¡ä»åœ¨åç«¯è¿è¡Œ\n    //                         const taskType = node.contentType === 'video' ? 'video' : 'image';\n    //                         this.$message.warning(`èŠ‚ç‚¹ ${node.id} ä»»åŠ¡æ¢å¤æ£€æŸ¥ä¸­...`);\n    //                         this.startQueryTimer(node, node.taskId, taskType);\n    //                     }\n    //                 });\n\n    //                 this.$message.success('ç”»å¸ƒçŠ¶æ€å·²ä»æœ¬åœ°åŠ è½½ã€‚');\n    //             }\n    //         } else {\n    //             // å¦‚æœæ²¡æœ‰ä¿å­˜è®°å½•ï¼Œç¡®ä¿åˆå§‹èŠ‚ç‚¹å­˜åœ¨\n    //             if (this.nodes.length === 0) {\n    //                 this.addNode('text');\n    //             }\n    //         }\n    //     } catch (error) {\n    //         console.error('Error loading state from localStorage:', error);\n    //     }\n    // },\n    // è¿”å›ä¸Šä¸€æ­¥\n    /**\r\n     * ä» LocalStorage åŠ è½½ç”»å¸ƒçŠ¶æ€\r\n     * ã€ä¼˜åŒ–ç‚¹ã€‘\r\n     * 1. ç®€åŒ–åŠ è½½æ—¶çš„åˆå§‹èŠ‚ç‚¹åˆ¤æ–­ã€‚\r\n     * 2. æ¢å¤è¿›è¡Œä¸­ä»»åŠ¡æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ taskType å­—æ®µã€‚\r\n     */\n    loadState() {\n      try {\n        const savedState = localStorage.getItem('infiniteCanvasState');\n        if (savedState) {\n          const state = JSON.parse(savedState);\n\n          // 1. ç›´æ¥ç”¨ä¿å­˜çš„çŠ¶æ€è¦†ç›–å½“å‰æ•°æ®\n          this.nodes = state.nodes || [];\n          this.edges = state.edges || [];\n          this.offsetX = state.offsetX || 0;\n          this.offsetY = state.offsetY || 0;\n          this.scale = state.scale || 1;\n\n          // 2. é‡æ–°å¯åŠ¨ä»»åŠ¡æ£€æŸ¥\n          this.nodes.forEach(node => {\n            // å¿…é¡»é‡æ–°æ·»åŠ å“åº”å¼å­—æ®µå¹¶æ¸…é™¤æ—§å¼•ç”¨\n            node.timer = null;\n            if (node.status === 'processing' && node.taskId) {\n              // ä¼˜å…ˆä½¿ç”¨ node.taskType å­—æ®µï¼ˆå¦‚æœå·²æ·»åŠ ï¼‰\n              let taskType = node.taskType || (node.contentType === 'video' ? 'video' : 'image');\n              this.startQueryTimer(node, node.taskId, taskType);\n            }\n          });\n          this.$message.success('ç”»å¸ƒçŠ¶æ€å·²ä»æœ¬åœ°åŠ è½½ã€‚');\n        } else {\n          // å¦‚æœæ²¡æœ‰ä¿å­˜è®°å½•ä¸”å½“å‰ç”»å¸ƒä¸ºç©ºï¼ˆä»…åœ¨ mount æ—¶è°ƒç”¨ loadState ä¿è¯ï¼‰\n          if (this.nodes.length === 0) {\n            // ç¡®ä¿ ID è®¡æ•°å™¨ä¹Ÿè¢«æ­£ç¡®åˆå§‹åŒ–\n            this.addNode('text');\n            this.$message.info('æœªæ‰¾åˆ°æœ¬åœ°ä¿å­˜æ•°æ®ï¼Œå·²åˆ›å»ºåˆå§‹èŠ‚ç‚¹ã€‚');\n          }\n        }\n      } catch (error) {\n        console.error('Error loading state from localStorage:', error);\n        this.$message.error('åŠ è½½å¤±è´¥ï¼Œå¯èƒ½æ•°æ®æ ¼å¼æœ‰è¯¯ã€‚');\n      }\n    },\n    goBack() {\n      this.$router.push('/group');\n    },\n    /**\r\n     * å¼¹æ¡†ç¡®è®¤æ“ä½œ\r\n     */\n    confirmAddChild() {\n      const parent = this.pendingParentNode;\n      if (!parent || !this.newChildText.trim()) {\n        this.$message.warning('è¯·è¾“å…¥æç¤ºè¯ä¿¡æ¯');\n        return;\n      }\n\n      // 1. åˆ›å»ºåŸºç¡€å­èŠ‚ç‚¹å¯¹è±¡\n      const child = {\n        id: genId('n'),\n        x: parent.x + parent.width + 100,\n        y: parent.y + parent.height / 2 - 75,\n        // æ–°èŠ‚ç‚¹å‚ç›´å±…ä¸­å¯¹é½\n        width: 300,\n        height: 200,\n        title: 'å­èŠ‚ç‚¹',\n        contentType: this.newChildType,\n        content: this.newChildText,\n        // æç¤ºè¯ä½œä¸ºå†…å®¹\n        src: '',\n        status: 'ready',\n        // é»˜è®¤çŠ¶æ€\n        timer: null\n      };\n      console.log('newChildType==', this.newChildType);\n\n      // 2. åˆ¤æ–­æ˜¯å¦ä¸º AI æ“ä½œ\n      if (this.newChildType.startsWith('image')) {\n        child.title = `AI ä»»åŠ¡ (${this.newChildType})`;\n        child.status = 'processing';\n        child.contentType = 'text'; // åˆå§‹ä»æ˜¾ç¤ºæç¤ºè¯\n\n        // å¯åŠ¨ AI ä»»åŠ¡\n        this.generatorImage(child, this.newChildType);\n      } else if (this.newChildType === 'video') {\n        // === æ–°å¢ï¼šè§†é¢‘ç”Ÿæˆé€»è¾‘ ===\n        child.title = `AI è§†é¢‘`;\n        child.status = 'processing';\n        child.contentType = 'text';\n        // è°ƒç”¨è§†é¢‘ç”Ÿæˆæ–¹æ³•\n        this.generatorImageToVieo(child, this.newChildType);\n      } else {\n        // æ™®é€šåª’ä½“èŠ‚ç‚¹\n        child.title = 'æ–°èŠ‚ç‚¹ - ' + this.newChildType;\n        child.src = this.newChildSrc;\n      }\n\n      // 3. æ·»åŠ èŠ‚ç‚¹å’Œè¿çº¿\n      this.nodes.push(child);\n      this.edges.push({\n        id: genId('e'),\n        fromId: parent.id,\n        toId: child.id\n      });\n      this.closeModal(); // å®Œæˆæ“ä½œåå…³é—­å¼¹çª—\n    },\n    /**\r\n     * æ–‡ç”Ÿå›¾æ¥å£/å›¾ç”Ÿå›¾ (å¯åŠ¨ä»»åŠ¡)\r\n     * @param {Object} node - æ­£åœ¨å¤„ç†çš„èŠ‚ç‚¹å¯¹è±¡\r\n     */\n    generatorImage(node, newChildType) {\n      const param = {\n        // ä½¿ç”¨èŠ‚ç‚¹ä¸­çš„æç¤ºè¯ä½œä¸º prompt\n        prompt: node.content,\n        // ä¼ é€’æ¨¡å‹å’Œé£æ ¼ï¼Œå¦‚æœæ¥å£éœ€è¦\n        modelType: this.form.modelType,\n        modelStyle: this.form.modelStyle,\n        filePath: this.pendingParentNode.src && this.pendingParentNode.src.trim() !== '' ? this.pendingParentNode.src : null\n      };\n\n      // ç¡®ä¿èŠ‚ç‚¹å¤„äºåŠ è½½çŠ¶æ€\n      node.status = 'processing';\n      node.title = `ç”Ÿæˆä¸­...`;\n\n      // å‡è®¾æ–‡ç”Ÿå›¾æ¥å£è¿”å›ä¸€ä¸ª taskId\n      (0, _ai.generatorImage)(param).then(res => {\n        if (res && res.data.code === 200 && res.data.data) {\n          const taskId = res.data.data;\n          node.taskId = taskId; // å­˜å‚¨ taskId åˆ°èŠ‚ç‚¹ä¸Š\n\n          console.log('taskId=', taskId);\n\n          // å¯åŠ¨å®šæ—¶æŸ¥è¯¢ä»»åŠ¡\n          this.startQueryTimer(node, taskId);\n        } else {\n          // ä»»åŠ¡å¯åŠ¨å¤±è´¥\n          node.status = 'failed';\n          node.title = 'ä»»åŠ¡å¯åŠ¨å¤±è´¥';\n          this.$message.error('AI ä»»åŠ¡å¯åŠ¨å¤±è´¥: ' + (res.data.msg || 'æœªçŸ¥é”™è¯¯'));\n        }\n      }).catch(err => {\n        console.error('Generator Image API Error:', err);\n        node.status = 'failed';\n        node.title = 'ç½‘ç»œé”™è¯¯';\n        this.$message.error('AI ä»»åŠ¡ç½‘ç»œé”™è¯¯');\n      });\n    },\n    /**\r\n     * å›¾ç”Ÿè§†é¢‘æ¥å£/å›¾ç”Ÿè§†é¢‘ï¼ˆå¯åŠ¨ä»»åŠ¡ï¼‰\r\n     */\n    generatorImageToVieo(node, newChildType) {\n      const param = {\n        prompt: node.content,\n        modelType: this.form.modelType,\n        modelStyle: this.form.modelStyle,\n        // è·å–çˆ¶èŠ‚ç‚¹çš„å›¾ç‰‡ä½œä¸ºè¾“å…¥ï¼ˆå¦‚æœæ˜¯å›¾ç”Ÿè§†é¢‘ï¼‰\n        filePath: this.pendingParentNode && this.pendingParentNode.src ? this.pendingParentNode.src : null\n      };\n\n      // 1. è®¾ç½®èŠ‚ç‚¹çŠ¶æ€\n      node.status = 'processing';\n      node.title = 'è§†é¢‘ç”Ÿæˆä¸­...';\n      // ç¡®ä¿å†…å®¹ç±»å‹æš‚æ—¶ä¸º textï¼Œä»¥ä¾¿æ˜¾ç¤ºåŠ è½½åŠ¨ç”»æˆ–æç¤ºè¯ï¼ŒæˆåŠŸåå†åˆ‡ä¸º video\n      node.contentType = 'text';\n\n      // 2. è°ƒç”¨ç”Ÿæˆæ¥å£\n      (0, _ai.generatorVideo)(param).then(res => {\n        if (res && res.data.code === 200 && res.data.data) {\n          const taskId = res.data.data;\n          node.taskId = taskId;\n\n          // 3. å¯åŠ¨å®šæ—¶æŸ¥è¯¢ä»»åŠ¡ (æ³¨æ„ç¬¬ä¸‰ä¸ªå‚æ•°ä¼  'video')\n          this.startQueryTimer(node, taskId, 'video');\n        } else {\n          node.status = 'failed';\n          node.title = 'ä»»åŠ¡å¯åŠ¨å¤±è´¥';\n          this.$message.error('è§†é¢‘ç”Ÿæˆä»»åŠ¡å¯åŠ¨å¤±è´¥');\n        }\n      }).catch(err => {\n        console.error('Generator Video API Error:', err);\n        node.status = 'failed';\n        node.title = 'ç½‘ç»œé”™è¯¯';\n      });\n    },\n    /**\r\n     * æŸ¥è¯¢å›¾ç‰‡ (è½®è¯¢ä»»åŠ¡çŠ¶æ€)\r\n     * @param {Object} node - æ­£åœ¨å¤„ç†çš„èŠ‚ç‚¹å¯¹è±¡\r\n     * @param {string} taskId - ä»»åŠ¡ID\r\n     */\n    queryGeneratoImage(node, taskId) {\n      const param = {\n        taskId\n      };\n      (0, _ai.queryResultTextToImage)(param).then(res => {\n        if (res && res.data.code === 200 && res.data.data) {\n          console.log('queryGeneratoImage=', res);\n          const state = res.data.data;\n          if (state === '0') {\n            console.log(`èŠ‚ç‚¹ ${node.id} æ’é˜Ÿä¸­`);\n            node.title = 'æ’é˜Ÿä¸­ (0)...';\n          } else if (state === '1') {\n            console.log(`èŠ‚ç‚¹ ${node.id} ç”Ÿæˆä¸­`);\n            node.title = 'ç”Ÿæˆä¸­ (1)...';\n          } else if (state === '3') {\n            // å¤±è´¥çŠ¶æ€\n            node.status = 'failed';\n            node.title = 'ç”Ÿæˆå¤±è´¥';\n            this.stopQueryTimer(node);\n            this.$message.error(`èŠ‚ç‚¹ ${node.id} AI ä»»åŠ¡å¤±è´¥`);\n          } else if (state === '-1') {\n            console.log('èŠ‚ç‚¹æ•°æ®å·²å®Œæˆ');\n            this.stopQueryTimer(node);\n          } else {\n            // æˆåŠŸçŠ¶æ€ (å‡è®¾ state åŒ…å«äº†æ–‡ä»¶ URL æˆ– fileUrl å­—æ®µ)\n            const fileUrl = state;\n            node.status = 'success';\n            node.title = 'ç”ŸæˆæˆåŠŸ';\n            node.contentType = 'image'; // å‡è®¾æ–‡ç”Ÿå›¾ç»“æœæ˜¯å›¾ç‰‡\n            node.src = fileUrl; // æ›´æ–°å›¾ç‰‡ URL\n\n            this.stopQueryTimer(node);\n            this.$message.success(`èŠ‚ç‚¹ ${node.id} å›¾ç‰‡ç”ŸæˆæˆåŠŸï¼`);\n          }\n        } else {\n          // æŸ¥è¯¢æ¥å£è¿”å›é”™è¯¯ï¼Œè§†ä¸ºå¤±è´¥\n          node.status = 'failed';\n          node.title = 'æŸ¥è¯¢å¤±è´¥';\n          this.stopQueryTimer(node);\n          this.$message.error('AI ä»»åŠ¡æŸ¥è¯¢å¤±è´¥');\n        }\n      }).catch(err => {\n        console.error('Query API Error:', err);\n        node.status = 'failed';\n        node.title = 'æŸ¥è¯¢ç½‘ç»œé”™è¯¯';\n        this.stopQueryTimer(node);\n      });\n    },\n    /**\r\n     * æŸ¥è¯¢è§†é¢‘ (è½®è¯¢ä»»åŠ¡çŠ¶æ€)\r\n     */\n    queryGeneratoImageVideo(node, taskId) {\n      const param = {\n        taskId\n      };\n      (0, _ai.queryVideoResult2)(param).then(res => {\n        if (res && res.data.code === 200 && res.data.data) {\n          const resDatas = res.data.data;\n          // æ³¨æ„ï¼šè¿™é‡Œæ ¹æ®ä½ æä¾›çš„é€»è¾‘ï¼Œresult ä¸ºå­—ç¬¦ä¸² '1' æˆ– '-1'\n\n          if (resDatas.result === '1') {\n            // === æˆåŠŸ ===\n            const videoUrl = resDatas.filePath;\n\n            // 1. æ›´æ–°èŠ‚ç‚¹çŠ¶æ€\n            node.status = 'success';\n            node.title = 'è§†é¢‘ç”ŸæˆæˆåŠŸ';\n\n            // 2. å…³é”®ï¼šåˆ‡æ¢èŠ‚ç‚¹ç±»å‹ä¸º videoï¼Œå¹¶èµ‹å€¼ src\n            node.contentType = 'video';\n            node.src = videoUrl;\n\n            // 3. åœæ­¢è½®è¯¢\n            this.stopQueryTimer(node);\n            this.$message.success(`èŠ‚ç‚¹ ${node.id} è§†é¢‘ç”Ÿæˆå®Œæˆï¼`);\n          } else if (resDatas.result === '-1') {\n            // === å¤±è´¥ ===\n            node.status = 'failed';\n            node.title = 'è§†é¢‘ç”Ÿæˆå¤±è´¥';\n            this.stopQueryTimer(node);\n            this.$message.error(`èŠ‚ç‚¹ ${node.id} è§†é¢‘ç”Ÿæˆå¤±è´¥`);\n          } else {\n            // === ç”Ÿæˆä¸­ (å‡è®¾å…¶ä»–çŠ¶æ€ç éƒ½æ˜¯ç”Ÿæˆä¸­) ===\n            console.log(`èŠ‚ç‚¹ ${node.id} è§†é¢‘å¤„ç†ä¸­...`);\n            // å¯ä»¥é€‰æ‹©æ€§æ›´æ–° titleï¼Œä¾‹å¦‚æ˜¾ç¤ºè¿›åº¦ï¼ˆå¦‚æœæœ‰è¿›åº¦å­—æ®µï¼‰\n            // node.title = `ç”Ÿæˆä¸­...`; \n          }\n        } else {\n          // æ¥å£è¿”å›å¼‚å¸¸\n          node.status = 'failed';\n          this.stopQueryTimer(node);\n        }\n      }).catch(err => {\n        console.error('Query Video API Error:', err);\n        node.status = 'failed';\n        this.stopQueryTimer(node);\n      });\n    },\n    /**\r\n     * å¯åŠ¨å®šæ—¶å™¨\r\n     * @param {Object} node - èŠ‚ç‚¹å¯¹è±¡\r\n     * @param {string} taskId - ä»»åŠ¡ID\r\n     * @param {string} taskType - ä»»åŠ¡ç±»å‹ 'image' | 'video' (é»˜è®¤ image)\r\n     */\n    startQueryTimer(node, taskId, taskType = 'image') {\n      // å…ˆæ¸…é™¤æ—§çš„ï¼ˆå¦‚æœæœ‰ï¼‰\n      this.stopQueryTimer(node);\n\n      // æ¯ 3 ç§’æŸ¥è¯¢ä¸€æ¬¡\n      const timer = setInterval(() => {\n        if (taskType === 'video') {\n          this.queryGeneratoImageVideo(node, taskId);\n        } else {\n          this.queryGeneratoImage(node, taskId);\n        }\n      }, 3000);\n\n      // å­˜å‚¨å®šæ—¶å™¨ ID åˆ°èŠ‚ç‚¹å’Œ Map\n      node.timer = timer;\n      this.queryTimers.set(node.id, timer);\n    },\n    // æ–°å¢: åœæ­¢å¹¶æ¸…ç†å®šæ—¶å™¨\n    stopQueryTimer(node) {\n      if (node.timer) {\n        clearInterval(node.timer);\n        node.timer = null;\n        this.queryTimers.delete(node.id);\n      }\n    },\n    onWindowMouseDownCloseModal(e) {\n      if (!this.isModalVisible) return;\n      const modal = this.$el.querySelector('.modal-content-floating');\n\n      // 1. æ£€æŸ¥ç‚¹å‡»æ˜¯å¦å‘ç”Ÿåœ¨ Modal å†…éƒ¨\n      if (modal && modal.contains(e.target)) {\n        return; // ç‚¹å‡»åœ¨ Modal å†…éƒ¨ï¼Œä¸å…³é—­\n      }\n\n      // 2. æ–°å¢æ£€æŸ¥ï¼šæ£€æŸ¥ç‚¹å‡»æ˜¯å¦å‘ç”Ÿåœ¨ Element UI çš„ä¸‹æ‹‰åˆ—è¡¨ (Popper) å†…éƒ¨\n      // Element UI çš„ä¸‹æ‹‰ç»„ä»¶é€šå¸¸æœ‰ä¸€ä¸ªå…±åŒçš„ class æˆ–å±æ€§ï¼Œä¾‹å¦‚ 'el-select-dropdown'\n      // æˆ‘ä»¬å¯ä»¥å‘ä¸Šéå† DOM æ ‘æ£€æŸ¥çˆ¶å…ƒç´ æ˜¯å¦åŒ…å«è¿™ä¸ª classã€‚\n      let clickedPopper = false;\n      let target = e.target;\n      while (target && target.nodeName !== 'BODY') {\n        // å‡è®¾ Element UI ä¸‹æ‹‰æ¡†çš„ class ä¸º el-popper æˆ– el-select-dropdown\n        // å…·ä½“çš„ç±»åå¯èƒ½å›  Element UI ç‰ˆæœ¬è€Œå¼‚ï¼Œè¯·æ£€æŸ¥ä½ çš„å®é™… DOM\n        if (target.classList.contains('el-select-dropdown') || target.classList.contains('el-popper')) {\n          clickedPopper = true;\n          break;\n        }\n        target = target.parentNode;\n      }\n      if (clickedPopper) {\n        return; // ç‚¹å‡»åœ¨ Element UI ä¸‹æ‹‰æ¡†å†…éƒ¨ï¼Œä¸å…³é—­\n      }\n\n      // å¦‚æœæ—¢ä¸åœ¨ Modal å†…éƒ¨ï¼Œä¹Ÿä¸åœ¨ Element UI ä¸‹æ‹‰æ¡†å†…éƒ¨ï¼Œåˆ™å…³é—­\n      this.closeModal();\n    },\n    /**\r\n     * Enter ç¡®è®¤\r\n     */\n    handleFloatingInputEnter() {\n      if (this.globalSearchText.trim()) {\n        alert(`è§¦å‘æ“ä½œï¼š${this.globalSearchText} (æ­¤å¤„åº”æ‰§è¡Œæœç´¢æˆ–ç”Ÿæˆé€»è¾‘)`);\n      }\n    },\n    // æ·»åŠ å­èŠ‚ç‚¹-æ‰“å¼€å¼¹çª— (å·²ä¿®æ”¹å®šä½è®¡ç®—)\n    openAddChildModal(parent) {\n      this.pendingParentNode = parent;\n      this.newChildType = parent.contentType; // é»˜è®¤ç»§æ‰¿çˆ¶èŠ‚ç‚¹ç±»å‹\n      this.newChildText = '';\n      this.newChildSrc = '';\n      if (parent.contentType === 'text') {\n        this.newChildText = parent.text;\n      }\n      this.isModalVisible = true;\n\n      // --- æ–°å¢ï¼šè®¡ç®—å¼¹æ¡†åº”è¯¥å‡ºç°çš„ä½ç½® (ä¸–ç•Œåæ ‡) ---\n      // ç›®æ ‡ä½ç½®: çˆ¶èŠ‚ç‚¹å³ä¾§ 20px å¤„\n      this.modalPos = {\n        x: parent.x + parent.width + 20,\n        y: parent.y // ä¸çˆ¶èŠ‚ç‚¹é¡¶éƒ¨å¯¹é½\n      };\n\n      // èšç„¦è¾“å…¥æ¡† (ç¡®ä¿å¼¹çª—å·²æ¸²æŸ“)\n      this.$nextTick(() => {\n        const input = this.$el.querySelector('.modal-content-floating textarea, .modal-content-floating input');\n        if (input) input.focus();\n      });\n    },\n    /**\r\n     * å…³é—­å¼¹æ¡†\r\n     */\n    closeModal() {\n      this.isModalVisible = false;\n      this.pendingParentNode = null;\n      this.newChildText = '';\n      this.newChildSrc = '';\n      this.modalPos = {\n        x: 0,\n        y: 0\n      }; // æ¸…ç©ºä½ç½®\n    },\n    // --- åæ ‡ç³»ç»Ÿæ ¸å¿ƒ ---\n    worldToScreen(x, y) {\n      return {\n        x: (x + this.offsetX) * this.scale,\n        y: (y + this.offsetY) * this.scale\n      };\n    },\n    screenToWorld(x, y) {\n      return {\n        x: x / this.scale - this.offsetX,\n        y: y / this.scale - this.offsetY\n      };\n    },\n    // --- æ¸²æŸ“è¾…åŠ© ---\n    getNodeStyle(node) {\n      const pos = this.worldToScreen(node.x, node.y);\n      return {\n        transform: `translate(${pos.x}px, ${pos.y}px)`,\n        // ä½¿ç”¨ transform æ€§èƒ½æ›´å¥½\n        width: node.width * this.scale + 'px',\n        height: node.height * this.scale + 'px',\n        zIndex: this.selectedNodeId === node.id ? 10 : 1\n      };\n    },\n    getEdgePath(edge) {\n      const from = this.nodes.find(n => n.id === edge.fromId);\n      const to = this.nodes.find(n => n.id === edge.toId);\n      if (!from || !to) return '';\n\n      // ä¿æŒè¿çº¿å§‹ç»ˆä½¿ç”¨ä¸–ç•Œåæ ‡ç³»è¿›è¡Œè®¡ç®—ï¼Œç„¶åè½¬æ¢åˆ°å±å¹•åæ ‡\n      const startWorldX = from.x + from.width;\n      const startWorldY = from.y + from.height / 2;\n      const endWorldX = to.x;\n      const endWorldY = to.y + to.height / 2;\n      const start = this.worldToScreen(startWorldX, startWorldY);\n      const end = this.worldToScreen(endWorldX, endWorldY);\n      const dist = Math.abs(end.x - start.x) * 0.5;\n      const cp1 = {\n        x: start.x + dist,\n        y: start.y\n      }; // æ§åˆ¶ç‚¹1\n      const cp2 = {\n        x: end.x - dist,\n        y: end.y\n      }; // æ§åˆ¶ç‚¹2\n\n      return `M ${start.x} ${start.y} C ${cp1.x} ${cp1.y} ${cp2.x} ${cp2.y} ${end.x} ${end.y}`;\n    },\n    //ä¿®æ”¹2\n    // --- äº¤äº’äº‹ä»¶ ---\n    onCanvasMouseDown(e) {\n      // if (e.button !== 0) return; // åªå“åº”å·¦é”®\n\n      e.preventDefault(); // é˜»æ­¢å³é”®èœå•å¼¹å‡º\n\n      if (e.button === 2) {\n        this.isBoxSelecting = true; // å¼€å§‹æ¡†é€‰\n\n        console.log('e:', e);\n        console.log('isBoxSelecting=', this.isBoxSelecting);\n        this.boxSelectStart = {\n          x: e.clientX,\n          y: e.clientY\n        }; // è®°å½•æ¡†é€‰èµ·å§‹ç‚¹\n      }\n      this.isPanning = true;\n      this.panStart = {\n        x: e.clientX,\n        y: e.clientY\n      };\n      this.panOrigin = {\n        x: this.offsetX,\n        y: this.offsetY\n      };\n      this.selectedNodeId = null; // ç‚¹å‡»ç©ºç™½å–æ¶ˆé€‰ä¸­\n    },\n    //ä¿®æ”¹1ï¼š\n    // onNodeMouseDown(node, e) {\n    //     this.draggingNode = node;\n    //     this.selectedNodeId = node.id;\n    //     this.nodeDragStart = { x: e.clientX, y: e.clientY };\n    //     this.nodeOrigin = { x: node.x, y: node.y };\n    //     this.closeModal(); // å¼€å§‹æ‹–æ‹½èŠ‚ç‚¹æ—¶å…³é—­å¼¹çª—\n    // },\n    onNodeMouseDown(node, e) {\n      const isMultiSelect = e.ctrlKey || e.metaKey; // æŒ‰ä½Ctrlé”®æ—¶ä¸ºå¤šé€‰\n\n      if (isMultiSelect) {\n        // å¦‚æœèŠ‚ç‚¹å·²ç»è¢«é€‰ä¸­ï¼Œåˆ™å–æ¶ˆé€‰ä¸­\n        if (this.selectedNodeIds.includes(node.id)) {\n          this.selectedNodeIds = this.selectedNodeIds.filter(id => id !== node.id);\n        } else {\n          // å¦åˆ™ï¼Œé€‰ä¸­è¯¥èŠ‚ç‚¹\n          this.selectedNodeIds.push(node.id);\n        }\n      } else {\n        // æ²¡æœ‰æŒ‰ä½Ctrlé”®æ—¶ï¼Œåªé€‰ä¸­å½“å‰èŠ‚ç‚¹\n        this.selectedNodeIds = [node.id];\n      }\n    },\n    clearSelectedNodes() {\n      this.selectedNodeIds = [];\n    },\n    onNodeResizeMouseDown(node, e) {\n      this.resizingNode = node;\n      this.resizeStart = {\n        x: e.clientX,\n        y: e.clientY\n      };\n      this.resizeOriginSize = {\n        w: node.width,\n        h: node.height\n      };\n      this.closeModal(); // å¼€å§‹è°ƒæ•´å¤§å°æ—¶å…³é—­å¼¹çª—\n    },\n    // --- å…¨å±€é¼ æ ‡ç§»åŠ¨ (Windowçº§) ---\n    onWindowMouseMove(e) {\n      const canvasRect = this.$refs.canvas.getBoundingClientRect();\n      const mouseX = e.clientX - canvasRect.left;\n      const mouseY = e.clientY - canvasRect.top;\n\n      // 1. æ‹–æ‹½èŠ‚ç‚¹\n      if (this.draggingNode) {\n        const dx = (e.clientX - this.nodeDragStart.x) / this.scale;\n        const dy = (e.clientY - this.nodeDragStart.y) / this.scale;\n        this.draggingNode.x = this.nodeOrigin.x + dx;\n        this.draggingNode.y = this.nodeOrigin.y + dy;\n        return;\n      }\n      // 2. è°ƒæ•´å¤§å°\n      if (this.resizingNode) {\n        const dx = (e.clientX - this.resizeStart.x) / this.scale;\n        const dy = (e.clientY - this.resizeStart.y) / this.scale;\n        /***\r\n         * è®¾ç½®èŠ‚ç‚¹æ¡†ï¼šä¼¸ç¼©ä¸Šä¸‹é™\r\n         */\n        this.resizingNode.width = Math.max(180, this.resizeOriginSize.w + dx);\n        this.resizingNode.height = Math.max(120, this.resizeOriginSize.h + dy);\n        return;\n      }\n      // 3. æ‹–æ‹½ç”»å¸ƒ\n      if (this.isPanning) {\n        const dx = (e.clientX - this.panStart.x) / this.scale;\n        const dy = (e.clientY - this.panStart.y) / this.scale;\n        this.offsetX = this.panOrigin.x + dx;\n        this.offsetY = this.panOrigin.y + dy;\n      }\n    },\n    //ä¿®æ”¹3\n    onWindowMouseUp(e) {\n      this.isPanning = false;\n      this.draggingNode = null;\n      this.resizingNode = null;\n    },\n    onWheel(e) {\n      // ç¼©æ”¾æ­¥é•¿\n      const zoomIntensity = 0.1;\n      const delta = e.deltaY > 0 ? -zoomIntensity : zoomIntensity;\n\n      // è®¾ç½®ç¼©æ”¾ä¸Šé™ 5.0 (500%)ï¼Œä¸‹é™ 0.2 (20%)ï¼Œé˜²æ­¢èŠ‚ç‚¹åœ¨å±å¹•ä¸Šè¿‡å°\n      const MIN_SCALE = 0.6;\n      const MAX_SCALE = 5;\n      const newScale = Math.min(MAX_SCALE, Math.max(MIN_SCALE, this.scale + delta));\n\n      // ... (åç»­çš„ä¸­å¿ƒç‚¹ç¼©æ”¾é€»è¾‘ä¿æŒä¸å˜)\n\n      // è®¡ç®—é¼ æ ‡åœ¨ä¸–ç•Œåæ ‡ç³»çš„ä½ç½®ï¼Œç¡®ä¿ç¼©æ”¾ä»¥é¼ æ ‡ä¸ºä¸­å¿ƒ\n      const rect = this.$refs.canvas.getBoundingClientRect();\n      const mouseX = e.clientX - rect.left;\n      const mouseY = e.clientY - rect.top;\n      const worldPos = this.screenToWorld(mouseX, mouseY);\n\n      // æ›´æ–°ç¼©æ”¾\n      this.scale = newScale;\n\n      // ä¿®æ­£ Offset ä½¿å¾—ä¸–ç•Œåæ ‡ä¸‹çš„é¼ æ ‡ä½ç½®ä¿æŒä¸å˜\n      this.offsetX = mouseX / this.scale - worldPos.x;\n      this.offsetY = mouseY / this.scale - worldPos.y;\n    },\n    // --- ä¸šåŠ¡é€»è¾‘ ---\n    addNode(type = 'text') {\n      // åœ¨è§†å£ä¸­å¿ƒç”Ÿæˆ\n      const center = this.screenToWorld(this.$refs.canvas.clientWidth / 2, this.$refs.canvas.clientHeight / 2);\n      this.nodes.push({\n        id: genId('n'),\n        x: center.x - 100,\n        y: center.y - 75,\n        width: 200,\n        height: 150,\n        title: 'æ–°èŠ‚ç‚¹',\n        contentType: type,\n        content: '',\n        src: '',\n        // ======== æ–°å¢/æ›´æ–°å­—æ®µ ========\n        status: 'ready',\n        timer: null\n        // ============================\n      });\n    },\n    changeNodeType(node, type) {\n      node.contentType = type;\n    },\n    deleteNode(id) {\n      const nodeToDelete = this.nodes.find(n => n.id === id);\n      if (nodeToDelete) {\n        this.stopQueryTimer(nodeToDelete); // <-- å…³é”®ï¼šåœæ­¢å®šæ—¶å™¨\n      }\n      this.nodes = this.nodes.filter(n => n.id !== id);\n      this.edges = this.edges.filter(e => e.fromId !== id && e.toId !== id);\n    }\n  }\n};","map":{"version":3,"names":["_ai","require","idCounter","genId","prefix","_default","exports","default","name","data","taskId","labelPosition","form","modelType","modelStyle","styleOptions","label","value","modelOptions","selectedNodeIds","isBoxSelecting","boxSelectStart","x","y","boxSelectEnd","boxSelectStyle","draggingNode","nodeDragStart","groupDragOrigin","globalSearchText","isModalVisible","pendingParentNode","newChildType","newChildText","newChildSrc","modalPos","offsetX","offsetY","scale","isPanning","panStart","panOrigin","nodeOrigin","resizingNode","resizeStart","resizeOriginSize","w","h","selectedNodeId","nodes","id","width","height","title","contentType","content","src","status","timer","edges","processingNode","queryTimers","Map","mounted","window","addEventListener","onWindowMouseMove","onWindowMouseUp","onWindowMouseDownCloseModal","loadState","computed","getModalStyle","screenPos","worldToScreen","transform","beforeDestroy","removeEventListener","forEach","node","stopQueryTimer","console","log","methods","onCanvasMouseMove","e","clientX","clientY","left","top","onCanvasMouseUp","startX","Math","min","startY","endX","max","endY","filter","nodePos","getNodePosition","map","pos","clearData","$confirm","confirmButtonText","cancelButtonText","type","then","clearCanvas","$message","success","catch","error","clear","localStorage","removeItem","$nextTick","push","saveState","serializableNodes","rest","state","setItem","JSON","stringify","savedState","getItem","parse","taskType","startQueryTimer","length","addNode","info","goBack","$router","confirmAddChild","parent","trim","warning","child","startsWith","generatorImage","generatorImageToVieo","fromId","toId","closeModal","param","prompt","filePath","res","code","msg","err","generatorVideo","queryGeneratoImage","queryResultTextToImage","fileUrl","queryGeneratoImageVideo","queryVideoResult2","resDatas","result","videoUrl","setInterval","set","clearInterval","delete","modal","$el","querySelector","contains","target","clickedPopper","nodeName","classList","parentNode","handleFloatingInputEnter","alert","openAddChildModal","text","input","focus","screenToWorld","getNodeStyle","zIndex","getEdgePath","edge","from","find","n","to","startWorldX","startWorldY","endWorldX","endWorldY","start","end","dist","abs","cp1","cp2","onCanvasMouseDown","preventDefault","button","onNodeMouseDown","isMultiSelect","ctrlKey","metaKey","includes","clearSelectedNodes","onNodeResizeMouseDown","canvasRect","$refs","canvas","getBoundingClientRect","mouseX","mouseY","dx","dy","onWheel","zoomIntensity","delta","deltaY","MIN_SCALE","MAX_SCALE","newScale","rect","worldPos","center","clientWidth","clientHeight","changeNodeType","deleteNode","nodeToDelete"],"sources":["src/views/utils/Cava.vue"],"sourcesContent":["<template>\r\n    <div class=\"ice-wrapper\">\r\n        <div class=\"ice-toolbar\">\r\n            <div class=\"btn-group\">\r\n                <el-button-group>\r\n                    <el-button type=\"primary\" icon=\"el-icon-arrow-left\" @click=\"goBack()\">è¿”å›</el-button>\r\n                    <el-button @click=\"addNode('text')\" style=\"margin-left: 10px;\">æ·»åŠ èŠ‚ç‚¹</el-button>\r\n\r\n                    <el-button @click=\"saveState()\" style=\"margin-left: 10px;\">ä¿å­˜è‰ç¨¿</el-button>\r\n\r\n                    <el-button @click=\"clearData()\" style=\"margin-left: 10px;\">æ¸…ç©ºç”»å¸ƒ</el-button>\r\n                </el-button-group>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"ice-canvas\" ref=\"canvas\" @mousedown=\"onCanvasMouseDown\" @wheel.prevent=\"onWheel\">\r\n            <svg class=\"ice-edges-layer\">\r\n                <path v-for=\"edge in edges\" :key=\"edge.id\" :d=\"getEdgePath(edge)\" fill=\"none\" class=\"edge-background\" />\r\n                <path v-for=\"edge in edges\" :key=\"'main-' + edge.id\" :d=\"getEdgePath(edge)\" fill=\"none\"\r\n                    class=\"edge-foreground\" />\r\n            </svg>\r\n            <!-- :class=\"{ 'is-selected': selectedNodeId === node.id }\"  -->\r\n            <div v-for=\"node in nodes\" :key=\"node.id\" class=\"ice-node\"\r\n                :class=\"{ 'is-selected': selectedNodeIds.includes(node.id) }\" :style=\"getNodeStyle(node)\"\r\n                @mousedown.stop=\"onNodeMouseDown(node, $event)\">\r\n                <div class=\"ice-node-header\">\r\n                    <div class=\"ice-node-title\">{{ node.title || node.id }}</div>\r\n                    <div class=\"ice-node-actions\">\r\n                        <span title=\"åˆ‡æ¢ä¸ºæ–‡æœ¬\" @click.stop=\"changeNodeType(node, 'text')\"\r\n                            :class=\"{ active: node.contentType === 'text' }\">ğŸ“</span>\r\n                        <span title=\"åˆ‡æ¢ä¸ºå›¾ç‰‡\" @click.stop=\"changeNodeType(node, 'image')\"\r\n                            :class=\"{ active: node.contentType === 'image' }\">ğŸ–¼ï¸</span>\r\n                        <span title=\"åˆ‡æ¢ä¸ºè§†é¢‘\" @click.stop=\"changeNodeType(node, 'video')\"\r\n                            :class=\"{ active: node.contentType === 'video' }\">ğŸ¬</span>\r\n                        <span class=\"delete-btn\" @click.stop=\"deleteNode(node.id)\">âœ•</span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"ice-node-content\">\r\n\r\n                    <div v-if=\"node.status === 'processing'\" class=\"ice-node-loading-overlay\">\r\n                        <p>AI ä»»åŠ¡å¤„ç†ä¸­...</p>\r\n                    </div>\r\n\r\n                    <textarea v-if=\"node.contentType === 'text'\" v-model=\"node.content\" class=\"ice-node-textarea\"\r\n                        placeholder=\"è¾“å…¥æ–‡æœ¬...\" @mousedown.stop />\r\n\r\n                    <div v-else-if=\"node.contentType === 'image'\" class=\"ice-media-box\">\r\n                        <img v-if=\"node.src\" :src=\"node.src\" draggable=\"false\" />\r\n                        <div v-else class=\"placeholder\">è¯·è¾“å…¥å›¾ç‰‡ URL</div>\r\n                        <input class=\"url-input\" v-model=\"node.src\" placeholder=\"å›¾ç‰‡åœ°å€ https://...\" @mousedown.stop />\r\n                    </div>\r\n\r\n                    <div v-else-if=\"node.contentType === 'video'\" class=\"ice-media-box\">\r\n                        <video v-if=\"node.src\" :src=\"node.src\" controls muted></video>\r\n                        <div v-else class=\"placeholder\">è¯·è¾“å…¥è§†é¢‘ URL</div>\r\n                        <input class=\"url-input\" v-model=\"node.src\" placeholder=\"è§†é¢‘åœ°å€ mp4/webm...\" @mousedown.stop />\r\n                    </div>\r\n\r\n                </div>\r\n\r\n                <div class=\"ice-node-footer\">\r\n                    <span class=\"tag\">{{ node.contentType }}</span>\r\n                    <button class=\"add-child-btn\" @click.stop=\"openAddChildModal(node)\">\r\n                        <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\"\r\n                            stroke-width=\"4\">\r\n                            <path d=\"M12 5v14M5 12h14\" />\r\n                        </svg>\r\n                    </button>\r\n                </div>\r\n\r\n                <div class=\"ice-resize-handle\" @mousedown.stop=\"onNodeResizeMouseDown(node, $event)\"></div>\r\n            </div>\r\n\r\n            <!-- æ¡†é€‰åŒºåŸŸ -->\r\n            <div v-if=\"isBoxSelecting\" class=\"box-select\" :style=\"boxSelectStyle\"></div>\r\n\r\n        </div>\r\n\r\n        <div v-if=\"isModalVisible\" class=\"modal-content-floating\" :style=\"getModalStyle\">\r\n            <h3>ä¸ºèŠ‚ç‚¹ \"{{ pendingParentNode.title || pendingParentNode.id }}\" æ·»åŠ å­èŠ‚ç‚¹</h3>\r\n            <p>è¯·é€‰æ‹©ç±»å‹å¹¶è¾“å…¥å†…å®¹ï¼š</p>\r\n\r\n            <div class=\"modal-type-switcher\">\r\n                <button :class=\"{ active: newChildType === 'text' }\" @click=\"newChildType = 'text'\">æ–‡æœ¬ ğŸ“</button>\r\n\r\n                <button :class=\"{ active: newChildType === 'image' }\" @click=\"newChildType = 'image'\">å›¾ç‰‡ ğŸ–¼ï¸</button>\r\n\r\n                <button :class=\"{ active: newChildType === 'video' }\" @click=\"newChildType = 'video'\">è§†é¢‘ ğŸ¬</button>\r\n            </div>\r\n\r\n            <el-form ref=\"form\" :model=\"form\" label-width=\"80px\" :label-position=\"labelPosition\">\r\n                <el-form-item label=\"æ¨¡å‹åç§°\">\r\n                    <el-select v-model=\"form.modelType\" placeholder=\"è¯·é€‰æ‹©æ¨¡å‹åç§°\">\r\n                        <el-option v-for=\"item in modelOptions\" :key=\"item.value\" :label=\"item.label\"\r\n                            :value=\"item.value\">\r\n                        </el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"è¡Œæ–‡é£æ ¼\">\r\n                    <el-select v-model=\"form.modelStyle\" placeholder=\"è¯·é€‰æ‹©é£æ ¼\">\r\n                        <el-option v-for=\"item in styleOptions\" :key=\"item.value\" :label=\"item.label\"\r\n                            :value=\"item.value\">\r\n                        </el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n            </el-form>\r\n\r\n            <textarea v-model=\"newChildText\" placeholder=\"è¯·è¾“å…¥æç¤ºè¯ä¿¡æ¯...\" rows=\"4\" autofocus></textarea>\r\n\r\n            <div class=\"modal-actions\">\r\n                <button @click=\"closeModal\" class=\"btn-cancel\">å–æ¶ˆ</button>\r\n                <button @click=\"confirmAddChild\" class=\"btn-confirm\">ç¡®è®¤æ·»åŠ </button>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { generatorImage, queryResultTextToImage, generatorVideo, queryVideoResult2 } from '@/api/ai'\r\nlet idCounter = 3; // ä» 3 å¼€å§‹ï¼Œå› ä¸ºåˆå§‹ nodes ä¸­ n1 å’Œ n2 å·²å ç”¨\r\nconst genId = (prefix) => prefix + idCounter++;\r\n\r\nexport default {\r\n    name: 'InfiniteCanvasMedia',\r\n    data() {\r\n        return {\r\n            taskId: '',\r\n            labelPosition: 'left',\r\n            form: {\r\n                modelType: '',\r\n                modelStyle: ''\r\n            },\r\n            styleOptions: [\r\n                {\r\n                    label: 'å†™å®é£æ ¼',\r\n                    value: 'å†™å®é£æ ¼',\r\n                }, {\r\n                    label: 'åŠ¨æ¼«é£æ ¼',\r\n                    value: 'åŠ¨æ¼«é£æ ¼',\r\n                }\r\n            ],\r\n            //æ¨¡å‹ä¸‹æ‹‰æ¡†\r\n            modelOptions: [\r\n                {\r\n                    value: 'gpt-4.1',\r\n                    label: 'GPT-4.1ï¼ˆé»˜è®¤æ¨èï¼‰'\r\n                },\r\n                {\r\n                    value: 'gpt-4o',\r\n                    label: 'GPT-4o'\r\n                },\r\n                {\r\n                    value: 'gpt-4',\r\n                    label: 'GPT-4'\r\n                },\r\n                {\r\n                    value: 'gpt-3.5-turbo',\r\n                    label: 'GPT-3.5 Turbo'\r\n                },\r\n                {\r\n                    value: 'o3',\r\n                    label: 'O3'\r\n                }\r\n            ],\r\n            modelType: '',//æ¨¡å‹é€‰æ‹©\r\n            //=============================\r\n            // --- å¤šé€‰ & æ¡†é€‰çŠ¶æ€ (æ–°å¢/ä¿®æ”¹) ---\r\n            selectedNodeIds: [],         // å­˜å‚¨æ‰€æœ‰é€‰ä¸­èŠ‚ç‚¹çš„ ID\r\n            isBoxSelecting: false,       // æ˜¯å¦å¤„äºæ¡†é€‰æ¨¡å¼ (ç”±å³é”®è§¦å‘)\r\n            boxSelectStart: { x: 0, y: 0 }, // æ¡†é€‰èµ·å§‹ç‚¹ (å±å¹•åæ ‡)\r\n            boxSelectEnd: { x: 0, y: 0 },   // æ¡†é€‰ç»“æŸç‚¹ (å±å¹•åæ ‡)\r\n            boxSelectStyle: {}, // æ·»åŠ  boxSelectStyle åˆ° data\r\n            // --- äº¤äº’çŠ¶æ€ (ä¿®æ”¹ groupDragOrigin) ---\r\n            draggingNode: null,\r\n            nodeDragStart: { x: 0, y: 0 },\r\n            // å­˜å‚¨è¢«æ‹–æ‹½ç»„å†…æ‰€æœ‰èŠ‚ç‚¹çš„åˆå§‹ä½ç½® { id: {x, y} }\r\n            groupDragOrigin: {},\r\n            //============================\r\n            // æ‚¬æµ®è¾“å…¥æ¡†çŠ¶æ€\r\n            globalSearchText: 'pav', // ç¤ºä¾‹æ–‡æœ¬ï¼Œæ¨¡ä»¿å›¾ç‰‡ä¸­çš„è¾“å…¥\r\n            // æ–°å¢ï¼šModal çŠ¶æ€ç®¡ç†\r\n            isModalVisible: false,\r\n            pendingParentNode: null, // æš‚å­˜çš„çˆ¶èŠ‚ç‚¹å¯¹è±¡\r\n            newChildType: 'text',// æ–°å­èŠ‚ç‚¹ç±»å‹\r\n            newChildText: '', // æ–°å­èŠ‚ç‚¹æ–‡æœ¬å†…å®¹\r\n            newChildSrc: '',// æ–°å­èŠ‚ç‚¹ URL (ç”¨äºå›¾ç‰‡/è§†é¢‘)\r\n            modalPos: { x: 0, y: 0 },// å¼¹æ¡†åœ¨**ç”»å¸ƒåæ ‡ç³»**ä¸­çš„ä½ç½® (æ–°å¢åŠ )\r\n            // è§†å›¾å˜æ¢\r\n            offsetX: 0,\r\n            offsetY: 0,\r\n            scale: 1,\r\n            // äº¤äº’çŠ¶æ€\r\n            isPanning: false,\r\n            panStart: { x: 0, y: 0 },\r\n            panOrigin: { x: 0, y: 0 },\r\n            draggingNode: null,\r\n            nodeDragStart: { x: 0, y: 0 },\r\n            nodeOrigin: { x: 0, y: 0 },\r\n            resizingNode: null,\r\n            resizeStart: { x: 0, y: 0 },\r\n            resizeOriginSize: { w: 0, h: 0 },\r\n            selectedNodeId: null,\r\n            selectedNodeIds: [],//ä»¥é€‰ä¸­çš„ç»“ç‚¹æ•°ç»„\r\n            // æ•°æ®æ¨¡å‹\r\n            nodes: [\r\n                {\r\n                    id: genId('n'),\r\n                    x: 0, y: 0, width: 100, height: 150,\r\n                    title: 'æ¬¢è¿ä½¿ç”¨',\r\n                    contentType: 'text', // text | image | video\r\n                    content: 'åˆå§‹èŠ‚ç‚¹',\r\n                    src: '',\r\n                    status: 'ready', // æ–°å¢: èŠ‚ç‚¹çŠ¶æ€ (ready, processing, success, failed)\r\n                    timer: null       // æ–°å¢: å­˜å‚¨æŸ¥è¯¢å®šæ—¶å™¨ ID\r\n                }\r\n            ],\r\n            edges: [],\r\n            // æ–°å¢: å­˜å‚¨æ­£åœ¨å¤„ç†çš„ AI ä»»åŠ¡çš„èŠ‚ç‚¹å¼•ç”¨\r\n            processingNode: null,\r\n            // æ–°å¢: å­˜å‚¨æŸ¥è¯¢å®šæ—¶å™¨IDçš„Map\r\n            queryTimers: new Map(),\r\n        };\r\n    },\r\n    mounted() {\r\n        // ç»‘å®šå…¨å±€äº‹ä»¶ï¼Œé˜²æ­¢é¼ æ ‡æ‹–å‡ºç”»å¸ƒåŒºåŸŸå¯¼è‡´çŠ¶æ€å¡æ­»\r\n        window.addEventListener('mousemove', this.onWindowMouseMove);\r\n        window.addEventListener('mouseup', this.onWindowMouseUp);\r\n        // å¢åŠ ç‚¹å‡»ç”»å¸ƒå¤–éƒ¨å…³é—­å¼¹çª—çš„ç›‘å¬ (é‡è¦)\r\n        window.addEventListener('mousedown', this.onWindowMouseDownCloseModal);\r\n\r\n        //ç»„ä»¶åŠ è½½æ—¶å°è¯•åŠ è½½æœ¬åœ°æ•°æ®\r\n        this.loadState();\r\n    },\r\n    computed: {\r\n        /**\r\n         * è®¡ç®—æµ®åŠ¨å¼¹æ¡†çš„æ ·å¼ (å±å¹•åæ ‡)\r\n         */\r\n        getModalStyle() {\r\n            if (!this.isModalVisible) return {};\r\n            const screenPos = this.worldToScreen(this.modalPos.x, this.modalPos.y);\r\n            return {\r\n                transform: `translate(${screenPos.x}px, ${screenPos.y}px)`,\r\n                // å¼¹æ¡†ä¸éšç¼©æ”¾å˜åŒ–ï¼Œä¿æŒå›ºå®šå¤§å°\r\n                // transform: `translate(${screenPos.x}px, ${screenPos.y}px) scale(1)`, \r\n                // transform-origin: 0 0;\r\n            };\r\n        }\r\n    },\r\n    beforeDestroy() {\r\n        window.removeEventListener('mousemove', this.onWindowMouseMove);\r\n        window.removeEventListener('mouseup', this.onWindowMouseUp);\r\n        window.removeEventListener('mousedown', this.onWindowMouseDownCloseModal);\r\n\r\n        this.nodes.forEach(node => {\r\n            if (node.timer) {\r\n                this.stopQueryTimer(node);\r\n            }\r\n        });\r\n        console.log('ç»„ä»¶é”€æ¯ï¼Œæ‰€æœ‰ AI ä»»åŠ¡å®šæ—¶å™¨å·²åœæ­¢ã€‚');\r\n    },\r\n    methods: {\r\n        /**\r\n         * å¼€å§‹æ¡†é€‰\r\n         */\r\n        onCanvasMouseMove(e) {\r\n            console.log('æ¡†é€‰çŠ¶æ€ï¼š', this.isBoxSelecting)\r\n            if (!this.isBoxSelecting) return; // å¦‚æœæ²¡æœ‰æ¡†é€‰ï¼Œå¿½ç•¥äº‹ä»¶\r\n\r\n            // è®¡ç®—æ¡†é€‰çš„ç»“æŸä½ç½®\r\n            this.boxSelectEnd = { x: e.clientX, y: e.clientY };\r\n\r\n            // è®¡ç®—æ¡†é€‰åŒºåŸŸçš„å®½åº¦å’Œé«˜åº¦\r\n            const width = this.boxSelectEnd.x - this.boxSelectStart.x;\r\n            const height = this.boxSelectEnd.y - this.boxSelectStart.y;\r\n\r\n            // åŠ¨æ€æ›´æ–°é€‰æ¡†çš„æ ·å¼ï¼Œæ˜¾ç¤ºæ¡†é€‰åŒºåŸŸ\r\n            this.boxSelectStyle = {\r\n                left: this.boxSelectStart.x + 'px',\r\n                top: this.boxSelectStart.y + 'px',\r\n                width: `${width}px`,\r\n                height: `${height}px`\r\n            };\r\n        },\r\n\r\n        /**\r\n         * å®Œæˆæ¡†é€‰\r\n         */\r\n        onCanvasMouseUp(e) {\r\n            this.isBoxSelecting = false; // åœæ­¢æ¡†é€‰\r\n\r\n            // è®¡ç®—æ¡†é€‰åŒºåŸŸçš„å®é™…ä½ç½®å’Œå°ºå¯¸\r\n            const startX = Math.min(this.boxSelectStart.x, this.boxSelectEnd.x);\r\n            const startY = Math.min(this.boxSelectStart.y, this.boxSelectEnd.y);\r\n            const endX = Math.max(this.boxSelectStart.x, this.boxSelectEnd.x);\r\n            const endY = Math.max(this.boxSelectStart.y, this.boxSelectEnd.y);\r\n\r\n            // é€‰ä¸­æ‰€æœ‰åœ¨æ¡†é€‰åŒºåŸŸå†…çš„èŠ‚ç‚¹\r\n            this.selectedNodeIds = this.nodes.filter(node => {\r\n                const nodePos = this.getNodePosition(node);\r\n                return (\r\n                    nodePos.x >= startX &&\r\n                    nodePos.x + node.width <= endX &&\r\n                    nodePos.y >= startY &&\r\n                    nodePos.y + node.height <= endY\r\n                );\r\n            }).map(node => node.id);\r\n\r\n            // æ¸…é™¤æ¡†é€‰åŒºåŸŸæ ·å¼\r\n            this.boxSelectStyle = {};\r\n        },\r\n        // è·å–èŠ‚ç‚¹ä½ç½®ï¼ˆåŒ…æ‹¬å®½åº¦å’Œé«˜åº¦ï¼‰\r\n        getNodePosition(node) {\r\n            const pos = this.worldToScreen(node.x, node.y);\r\n            return {\r\n                x: pos.x,\r\n                y: pos.y,\r\n                width: node.width * this.scale,\r\n                height: node.height * this.scale\r\n            };\r\n        },\r\n        /**\r\n         * æç¤ºç”¨æˆ·ç¡®è®¤æ¸…ç©ºç”»å¸ƒ\r\n         */\r\n        clearData() {\r\n            this.$confirm('æ­¤æ“ä½œå°†æ¸…ç©ºæ‰€æœ‰èŠ‚ç‚¹ã€è¿çº¿ï¼Œå¹¶åˆ é™¤æœ¬åœ°ä¿å­˜çš„æ•°æ®ï¼Œæ˜¯å¦ç»§ç»­?', 'è­¦å‘Š', {\r\n                confirmButtonText: 'ç¡®å®šæ¸…ç©º',\r\n                cancelButtonText: 'å–æ¶ˆ',\r\n                type: 'warning'\r\n            }).then(() => {\r\n                this.clearCanvas();\r\n                this.$message.success('ç”»å¸ƒå·²æ¸…ç©ºå¹¶åˆ é™¤æœ¬åœ°æ•°æ®ã€‚');\r\n            }).catch(() => {\r\n                this.$message.error('å·²å–æ¶ˆæ¸…ç©ºæ“ä½œã€‚');\r\n            });\r\n        },\r\n        /**\r\n         * æ¸…ç©ºç”»å¸ƒæ•°æ®å’Œè§†å›¾çŠ¶æ€\r\n         */\r\n        clearCanvas() {\r\n            // 1. åœæ­¢æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ AI ä»»åŠ¡å®šæ—¶å™¨\r\n            this.nodes.forEach(node => {\r\n                if (node.timer) {\r\n                    this.stopQueryTimer(node);\r\n                }\r\n            });\r\n\r\n            // 2. é‡ç½®æ•°æ®æ¨¡å‹\r\n            this.nodes = [];\r\n            this.edges = [];\r\n            this.selectedNodeId = null;\r\n            this.queryTimers.clear();\r\n\r\n            // 3. é‡ç½®è§†å›¾çŠ¶æ€\r\n            this.offsetX = 0;\r\n            this.offsetY = 0;\r\n            this.scale = 1;\r\n\r\n            // 4. æ¸…é™¤æœ¬åœ°å­˜å‚¨\r\n            try {\r\n                localStorage.removeItem('infiniteCanvasState');\r\n            } catch (error) {\r\n                console.error('Error removing state from localStorage:', error);\r\n            }\r\n\r\n            // 5. é‡æ–°æ·»åŠ ä¸€ä¸ªåˆå§‹èŠ‚ç‚¹ï¼Œè®©ç”»å¸ƒä¸è‡³äºå®Œå…¨ç©ºç™½\r\n            this.$nextTick(() => {\r\n                this.nodes.push({\r\n                    id: genId('n'),\r\n                    x: 0, y: 0, width: 100, height: 200,\r\n                    title: 'æ¬¢è¿ä½¿ç”¨',\r\n                    contentType: 'text',\r\n                    content: 'åˆå§‹èŠ‚ç‚¹',\r\n                    src: '',\r\n                    status: 'ready',\r\n                    timer: null\r\n                })\r\n            });\r\n        },\r\n        /**\r\n         * å°†å½“å‰ç”»å¸ƒçŠ¶æ€ï¼ˆèŠ‚ç‚¹ã€è¿çº¿ã€è§†å›¾ï¼‰ä¿å­˜åˆ° LocalStorage\r\n         */\r\n        // saveState() {\r\n        //     const state = {\r\n        //         nodes: this.nodes,\r\n        //         edges: this.edges,\r\n        //         offsetX: this.offsetX,\r\n        //         offsetY: this.offsetY,\r\n        //         scale: this.scale\r\n        //     };\r\n        //     try {\r\n        //         localStorage.setItem('infiniteCanvasState', JSON.stringify(state));\r\n        //         this.$message.success('ç”»å¸ƒçŠ¶æ€å·²æˆåŠŸä¿å­˜åˆ°æœ¬åœ°ï¼');\r\n        //     } catch (error) {\r\n        //         console.error('Error saving state to localStorage:', error);\r\n        //         this.$message.error('ä¿å­˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®ã€‚');\r\n        //     }\r\n        // },\r\n        /**\r\n         * å°†å½“å‰ç”»å¸ƒçŠ¶æ€ï¼ˆèŠ‚ç‚¹ã€è¿çº¿ã€è§†å›¾ï¼‰ä¿å­˜åˆ° LocalStorage\r\n         * ã€ä¼˜åŒ–ç‚¹ã€‘åœ¨ä¿å­˜æ—¶ï¼Œæ˜ç¡®æ’é™¤èŠ‚ç‚¹å¯¹è±¡ä¸Šçš„ 'timer' å¼•ç”¨ã€‚\r\n         */\r\n        saveState() {\r\n            // 1. å‡†å¤‡è¦ä¿å­˜çš„æ•°æ®ç»“æ„ï¼Œå»é™¤ä¸å¯åºåˆ—åŒ–çš„ timer\r\n            const serializableNodes = this.nodes.map(node => {\r\n                // ä½¿ç”¨è§£æ„èµ‹å€¼åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä¸åŒ…å« timer\r\n                const { timer, ...rest } = node;\r\n                return rest;\r\n            });\r\n\r\n            const state = {\r\n                nodes: serializableNodes, // ä½¿ç”¨å»é™¤ timer çš„èŠ‚ç‚¹åˆ—è¡¨\r\n                edges: this.edges,\r\n                offsetX: this.offsetX,\r\n                offsetY: this.offsetY,\r\n                scale: this.scale,\r\n            };\r\n\r\n            try {\r\n                localStorage.setItem('infiniteCanvasState', JSON.stringify(state));\r\n                this.$message.success('ç”»å¸ƒçŠ¶æ€å·²æˆåŠŸä¿å­˜åˆ°æœ¬åœ°ï¼');\r\n            } catch (error) {\r\n                console.error('Error saving state to localStorage:', error);\r\n                this.$message.error('ä¿å­˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®ã€‚');\r\n            }\r\n        },\r\n        /**\r\n         * ä» LocalStorage åŠ è½½ç”»å¸ƒçŠ¶æ€\r\n         */\r\n        // loadState() {\r\n        //     try {\r\n        //         const savedState = localStorage.getItem('infiniteCanvasState');\r\n        //         if (savedState) {\r\n        //             const state = JSON.parse(savedState);\r\n\r\n        //             // ä»…åœ¨åˆå§‹ nodes ä¸ºç©ºæ—¶åŠ è½½ä¿å­˜çš„çŠ¶æ€ï¼Œé¿å…è¦†ç›–\r\n        //             if (this.nodes.length === 1 && this.nodes[0].content === 'åˆå§‹èŠ‚ç‚¹') {\r\n        //                 this.nodes = state.nodes || [];\r\n        //                 this.edges = state.edges || [];\r\n        //                 this.offsetX = state.offsetX || 0;\r\n        //                 this.offsetY = state.offsetY || 0;\r\n        //                 this.scale = state.scale || 1;\r\n\r\n        //                 // é‡æ–°å¯åŠ¨ä»»åŠ¡æ£€æŸ¥ï¼ˆé‡è¦ï¼šå¦‚æœèŠ‚ç‚¹å¤„äº processing çŠ¶æ€ï¼‰\r\n        //                 this.nodes.forEach(node => {\r\n        //                     // ç¡®ä¿åŠ è½½è¿›æ¥çš„èŠ‚ç‚¹æ¸…ç†äº†æ—§çš„å®šæ—¶å™¨å¼•ç”¨\r\n        //                     node.timer = null;\r\n\r\n        //                     if (node.status === 'processing' && node.taskId) {\r\n        //                         // é‡æ–°å¯åŠ¨è½®è¯¢ï¼Œå‡è®¾ AI ä»»åŠ¡ä»åœ¨åç«¯è¿è¡Œ\r\n        //                         const taskType = node.contentType === 'video' ? 'video' : 'image';\r\n        //                         this.$message.warning(`èŠ‚ç‚¹ ${node.id} ä»»åŠ¡æ¢å¤æ£€æŸ¥ä¸­...`);\r\n        //                         this.startQueryTimer(node, node.taskId, taskType);\r\n        //                     }\r\n        //                 });\r\n\r\n        //                 this.$message.success('ç”»å¸ƒçŠ¶æ€å·²ä»æœ¬åœ°åŠ è½½ã€‚');\r\n        //             }\r\n        //         } else {\r\n        //             // å¦‚æœæ²¡æœ‰ä¿å­˜è®°å½•ï¼Œç¡®ä¿åˆå§‹èŠ‚ç‚¹å­˜åœ¨\r\n        //             if (this.nodes.length === 0) {\r\n        //                 this.addNode('text');\r\n        //             }\r\n        //         }\r\n        //     } catch (error) {\r\n        //         console.error('Error loading state from localStorage:', error);\r\n        //     }\r\n        // },\r\n        // è¿”å›ä¸Šä¸€æ­¥\r\n        /**\r\n         * ä» LocalStorage åŠ è½½ç”»å¸ƒçŠ¶æ€\r\n         * ã€ä¼˜åŒ–ç‚¹ã€‘\r\n         * 1. ç®€åŒ–åŠ è½½æ—¶çš„åˆå§‹èŠ‚ç‚¹åˆ¤æ–­ã€‚\r\n         * 2. æ¢å¤è¿›è¡Œä¸­ä»»åŠ¡æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ taskType å­—æ®µã€‚\r\n         */\r\n        loadState() {\r\n            try {\r\n                const savedState = localStorage.getItem('infiniteCanvasState');\r\n                if (savedState) {\r\n                    const state = JSON.parse(savedState);\r\n\r\n                    // 1. ç›´æ¥ç”¨ä¿å­˜çš„çŠ¶æ€è¦†ç›–å½“å‰æ•°æ®\r\n                    this.nodes = state.nodes || [];\r\n                    this.edges = state.edges || [];\r\n                    this.offsetX = state.offsetX || 0;\r\n                    this.offsetY = state.offsetY || 0;\r\n                    this.scale = state.scale || 1;\r\n\r\n                    // 2. é‡æ–°å¯åŠ¨ä»»åŠ¡æ£€æŸ¥\r\n                    this.nodes.forEach(node => {\r\n                        // å¿…é¡»é‡æ–°æ·»åŠ å“åº”å¼å­—æ®µå¹¶æ¸…é™¤æ—§å¼•ç”¨\r\n                        node.timer = null;\r\n\r\n                        if (node.status === 'processing' && node.taskId) {\r\n                            // ä¼˜å…ˆä½¿ç”¨ node.taskType å­—æ®µï¼ˆå¦‚æœå·²æ·»åŠ ï¼‰\r\n                            let taskType = node.taskType || (node.contentType === 'video' ? 'video' : 'image');\r\n\r\n                            this.startQueryTimer(node, node.taskId, taskType);\r\n                        }\r\n                    });\r\n\r\n                    this.$message.success('ç”»å¸ƒçŠ¶æ€å·²ä»æœ¬åœ°åŠ è½½ã€‚');\r\n\r\n                } else {\r\n                    // å¦‚æœæ²¡æœ‰ä¿å­˜è®°å½•ä¸”å½“å‰ç”»å¸ƒä¸ºç©ºï¼ˆä»…åœ¨ mount æ—¶è°ƒç”¨ loadState ä¿è¯ï¼‰\r\n                    if (this.nodes.length === 0) {\r\n                        // ç¡®ä¿ ID è®¡æ•°å™¨ä¹Ÿè¢«æ­£ç¡®åˆå§‹åŒ–\r\n                        this.addNode('text');\r\n                        this.$message.info('æœªæ‰¾åˆ°æœ¬åœ°ä¿å­˜æ•°æ®ï¼Œå·²åˆ›å»ºåˆå§‹èŠ‚ç‚¹ã€‚');\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                console.error('Error loading state from localStorage:', error);\r\n                this.$message.error('åŠ è½½å¤±è´¥ï¼Œå¯èƒ½æ•°æ®æ ¼å¼æœ‰è¯¯ã€‚');\r\n            }\r\n        },\r\n        goBack() {\r\n            this.$router.push('/group');\r\n        },\r\n        /**\r\n         * å¼¹æ¡†ç¡®è®¤æ“ä½œ\r\n         */\r\n        confirmAddChild() {\r\n            const parent = this.pendingParentNode;\r\n            if (!parent || !this.newChildText.trim()) {\r\n                this.$message.warning('è¯·è¾“å…¥æç¤ºè¯ä¿¡æ¯');\r\n                return;\r\n            }\r\n\r\n            // 1. åˆ›å»ºåŸºç¡€å­èŠ‚ç‚¹å¯¹è±¡\r\n            const child = {\r\n                id: genId('n'),\r\n                x: parent.x + parent.width + 100,\r\n                y: parent.y + parent.height / 2 - 75, // æ–°èŠ‚ç‚¹å‚ç›´å±…ä¸­å¯¹é½\r\n                width: 300,\r\n                height: 200,\r\n                title: 'å­èŠ‚ç‚¹',\r\n                contentType: this.newChildType,\r\n                content: this.newChildText, // æç¤ºè¯ä½œä¸ºå†…å®¹\r\n                src: '',\r\n                status: 'ready', // é»˜è®¤çŠ¶æ€\r\n                timer: null\r\n            };\r\n            console.log('newChildType==', this.newChildType)\r\n\r\n            // 2. åˆ¤æ–­æ˜¯å¦ä¸º AI æ“ä½œ\r\n            if (this.newChildType.startsWith('image')) {\r\n                child.title = `AI ä»»åŠ¡ (${this.newChildType})`;\r\n                child.status = 'processing';\r\n                child.contentType = 'text'; // åˆå§‹ä»æ˜¾ç¤ºæç¤ºè¯\r\n\r\n                // å¯åŠ¨ AI ä»»åŠ¡\r\n                this.generatorImage(child, this.newChildType);\r\n\r\n            } else if (this.newChildType === 'video') {\r\n                // === æ–°å¢ï¼šè§†é¢‘ç”Ÿæˆé€»è¾‘ ===\r\n                child.title = `AI è§†é¢‘`;\r\n                child.status = 'processing';\r\n                child.contentType = 'text';\r\n                // è°ƒç”¨è§†é¢‘ç”Ÿæˆæ–¹æ³•\r\n                this.generatorImageToVieo(child, this.newChildType);\r\n\r\n            } else {\r\n                // æ™®é€šåª’ä½“èŠ‚ç‚¹\r\n                child.title = 'æ–°èŠ‚ç‚¹ - ' + this.newChildType;\r\n                child.src = this.newChildSrc;\r\n            }\r\n\r\n            // 3. æ·»åŠ èŠ‚ç‚¹å’Œè¿çº¿\r\n            this.nodes.push(child);\r\n            this.edges.push({\r\n                id: genId('e'),\r\n                fromId: parent.id,\r\n                toId: child.id\r\n            });\r\n\r\n            this.closeModal(); // å®Œæˆæ“ä½œåå…³é—­å¼¹çª—\r\n        },\r\n        /**\r\n         * æ–‡ç”Ÿå›¾æ¥å£/å›¾ç”Ÿå›¾ (å¯åŠ¨ä»»åŠ¡)\r\n         * @param {Object} node - æ­£åœ¨å¤„ç†çš„èŠ‚ç‚¹å¯¹è±¡\r\n         */\r\n        generatorImage(node, newChildType) {\r\n\r\n            const param = {\r\n                // ä½¿ç”¨èŠ‚ç‚¹ä¸­çš„æç¤ºè¯ä½œä¸º prompt\r\n                prompt: node.content,\r\n                // ä¼ é€’æ¨¡å‹å’Œé£æ ¼ï¼Œå¦‚æœæ¥å£éœ€è¦\r\n                modelType: this.form.modelType,\r\n                modelStyle: this.form.modelStyle,\r\n                filePath: this.pendingParentNode.src && this.pendingParentNode.src.trim() !== ''\r\n                    ? this.pendingParentNode.src\r\n                    : null\r\n            };\r\n\r\n\r\n            // ç¡®ä¿èŠ‚ç‚¹å¤„äºåŠ è½½çŠ¶æ€\r\n            node.status = 'processing';\r\n            node.title = `ç”Ÿæˆä¸­...`;\r\n\r\n            // å‡è®¾æ–‡ç”Ÿå›¾æ¥å£è¿”å›ä¸€ä¸ª taskId\r\n            generatorImage(param).then(res => {\r\n                if (res && res.data.code === 200 && res.data.data) {\r\n                    const taskId = res.data.data;\r\n                    node.taskId = taskId; // å­˜å‚¨ taskId åˆ°èŠ‚ç‚¹ä¸Š\r\n\r\n                    console.log('taskId=', taskId)\r\n\r\n                    // å¯åŠ¨å®šæ—¶æŸ¥è¯¢ä»»åŠ¡\r\n                    this.startQueryTimer(node, taskId);\r\n\r\n                } else {\r\n                    // ä»»åŠ¡å¯åŠ¨å¤±è´¥\r\n                    node.status = 'failed';\r\n                    node.title = 'ä»»åŠ¡å¯åŠ¨å¤±è´¥';\r\n                    this.$message.error('AI ä»»åŠ¡å¯åŠ¨å¤±è´¥: ' + (res.data.msg || 'æœªçŸ¥é”™è¯¯'));\r\n                }\r\n            }).catch(err => {\r\n                console.error('Generator Image API Error:', err);\r\n                node.status = 'failed';\r\n                node.title = 'ç½‘ç»œé”™è¯¯';\r\n                this.$message.error('AI ä»»åŠ¡ç½‘ç»œé”™è¯¯');\r\n            });\r\n        },\r\n        /**\r\n         * å›¾ç”Ÿè§†é¢‘æ¥å£/å›¾ç”Ÿè§†é¢‘ï¼ˆå¯åŠ¨ä»»åŠ¡ï¼‰\r\n         */\r\n        generatorImageToVieo(node, newChildType) {\r\n            const param = {\r\n                prompt: node.content,\r\n                modelType: this.form.modelType,\r\n                modelStyle: this.form.modelStyle,\r\n                // è·å–çˆ¶èŠ‚ç‚¹çš„å›¾ç‰‡ä½œä¸ºè¾“å…¥ï¼ˆå¦‚æœæ˜¯å›¾ç”Ÿè§†é¢‘ï¼‰\r\n                filePath: this.pendingParentNode && this.pendingParentNode.src\r\n                    ? this.pendingParentNode.src\r\n                    : null\r\n            };\r\n\r\n            // 1. è®¾ç½®èŠ‚ç‚¹çŠ¶æ€\r\n            node.status = 'processing';\r\n            node.title = 'è§†é¢‘ç”Ÿæˆä¸­...';\r\n            // ç¡®ä¿å†…å®¹ç±»å‹æš‚æ—¶ä¸º textï¼Œä»¥ä¾¿æ˜¾ç¤ºåŠ è½½åŠ¨ç”»æˆ–æç¤ºè¯ï¼ŒæˆåŠŸåå†åˆ‡ä¸º video\r\n            node.contentType = 'text';\r\n\r\n            // 2. è°ƒç”¨ç”Ÿæˆæ¥å£\r\n            generatorVideo(param).then(res => {\r\n                if (res && res.data.code === 200 && res.data.data) {\r\n                    const taskId = res.data.data;\r\n                    node.taskId = taskId;\r\n\r\n                    // 3. å¯åŠ¨å®šæ—¶æŸ¥è¯¢ä»»åŠ¡ (æ³¨æ„ç¬¬ä¸‰ä¸ªå‚æ•°ä¼  'video')\r\n                    this.startQueryTimer(node, taskId, 'video');\r\n                } else {\r\n                    node.status = 'failed';\r\n                    node.title = 'ä»»åŠ¡å¯åŠ¨å¤±è´¥';\r\n                    this.$message.error('è§†é¢‘ç”Ÿæˆä»»åŠ¡å¯åŠ¨å¤±è´¥');\r\n                }\r\n            }).catch(err => {\r\n                console.error('Generator Video API Error:', err);\r\n                node.status = 'failed';\r\n                node.title = 'ç½‘ç»œé”™è¯¯';\r\n            });\r\n        },\r\n        /**\r\n         * æŸ¥è¯¢å›¾ç‰‡ (è½®è¯¢ä»»åŠ¡çŠ¶æ€)\r\n         * @param {Object} node - æ­£åœ¨å¤„ç†çš„èŠ‚ç‚¹å¯¹è±¡\r\n         * @param {string} taskId - ä»»åŠ¡ID\r\n         */\r\n        queryGeneratoImage(node, taskId) {\r\n            const param = { taskId };\r\n\r\n            queryResultTextToImage(param).then(res => {\r\n                if (res && res.data.code === 200 && res.data.data) {\r\n                    console.log('queryGeneratoImage=', res)\r\n                    const state = res.data.data;\r\n\r\n\r\n                    if (state === '0') {\r\n                        console.log(`èŠ‚ç‚¹ ${node.id} æ’é˜Ÿä¸­`);\r\n                        node.title = 'æ’é˜Ÿä¸­ (0)...';\r\n                    } else if (state === '1') {\r\n                        console.log(`èŠ‚ç‚¹ ${node.id} ç”Ÿæˆä¸­`);\r\n                        node.title = 'ç”Ÿæˆä¸­ (1)...';\r\n                    } else if (state === '3') {\r\n                        // å¤±è´¥çŠ¶æ€\r\n                        node.status = 'failed';\r\n                        node.title = 'ç”Ÿæˆå¤±è´¥';\r\n                        this.stopQueryTimer(node);\r\n                        this.$message.error(`èŠ‚ç‚¹ ${node.id} AI ä»»åŠ¡å¤±è´¥`);\r\n\r\n                    } else if (state === '-1') {\r\n                        console.log('èŠ‚ç‚¹æ•°æ®å·²å®Œæˆ')\r\n                        this.stopQueryTimer(node);\r\n                    } else {\r\n                        // æˆåŠŸçŠ¶æ€ (å‡è®¾ state åŒ…å«äº†æ–‡ä»¶ URL æˆ– fileUrl å­—æ®µ)\r\n                        const fileUrl = state;\r\n\r\n                        node.status = 'success';\r\n                        node.title = 'ç”ŸæˆæˆåŠŸ';\r\n                        node.contentType = 'image'; // å‡è®¾æ–‡ç”Ÿå›¾ç»“æœæ˜¯å›¾ç‰‡\r\n                        node.src = fileUrl; // æ›´æ–°å›¾ç‰‡ URL\r\n\r\n                        this.stopQueryTimer(node);\r\n                        this.$message.success(`èŠ‚ç‚¹ ${node.id} å›¾ç‰‡ç”ŸæˆæˆåŠŸï¼`);\r\n                    }\r\n                } else {\r\n                    // æŸ¥è¯¢æ¥å£è¿”å›é”™è¯¯ï¼Œè§†ä¸ºå¤±è´¥\r\n                    node.status = 'failed';\r\n                    node.title = 'æŸ¥è¯¢å¤±è´¥';\r\n                    this.stopQueryTimer(node);\r\n                    this.$message.error('AI ä»»åŠ¡æŸ¥è¯¢å¤±è´¥');\r\n                }\r\n            }).catch(err => {\r\n                console.error('Query API Error:', err);\r\n                node.status = 'failed';\r\n                node.title = 'æŸ¥è¯¢ç½‘ç»œé”™è¯¯';\r\n                this.stopQueryTimer(node);\r\n            });\r\n        },\r\n        /**\r\n         * æŸ¥è¯¢è§†é¢‘ (è½®è¯¢ä»»åŠ¡çŠ¶æ€)\r\n         */\r\n        queryGeneratoImageVideo(node, taskId) {\r\n            const param = { taskId };\r\n\r\n            queryVideoResult2(param).then(res => {\r\n                if (res && res.data.code === 200 && res.data.data) {\r\n                    const resDatas = res.data.data;\r\n                    // æ³¨æ„ï¼šè¿™é‡Œæ ¹æ®ä½ æä¾›çš„é€»è¾‘ï¼Œresult ä¸ºå­—ç¬¦ä¸² '1' æˆ– '-1'\r\n\r\n                    if (resDatas.result === '1') {\r\n                        // === æˆåŠŸ ===\r\n                        const videoUrl = resDatas.filePath;\r\n\r\n                        // 1. æ›´æ–°èŠ‚ç‚¹çŠ¶æ€\r\n                        node.status = 'success';\r\n                        node.title = 'è§†é¢‘ç”ŸæˆæˆåŠŸ';\r\n\r\n                        // 2. å…³é”®ï¼šåˆ‡æ¢èŠ‚ç‚¹ç±»å‹ä¸º videoï¼Œå¹¶èµ‹å€¼ src\r\n                        node.contentType = 'video';\r\n                        node.src = videoUrl;\r\n\r\n                        // 3. åœæ­¢è½®è¯¢\r\n                        this.stopQueryTimer(node);\r\n                        this.$message.success(`èŠ‚ç‚¹ ${node.id} è§†é¢‘ç”Ÿæˆå®Œæˆï¼`);\r\n\r\n                    } else if (resDatas.result === '-1') {\r\n                        // === å¤±è´¥ ===\r\n                        node.status = 'failed';\r\n                        node.title = 'è§†é¢‘ç”Ÿæˆå¤±è´¥';\r\n\r\n                        this.stopQueryTimer(node);\r\n                        this.$message.error(`èŠ‚ç‚¹ ${node.id} è§†é¢‘ç”Ÿæˆå¤±è´¥`);\r\n\r\n                    } else {\r\n                        // === ç”Ÿæˆä¸­ (å‡è®¾å…¶ä»–çŠ¶æ€ç éƒ½æ˜¯ç”Ÿæˆä¸­) ===\r\n                        console.log(`èŠ‚ç‚¹ ${node.id} è§†é¢‘å¤„ç†ä¸­...`);\r\n                        // å¯ä»¥é€‰æ‹©æ€§æ›´æ–° titleï¼Œä¾‹å¦‚æ˜¾ç¤ºè¿›åº¦ï¼ˆå¦‚æœæœ‰è¿›åº¦å­—æ®µï¼‰\r\n                        // node.title = `ç”Ÿæˆä¸­...`; \r\n                    }\r\n\r\n                } else {\r\n                    // æ¥å£è¿”å›å¼‚å¸¸\r\n                    node.status = 'failed';\r\n                    this.stopQueryTimer(node);\r\n                }\r\n            }).catch(err => {\r\n                console.error('Query Video API Error:', err);\r\n                node.status = 'failed';\r\n                this.stopQueryTimer(node);\r\n            });\r\n        },\r\n        /**\r\n         * å¯åŠ¨å®šæ—¶å™¨\r\n         * @param {Object} node - èŠ‚ç‚¹å¯¹è±¡\r\n         * @param {string} taskId - ä»»åŠ¡ID\r\n         * @param {string} taskType - ä»»åŠ¡ç±»å‹ 'image' | 'video' (é»˜è®¤ image)\r\n         */\r\n        startQueryTimer(node, taskId, taskType = 'image') {\r\n            // å…ˆæ¸…é™¤æ—§çš„ï¼ˆå¦‚æœæœ‰ï¼‰\r\n            this.stopQueryTimer(node);\r\n\r\n            // æ¯ 3 ç§’æŸ¥è¯¢ä¸€æ¬¡\r\n            const timer = setInterval(() => {\r\n                if (taskType === 'video') {\r\n                    this.queryGeneratoImageVideo(node, taskId);\r\n                } else {\r\n                    this.queryGeneratoImage(node, taskId);\r\n                }\r\n            }, 3000);\r\n\r\n            // å­˜å‚¨å®šæ—¶å™¨ ID åˆ°èŠ‚ç‚¹å’Œ Map\r\n            node.timer = timer;\r\n            this.queryTimers.set(node.id, timer);\r\n        },\r\n        // æ–°å¢: åœæ­¢å¹¶æ¸…ç†å®šæ—¶å™¨\r\n        stopQueryTimer(node) {\r\n            if (node.timer) {\r\n                clearInterval(node.timer);\r\n                node.timer = null;\r\n                this.queryTimers.delete(node.id);\r\n            }\r\n        },\r\n        onWindowMouseDownCloseModal(e) {\r\n            if (!this.isModalVisible) return;\r\n\r\n            const modal = this.$el.querySelector('.modal-content-floating');\r\n\r\n            // 1. æ£€æŸ¥ç‚¹å‡»æ˜¯å¦å‘ç”Ÿåœ¨ Modal å†…éƒ¨\r\n            if (modal && modal.contains(e.target)) {\r\n                return; // ç‚¹å‡»åœ¨ Modal å†…éƒ¨ï¼Œä¸å…³é—­\r\n            }\r\n\r\n            // 2. æ–°å¢æ£€æŸ¥ï¼šæ£€æŸ¥ç‚¹å‡»æ˜¯å¦å‘ç”Ÿåœ¨ Element UI çš„ä¸‹æ‹‰åˆ—è¡¨ (Popper) å†…éƒ¨\r\n            // Element UI çš„ä¸‹æ‹‰ç»„ä»¶é€šå¸¸æœ‰ä¸€ä¸ªå…±åŒçš„ class æˆ–å±æ€§ï¼Œä¾‹å¦‚ 'el-select-dropdown'\r\n            // æˆ‘ä»¬å¯ä»¥å‘ä¸Šéå† DOM æ ‘æ£€æŸ¥çˆ¶å…ƒç´ æ˜¯å¦åŒ…å«è¿™ä¸ª classã€‚\r\n            let clickedPopper = false;\r\n            let target = e.target;\r\n            while (target && target.nodeName !== 'BODY') {\r\n                // å‡è®¾ Element UI ä¸‹æ‹‰æ¡†çš„ class ä¸º el-popper æˆ– el-select-dropdown\r\n                // å…·ä½“çš„ç±»åå¯èƒ½å›  Element UI ç‰ˆæœ¬è€Œå¼‚ï¼Œè¯·æ£€æŸ¥ä½ çš„å®é™… DOM\r\n                if (target.classList.contains('el-select-dropdown') || target.classList.contains('el-popper')) {\r\n                    clickedPopper = true;\r\n                    break;\r\n                }\r\n                target = target.parentNode;\r\n            }\r\n\r\n            if (clickedPopper) {\r\n                return; // ç‚¹å‡»åœ¨ Element UI ä¸‹æ‹‰æ¡†å†…éƒ¨ï¼Œä¸å…³é—­\r\n            }\r\n\r\n            // å¦‚æœæ—¢ä¸åœ¨ Modal å†…éƒ¨ï¼Œä¹Ÿä¸åœ¨ Element UI ä¸‹æ‹‰æ¡†å†…éƒ¨ï¼Œåˆ™å…³é—­\r\n            this.closeModal();\r\n        },\r\n        /**\r\n         * Enter ç¡®è®¤\r\n         */\r\n        handleFloatingInputEnter() {\r\n            if (this.globalSearchText.trim()) {\r\n                alert(`è§¦å‘æ“ä½œï¼š${this.globalSearchText} (æ­¤å¤„åº”æ‰§è¡Œæœç´¢æˆ–ç”Ÿæˆé€»è¾‘)`);\r\n            }\r\n        },\r\n        // æ·»åŠ å­èŠ‚ç‚¹-æ‰“å¼€å¼¹çª— (å·²ä¿®æ”¹å®šä½è®¡ç®—)\r\n        openAddChildModal(parent) {\r\n            this.pendingParentNode = parent;\r\n            this.newChildType = parent.contentType; // é»˜è®¤ç»§æ‰¿çˆ¶èŠ‚ç‚¹ç±»å‹\r\n            this.newChildText = '';\r\n            this.newChildSrc = '';\r\n\r\n            if (parent.contentType === 'text') {\r\n                this.newChildText = parent.text;\r\n            }\r\n\r\n            this.isModalVisible = true;\r\n\r\n            // --- æ–°å¢ï¼šè®¡ç®—å¼¹æ¡†åº”è¯¥å‡ºç°çš„ä½ç½® (ä¸–ç•Œåæ ‡) ---\r\n            // ç›®æ ‡ä½ç½®: çˆ¶èŠ‚ç‚¹å³ä¾§ 20px å¤„\r\n            this.modalPos = {\r\n                x: parent.x + parent.width + 20,\r\n                y: parent.y // ä¸çˆ¶èŠ‚ç‚¹é¡¶éƒ¨å¯¹é½\r\n            };\r\n\r\n            // èšç„¦è¾“å…¥æ¡† (ç¡®ä¿å¼¹çª—å·²æ¸²æŸ“)\r\n            this.$nextTick(() => {\r\n                const input = this.$el.querySelector('.modal-content-floating textarea, .modal-content-floating input');\r\n                if (input) input.focus();\r\n            });\r\n        },\r\n        /**\r\n         * å…³é—­å¼¹æ¡†\r\n         */\r\n        closeModal() {\r\n            this.isModalVisible = false;\r\n            this.pendingParentNode = null;\r\n            this.newChildText = '';\r\n            this.newChildSrc = '';\r\n            this.modalPos = { x: 0, y: 0 }; // æ¸…ç©ºä½ç½®\r\n        },\r\n        // --- åæ ‡ç³»ç»Ÿæ ¸å¿ƒ ---\r\n        worldToScreen(x, y) {\r\n            return {\r\n                x: (x + this.offsetX) * this.scale,\r\n                y: (y + this.offsetY) * this.scale\r\n            };\r\n        },\r\n        screenToWorld(x, y) {\r\n            return {\r\n                x: x / this.scale - this.offsetX,\r\n                y: y / this.scale - this.offsetY\r\n            };\r\n        },\r\n\r\n        // --- æ¸²æŸ“è¾…åŠ© ---\r\n        getNodeStyle(node) {\r\n            const pos = this.worldToScreen(node.x, node.y);\r\n            return {\r\n                transform: `translate(${pos.x}px, ${pos.y}px)`, // ä½¿ç”¨ transform æ€§èƒ½æ›´å¥½\r\n                width: node.width * this.scale + 'px',\r\n                height: node.height * this.scale + 'px',\r\n                zIndex: this.selectedNodeId === node.id ? 10 : 1\r\n            };\r\n        },\r\n        getEdgePath(edge) {\r\n            const from = this.nodes.find(n => n.id === edge.fromId);\r\n            const to = this.nodes.find(n => n.id === edge.toId);\r\n            if (!from || !to) return '';\r\n\r\n            // ä¿æŒè¿çº¿å§‹ç»ˆä½¿ç”¨ä¸–ç•Œåæ ‡ç³»è¿›è¡Œè®¡ç®—ï¼Œç„¶åè½¬æ¢åˆ°å±å¹•åæ ‡\r\n            const startWorldX = from.x + from.width;\r\n            const startWorldY = from.y + from.height / 2;\r\n            const endWorldX = to.x;\r\n            const endWorldY = to.y + to.height / 2;\r\n\r\n            const start = this.worldToScreen(startWorldX, startWorldY);\r\n            const end = this.worldToScreen(endWorldX, endWorldY);\r\n\r\n            const dist = Math.abs(end.x - start.x) * 0.5;\r\n            const cp1 = { x: start.x + dist, y: start.y }; // æ§åˆ¶ç‚¹1\r\n            const cp2 = { x: end.x - dist, y: end.y };Â  Â  Â // æ§åˆ¶ç‚¹2\r\n\r\n            return `M ${start.x} ${start.y} C ${cp1.x} ${cp1.y} ${cp2.x} ${cp2.y} ${end.x} ${end.y}`;\r\n        },\r\n        //ä¿®æ”¹2\r\n        // --- äº¤äº’äº‹ä»¶ ---\r\n        onCanvasMouseDown(e) {\r\n            // if (e.button !== 0) return; // åªå“åº”å·¦é”®\r\n\r\n            e.preventDefault(); // é˜»æ­¢å³é”®èœå•å¼¹å‡º\r\n\r\n            if (e.button === 2) {\r\n                this.isBoxSelecting = true; // å¼€å§‹æ¡†é€‰\r\n\r\n                console.log('e:', e)\r\n                console.log('isBoxSelecting=', this.isBoxSelecting)\r\n                this.boxSelectStart = { x: e.clientX, y: e.clientY }; // è®°å½•æ¡†é€‰èµ·å§‹ç‚¹\r\n            }\r\n\r\n\r\n\r\n            this.isPanning = true;\r\n            this.panStart = { x: e.clientX, y: e.clientY };\r\n            this.panOrigin = { x: this.offsetX, y: this.offsetY };\r\n            this.selectedNodeId = null; // ç‚¹å‡»ç©ºç™½å–æ¶ˆé€‰ä¸­\r\n        },\r\n        //ä¿®æ”¹1ï¼š\r\n        // onNodeMouseDown(node, e) {\r\n        //     this.draggingNode = node;\r\n        //     this.selectedNodeId = node.id;\r\n        //     this.nodeDragStart = { x: e.clientX, y: e.clientY };\r\n        //     this.nodeOrigin = { x: node.x, y: node.y };\r\n        //     this.closeModal(); // å¼€å§‹æ‹–æ‹½èŠ‚ç‚¹æ—¶å…³é—­å¼¹çª—\r\n        // },\r\n        onNodeMouseDown(node, e) {\r\n            const isMultiSelect = e.ctrlKey || e.metaKey; // æŒ‰ä½Ctrlé”®æ—¶ä¸ºå¤šé€‰\r\n\r\n            if (isMultiSelect) {\r\n                // å¦‚æœèŠ‚ç‚¹å·²ç»è¢«é€‰ä¸­ï¼Œåˆ™å–æ¶ˆé€‰ä¸­\r\n                if (this.selectedNodeIds.includes(node.id)) {\r\n                    this.selectedNodeIds = this.selectedNodeIds.filter(id => id !== node.id);\r\n                } else {\r\n                    // å¦åˆ™ï¼Œé€‰ä¸­è¯¥èŠ‚ç‚¹\r\n                    this.selectedNodeIds.push(node.id);\r\n                }\r\n            } else {\r\n                // æ²¡æœ‰æŒ‰ä½Ctrlé”®æ—¶ï¼Œåªé€‰ä¸­å½“å‰èŠ‚ç‚¹\r\n                this.selectedNodeIds = [node.id];\r\n            }\r\n        },\r\n        clearSelectedNodes() {\r\n            this.selectedNodeIds = [];\r\n        },\r\n\r\n        onNodeResizeMouseDown(node, e) {\r\n            this.resizingNode = node;\r\n            this.resizeStart = { x: e.clientX, y: e.clientY };\r\n            this.resizeOriginSize = { w: node.width, h: node.height };\r\n            this.closeModal(); // å¼€å§‹è°ƒæ•´å¤§å°æ—¶å…³é—­å¼¹çª—\r\n        },\r\n\r\n        // --- å…¨å±€é¼ æ ‡ç§»åŠ¨ (Windowçº§) ---\r\n        onWindowMouseMove(e) {\r\n\r\n            const canvasRect = this.$refs.canvas.getBoundingClientRect();\r\n            const mouseX = e.clientX - canvasRect.left;\r\n            const mouseY = e.clientY - canvasRect.top;\r\n\r\n            // 1. æ‹–æ‹½èŠ‚ç‚¹\r\n            if (this.draggingNode) {\r\n                const dx = (e.clientX - this.nodeDragStart.x) / this.scale;\r\n                const dy = (e.clientY - this.nodeDragStart.y) / this.scale;\r\n                this.draggingNode.x = this.nodeOrigin.x + dx;\r\n                this.draggingNode.y = this.nodeOrigin.y + dy;\r\n                return;\r\n            }\r\n            // 2. è°ƒæ•´å¤§å°\r\n            if (this.resizingNode) {\r\n                const dx = (e.clientX - this.resizeStart.x) / this.scale;\r\n                const dy = (e.clientY - this.resizeStart.y) / this.scale;\r\n                /***\r\n                 * è®¾ç½®èŠ‚ç‚¹æ¡†ï¼šä¼¸ç¼©ä¸Šä¸‹é™\r\n                 */\r\n                this.resizingNode.width = Math.max(180, this.resizeOriginSize.w + dx);\r\n                this.resizingNode.height = Math.max(120, this.resizeOriginSize.h + dy);\r\n                return;\r\n            }\r\n            // 3. æ‹–æ‹½ç”»å¸ƒ\r\n            if (this.isPanning) {\r\n                const dx = (e.clientX - this.panStart.x) / this.scale;\r\n                const dy = (e.clientY - this.panStart.y) / this.scale;\r\n                this.offsetX = this.panOrigin.x + dx;\r\n                this.offsetY = this.panOrigin.y + dy;\r\n            }\r\n        },\r\n        //ä¿®æ”¹3\r\n        onWindowMouseUp(e) {\r\n            this.isPanning = false;\r\n            this.draggingNode = null;\r\n            this.resizingNode = null;\r\n        },\r\n        onWheel(e) {\r\n            // ç¼©æ”¾æ­¥é•¿\r\n            const zoomIntensity = 0.1;\r\n            const delta = e.deltaY > 0 ? -zoomIntensity : zoomIntensity;\r\n\r\n            // è®¾ç½®ç¼©æ”¾ä¸Šé™ 5.0 (500%)ï¼Œä¸‹é™ 0.2 (20%)ï¼Œé˜²æ­¢èŠ‚ç‚¹åœ¨å±å¹•ä¸Šè¿‡å°\r\n            const MIN_SCALE = 0.6;\r\n            const MAX_SCALE = 5;\r\n\r\n            const newScale = Math.min(MAX_SCALE, Math.max(MIN_SCALE, this.scale + delta));\r\n\r\n            // ... (åç»­çš„ä¸­å¿ƒç‚¹ç¼©æ”¾é€»è¾‘ä¿æŒä¸å˜)\r\n\r\n            // è®¡ç®—é¼ æ ‡åœ¨ä¸–ç•Œåæ ‡ç³»çš„ä½ç½®ï¼Œç¡®ä¿ç¼©æ”¾ä»¥é¼ æ ‡ä¸ºä¸­å¿ƒ\r\n            const rect = this.$refs.canvas.getBoundingClientRect();\r\n            const mouseX = e.clientX - rect.left;\r\n            const mouseY = e.clientY - rect.top;\r\n\r\n            const worldPos = this.screenToWorld(mouseX, mouseY);\r\n\r\n            // æ›´æ–°ç¼©æ”¾\r\n            this.scale = newScale;\r\n\r\n            // ä¿®æ­£ Offset ä½¿å¾—ä¸–ç•Œåæ ‡ä¸‹çš„é¼ æ ‡ä½ç½®ä¿æŒä¸å˜\r\n            this.offsetX = mouseX / this.scale - worldPos.x;\r\n            this.offsetY = mouseY / this.scale - worldPos.y;\r\n        },\r\n\r\n        // --- ä¸šåŠ¡é€»è¾‘ ---\r\n        addNode(type = 'text') {\r\n            // åœ¨è§†å£ä¸­å¿ƒç”Ÿæˆ\r\n            const center = this.screenToWorld(this.$refs.canvas.clientWidth / 2, this.$refs.canvas.clientHeight / 2);\r\n            this.nodes.push({\r\n                id: genId('n'),\r\n                x: center.x - 100,\r\n                y: center.y - 75,\r\n                width: 200,\r\n                height: 150,\r\n                title: 'æ–°èŠ‚ç‚¹',\r\n                contentType: type,\r\n                content: '',\r\n                src: '',\r\n                // ======== æ–°å¢/æ›´æ–°å­—æ®µ ========\r\n                status: 'ready',\r\n                timer: null\r\n                // ============================\r\n            });\r\n        },\r\n\r\n        changeNodeType(node, type) {\r\n            node.contentType = type;\r\n        },\r\n\r\n        deleteNode(id) {\r\n            const nodeToDelete = this.nodes.find(n => n.id === id);\r\n            if (nodeToDelete) {\r\n                this.stopQueryTimer(nodeToDelete); // <-- å…³é”®ï¼šåœæ­¢å®šæ—¶å™¨\r\n            }\r\n            this.nodes = this.nodes.filter(n => n.id !== id);\r\n            this.edges = this.edges.filter(e => e.fromId !== id && e.toId !== id);\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.box-select {\r\n    position: absolute;\r\n    border: 2px dashed #00f2ff;\r\n    background-color: rgba(0, 242, 255, 0.2);\r\n    pointer-events: none;\r\n    /* ä¸é˜»æ­¢é¼ æ ‡äº‹ä»¶ */\r\n    z-index: 10;\r\n}\r\n\r\n.is-selected {\r\n    border: 2px solid #00f2ff;\r\n    /* é€‰ä¸­èŠ‚ç‚¹çš„è¾¹æ¡†é¢œè‰² */\r\n    box-shadow: 0 0 10px rgba(0, 242, 255, 0.5);\r\n    /* ç»™é€‰ä¸­èŠ‚ç‚¹å¢åŠ é˜´å½±æ•ˆæœ */\r\n}\r\n\r\n/* ================================================================ */\r\n/* åŸºç¡€å®¹å™¨ */\r\n.ice-wrapper {\r\n    display: flex;\r\n    flex-direction: column;\r\n    height: 100vh;\r\n    width: 100vw;\r\n    background: #0f172a;\r\n    color: #e2e8f0;\r\n    overflow: hidden;\r\n    font-family: 'Segoe UI', sans-serif;\r\n}\r\n\r\n.ice-toolbar {\r\n    height: 56px;\r\n    background: #101620;\r\n    /* ä¿æŒæ·±ç°è“èƒŒæ™¯ */\r\n    border-bottom: 1px solid #334155;\r\n    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 0 20px;\r\n    justify-content: flex-start;\r\n    z-index: 20;\r\n}\r\n\r\n/* æŒ‰é’®ç»„å®¹å™¨ */\r\n.btn-group {\r\n    /* ä½¿ç”¨ gap æ›¿ä»£ margin-right */\r\n    display: flex;\r\n    gap: 12px;\r\n}\r\n\r\n.btn-group button {\r\n    /* æ ¸å¿ƒæ ·å¼ï¼šä½¿ç”¨ç•¥å¾®æ·±ä¸€ç‚¹çš„è“è‰²ä½œä¸ºé»˜è®¤è‰²ï¼Œä¸ºæ‚¬åœåšå‡†å¤‡ */\r\n    background: #1d4ed8;\r\n    border: none;\r\n    color: white;\r\n    padding: 8px 16px;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    font-size: 14px;\r\n    font-weight: 600;\r\n    transition: background 0.3s ease, transform 0.1s ease, box-shadow 0.3s ease;\r\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4), 0 0 10px rgba(56, 189, 248, 0.15);\r\n    /* å¢åŠ å¾®å¦™çš„ç§‘æŠ€å…‰æ„Ÿ */\r\n}\r\n\r\n.btn-group button:hover {\r\n    background: #3b82f6;\r\n    box-shadow: 0 0 5px rgba(59, 130, 246, 0.8), 0 4px 8px rgba(0, 0, 0, 0.5);\r\n    transform: translateY(-1px);\r\n}\r\n\r\n.btn-group button:active {\r\n    background: #1e40af;\r\n    box-shadow: none;\r\n    transform: translateY(1px);\r\n}\r\n\r\n/* ==================================================================  */\r\n/* ç”»å¸ƒ */\r\n.ice-canvas {\r\n    flex: 1;\r\n    position: relative;\r\n    overflow: hidden;\r\n    background: radial-gradient(#334155 1.5px, transparent 1.5px);\r\n    background-size: 18px 18px;\r\n}\r\n\r\n/* ç¡®ä¿ SVG è¿çº¿å±‚çš„ z-index ä½äºèŠ‚ç‚¹ */\r\n.ice-canvas .ice-edges-layer {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    pointer-events: none;\r\n    z-index: 1;\r\n}\r\n\r\n/* ==================================================================  */\r\n\r\n/* è¿çº¿ */\r\n.ice-edges-layer {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    pointer-events: none;\r\n    z-index: 1;\r\n}\r\n\r\n.ice-edges-layer path {\r\n    shape-rendering: geometricPrecision;\r\n    transition: stroke-width 0.2s, stroke 0.2s, opacity 0.2s;\r\n    /* æ·»åŠ å¹³æ»‘è¿‡æ¸¡ */\r\n}\r\n\r\n/* ğŸš€ èƒŒæ™¯å±‚ï¼ˆå…‰æ™•/æ·±åº¦çº¿ï¼‰ */\r\n.ice-edges-layer .edge-background {\r\n    stroke: #2563eb;\r\n    /* æ·±è“è‰² */\r\n    stroke-width: 4px;\r\n    /* è¾ƒç²— */\r\n    opacity: 0.5;\r\n    /* åŠé€æ˜ï¼Œä½œä¸ºå…‰æ™•æˆ–æ·±åº¦ */\r\n    /* ç§»é™¤è™šçº¿æ•ˆæœï¼Œä½¿ç”¨å®çº¿ */\r\n    stroke-dasharray: none;\r\n}\r\n\r\n/* ğŸš€ å‰æ™¯å±‚ï¼ˆä¸»çº¿/ç”µæµçº¿ï¼‰ */\r\n.ice-edges-layer .edge-foreground {\r\n    stroke: #38bdf8;\r\n    /* äº®é’è“è‰² */\r\n    stroke-width: 1.8px;\r\n    /* è¾ƒç»† */\r\n    opacity: 1;\r\n    /* å®Œå…¨ä¸é€æ˜ */\r\n    /* å¯é€‰ï¼šæ·»åŠ åŠ¨ç”»å®ç°â€œç”µæµâ€æ•ˆæœ */\r\n\r\n    /* æ ¸å¿ƒåŠ¨ç”»è®¾ç½®ï¼šåˆ›å»ºçº¿æ®µå’Œé—´éš™ */\r\n    stroke-dasharray: 20, 200;\r\n    /* çŸ­çº¿æ®µ (20) å’Œé•¿é—´éš™ (200)ï¼Œçªå‡ºâ€œæµåŠ¨ç‚¹â€ */\r\n\r\n    /* åº”ç”¨å¿«é€ŸåŠ¨ç”»ï¼š0.8ç§’å¾ªç¯ä¸€æ¬¡ï¼ŒåŒ€é€Ÿ */\r\n    animation: fast-flow 0.8s linear infinite;\r\n}\r\n\r\n/* è¿çº¿åŠ¨ç”»å®šä¹‰ */\r\n@keyframes fast-flow {\r\n\r\n    /* åç§»é‡ä» 0 ç§»åŠ¨åˆ° -220ï¼Œè®©è™šçº¿å‘å‰ç§»åŠ¨ä¸€ä¸ªå•ä½ */\r\n    100% {\r\n        stroke-dashoffset: -220;\r\n    }\r\n}\r\n\r\n/* å‡è®¾æ‚¨æœ‰é€»è¾‘åœ¨èŠ‚ç‚¹æ‚¬åœæ—¶ç»™èŠ‚ç‚¹æ·»åŠ ä¸€ä¸ª .is-hovered class */\r\n.ice-node.is-hovered~.ice-edges-layer .edge-background {\r\n    /* æ‚¬åœæ—¶åŠ ç²—å…‰æ™• */\r\n    stroke-width: 5px;\r\n    stroke: #60a5fa;\r\n    opacity: 0.7;\r\n}\r\n\r\n.ice-node.is-hovered~.ice-edges-layer .edge-foreground {\r\n    /* æ‚¬åœæ—¶ä¸»çº¿å˜äº® */\r\n    stroke: #a5f3fc;\r\n}\r\n\r\n.ice-node {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    /* èŠ‚ç‚¹ä¸»ä½“èƒŒæ™¯é¢œè‰² */\r\n    background: #1e293b;\r\n    border: 1px solid #334155;\r\n    /* é»˜è®¤è¾¹æ¡† */\r\n    border-radius: 12px;\r\n    /* é»˜è®¤é˜´å½± */\r\n    /* box-shadow: 0 6px 15px rgba(0, 0, 0, 0.5); */\r\n    display: flex;\r\n    flex-direction: column;\r\n    user-select: none;\r\n    transform-origin: 0 0;\r\n    min-width: 220px;\r\n    /* ç¨å¾®å¢åŠ å®½åº¦ */\r\n    min-height: 120px;\r\n    z-index: 10;\r\n    /* ç¡®ä¿èŠ‚ç‚¹åœ¨è¿çº¿ä¸Šæ–¹ */\r\n    transition: box-shadow 0.2s ease, border-color 0.2s ease;\r\n\r\n    /* ğŸš€ é»˜è®¤æŒç»­å¾®å¼±é˜´å½±å’Œå…‰åœˆ */\r\n    border-color: #38bdf8;\r\n    /* äº®é’è“è‰²è¾¹æ¡† */\r\n    /* æ ¸å¿ƒï¼šä¸‰å±‚é˜´å½±è¥é€ å…‰åœˆå’Œæ·±åº¦æ„Ÿ */\r\n    box-shadow:\r\n        0 0 0 3px rgba(56, 189, 248, 0.3),\r\n        /* å†…å±‚å‘å…‰ */\r\n        0 0 15px rgba(56, 189, 248, 0.5),\r\n        /* å¤–å±‚å…‰æ™• */\r\n        0 8px 20px rgba(0, 0, 0, 0.8);\r\n    /* åº•éƒ¨æ·±åº¦é˜´å½± */\r\n    filter: drop-shadow(0 0 4px rgba(56, 189, 248, 0.6));\r\n    /* è¿›ä¸€æ­¥å¢å¼ºå…‰æ™• */\r\n}\r\n\r\n.ice-node.is-selected {\r\n    /* 1. é¢œè‰²çªå˜ï¼šä½¿ç”¨é«˜äº®ç”µå…‰è“è‰²è¾¹æ¡† */\r\n    border-color: #4b5563;\r\n    /* è¾¹æ¡†æ¢å¤æ·±è‰²ï¼Œè®©å…‰æ™•æ•ˆæœæ›´æ˜æ˜¾ */\r\n\r\n    /* 2. è§†è§‰ç‰¹æ•ˆï¼šæ”¾å¤§ + æŠ¬å‡ */\r\n    transform: scale(1.02) translateY(-2px);\r\n    z-index: 20;\r\n    /* é€‰ä¸­æ—¶æå‡å±‚çº§ */\r\n\r\n    /* 3. å¼ºåŠ›å…‰åœˆï¼šä½¿ç”¨é«˜é¥±å’Œåº¦ç´«è‰²ä½œä¸ºé€‰ä¸­å¼ºè°ƒè‰² */\r\n    box-shadow:\r\n        0 0 0 3px rgba(129, 140, 248, 0.5),\r\n        /* å†…åœˆç´«è‰²å‘å…‰ */\r\n        0 0 25px rgba(167, 139, 250, 1),\r\n        /* å¼ºçƒˆçš„ç´«è‰²å¤–å±‚å…‰æ™• */\r\n        0 12px 30px rgba(0, 0, 0, 1);\r\n    /* æ›´æ·±çš„åº•éƒ¨é˜´å½± */\r\n\r\n    /* 4. æ»¤é•œå…‰æ™•å¢å¼º */\r\n    filter: drop-shadow(0 0 8px rgba(129, 140, 248, 0.9));\r\n}\r\n\r\n.ice-node-header {\r\n    height: 38px;\r\n    /* ç•¥å¾®å¢åŠ é«˜åº¦ï¼Œæ›´å…·åˆ†é‡ */\r\n    /* ğŸš€ å¢åŠ å¾®å¼±çš„æ¸å˜èƒŒæ™¯ï¼Œæå‡å±‚æ¬¡æ„Ÿ */\r\n    background: linear-gradient(to right, #2c3e50, #2c3e50 90%, #3a5068);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: 0 15px 0 12px;\r\n    /* è°ƒæ•´å†…è¾¹è· */\r\n    cursor: grab;\r\n    border-radius: 12px 12px 0 0;\r\n    /* ä½¿ç”¨æ·±è‰²è¾¹æ¡†ï¼Œå¢å¼ºåˆ†å‰²çº¿æ•ˆæœ */\r\n    border-bottom: 1px solid #4a627a;\r\n}\r\n\r\n.ice-node-header:active {\r\n    cursor: grabbing;\r\n    background: #334a60;\r\n    /* ç‚¹å‡»æ—¶èƒŒæ™¯ç•¥å¾®å˜æ·± */\r\n}\r\n\r\n\r\n.ice-node-title {\r\n    font-weight: 800;\r\n    font-size: 13px;\r\n    color: #e0f2f1;\r\n    letter-spacing: 1px;\r\n    text-transform: uppercase;\r\n\r\n    text-shadow:\r\n        0 0 2px rgba(125, 211, 252, 0.8),\r\n        0 0 8px rgba(56, 189, 248, 0.5);\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\n/* æ“ä½œå›¾æ ‡å®¹å™¨ */\r\n.ice-node-actions {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    /* ä½¿ç”¨ gap æ§åˆ¶é—´è· */\r\n}\r\n\r\n/* æ“ä½œå›¾æ ‡æ ·å¼ */\r\n.ice-node-actions span {\r\n    cursor: pointer;\r\n    font-size: 16px;\r\n    opacity: 0.7;\r\n    /* é»˜è®¤ç•¥å¾®é€æ˜ */\r\n    transition: opacity 0.2s, transform 0.1s;\r\n}\r\n\r\n.ice-node-actions span:hover,\r\n.ice-node-actions span.active {\r\n    opacity: 1;\r\n    color: #38bdf8;\r\n    transform: scale(1.1);\r\n    /* æ‚¬åœæ—¶å¾®å°æ”¾å¤§ */\r\n}\r\n\r\n\r\n.delete-btn {\r\n    color: #ef4444;\r\n}\r\n\r\n/* èŠ‚ç‚¹å†…å®¹ */\r\n.ice-node-content {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-direction: column;\r\n    overflow: hidden;\r\n    position: relative;\r\n    background: #0f172a;\r\n    padding: 5px;\r\n    /* æ·»åŠ ä¸€ç‚¹å†…è¾¹è· */\r\n\r\n    /* ğŸš€ æ ¸å¿ƒä¼˜åŒ–ï¼šä½¿ç”¨å†…å‘å…‰çš„ box-shadow æ¨¡æ‹Ÿå½©è‰²è¾¹æ¡† */\r\n    box-shadow:\r\n        /* å†…éƒ¨å‘å…‰ (inset)ï¼Œæ¨¡æ‹Ÿè¾¹æ¡†çº¿ */\r\n        inset 0 0 0 2px rgba(13, 160, 223, 0.5),\r\n        /* é’è“è‰²çº¿ */\r\n        /* å¢åŠ ä¸€ä¸ªå¾®å¼±çš„å†…å‘å…‰å…‰æ™• */\r\n        inset 0 0 5px rgba(56, 189, 248, 0.2);\r\n}\r\n\r\n\r\n/* æ–‡æœ¬æ¨¡å¼ */\r\n.ice-node-textarea {\r\n    /* --- 1. åŸºç¡€å¸ƒå±€ --- */\r\n    width: 100%;\r\n    height: 100%;\r\n    box-sizing: border-box;\r\n    /* å…³é”®ï¼šç¡®ä¿ padding ä¸ä¼šæ’‘å¤§ç›’å­ */\r\n    background: transparent;\r\n    border: none;\r\n    resize: none;\r\n    outline: none;\r\n\r\n    text-align: center;\r\n    padding: 10px;\r\n    color: #e2e8f0;\r\n    font-family: 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;\r\n    font-size: 15px;\r\n    /* ç¨å¾®è°ƒå¤§å­—å· */\r\n    font-weight: 500;\r\n    line-height: 1.8;\r\n    letter-spacing: 1px;\r\n    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    scrollbar-width: thin;\r\n    scrollbar-color: rgba(255, 255, 255, 0.2) transparent;\r\n}\r\n\r\n.ice-node-textarea::-webkit-scrollbar {\r\n    width: 4px;\r\n}\r\n\r\n.ice-node-textarea::-webkit-scrollbar-thumb {\r\n    background: rgba(255, 255, 255, 0.2);\r\n    border-radius: 4px;\r\n}\r\n\r\n.ice-node-textarea::-webkit-scrollbar-track {\r\n    background: transparent;\r\n}\r\n\r\n/* åª’ä½“æ¨¡å¼ (Image/Video) */\r\n.ice-media-box {\r\n    /* ä¿æŒå‚ç›´æ–¹å‘çš„ flex å¸ƒå±€ */\r\n    display: flex;\r\n    flex-direction: column;\r\n    width: 100%;\r\n    height: 100%;\r\n    position: relative;\r\n    /* ä¿æŒæ°´å¹³å’Œå‚ç›´å±…ä¸­ï¼Œç”¨äº placeholder */\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: #000;\r\n    overflow: hidden;\r\n    box-sizing: border-box;\r\n    /* å¢åŠ  box-sizing ç¡®ä¿è¾¹ç•Œè®¡ç®—æ­£ç¡® */\r\n}\r\n\r\n.ice-media-box img,\r\n.ice-media-box video {\r\n\r\n    flex-grow: 1;\r\n\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: contain;\r\n    /* ä¿æŒæ¯”ä¾‹ */\r\n    display: block;\r\n}\r\n\r\n.ice-media-box .placeholder {\r\n    color: #64748b;\r\n    font-size: 14px;\r\n    padding: 20px;\r\n    text-align: center;\r\n}\r\n\r\n.url-input {\r\n    position: absolute;\r\n    bottom: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    background: rgba(0, 0, 0, 0.8);\r\n    border: none;\r\n    color: white;\r\n    padding: 4px 8px;\r\n    font-size: 12px;\r\n    opacity: 0;\r\n    height: auto;\r\n    min-height: 30px;\r\n    transition: opacity 0.2s;\r\n    box-sizing: border-box;\r\n}\r\n\r\n/* åª’ä½“ä¸ºç©ºï¼Œæˆ–è€…é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºè¾“å…¥æ¡† */\r\n.ice-media-box:hover .url-input,\r\n.ice-media-box .placeholder~.url-input {\r\n    opacity: 1;\r\n}\r\n\r\n.ice-node-footer {\r\n    height: 30px;\r\n    /* ç•¥å¾®å¢åŠ é«˜åº¦ */\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    padding: 0 12px;\r\n    background: #101620;\r\n    /* æ¯”ä¸»ä½“èƒŒæ™¯ (#1e293b) æ›´æ·±çš„é¢œè‰²ï¼Œå¢åŠ åº•éƒ¨åšé‡æ„Ÿ */\r\n    border-top: 1px solid #334155;\r\n    border-radius: 0 0 12px 12px;\r\n}\r\n\r\n.tag {\r\n    font-size: 10px;\r\n    color: #a0aec0;\r\n    /* ç•¥å¾®æŸ”å’Œçš„ç™½è‰² */\r\n    text-transform: uppercase;\r\n    font-weight: 600;\r\n    padding: 2px 8px;\r\n    border-radius: 4px;\r\n    letter-spacing: 1px;\r\n}\r\n\r\n.add-child-btn {\r\n    background: none;\r\n    border: none;\r\n    color: #38bdf8;\r\n    cursor: pointer;\r\n    display: flex;\r\n    align-items: center;\r\n    /* ğŸš€ æŒ‰é’®åœ†å½¢å…‰åœˆæ•ˆæœ */\r\n    width: 35px;\r\n    height: 35px;\r\n    justify-content: center;\r\n    border-radius: 50%;\r\n    transition: background 0.2s, box-shadow 0.2s;\r\n}\r\n\r\n.add-child-btn:hover {\r\n    color: #a5f3fc;\r\n    background: rgba(56, 189, 248, 0.1);\r\n    box-shadow: 0 0 8px rgba(56, 189, 248, 0.5);\r\n    /* æ‚¬åœæ—¶å‡ºç°å…‰æ™• */\r\n}\r\n\r\n/* ç¼©æ”¾æ‰‹æŸ„ */\r\n.ice-resize-handle {\r\n    position: absolute;\r\n    right: 0;\r\n    bottom: 0;\r\n    width: 15px;\r\n    height: 15px;\r\n    cursor: nwse-resize;\r\n    background: transparent;\r\n    z-index: 20;\r\n}\r\n\r\n/* å¢åŠ ä¸€ä¸ªå¯è§†çš„å°ä¸‰è§’ */\r\n.ice-resize-handle::after {\r\n    content: '';\r\n    position: absolute;\r\n    right: 3px;\r\n    bottom: 3px;\r\n    border-right: 2px solid #38bdf8;\r\n    /* ä½¿ç”¨å¼ºè°ƒè‰² */\r\n    border-bottom: 2px solid #38bdf8;\r\n    width: 6px;\r\n    height: 6px;\r\n}\r\n</style>\r\n\r\n\r\n<style scoped>\r\n/* å±€éƒ¨æµ®åŠ¨ Modal æ ·å¼ï¼ˆç¾åŒ–ç‰ˆï¼‰ */\r\n.modal-content-floating {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    transform-origin: 0 0;\r\n    background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.18), transparent 55%),\r\n        radial-gradient(circle at bottom right, rgba(129, 140, 248, 0.2), transparent 55%),\r\n        rgba(15, 23, 42, 0.96);\r\n    backdrop-filter: blur(10px);\r\n\r\n    border: 1px solid rgba(148, 163, 184, 0.6);\r\n    border-radius: 14px;\r\n    padding: 18px 16px 14px;\r\n    box-shadow:\r\n        0 18px 45px rgba(0, 0, 0, 0.65),\r\n        0 0 0 1px rgba(15, 23, 42, 0.9);\r\n\r\n    width: 340px;\r\n    color: #e2e8f0;\r\n    z-index: 999;\r\n    pointer-events: auto;\r\n\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 10px;\r\n}\r\n\r\n/* æ ‡é¢˜è¡Œï¼šæ ‡é¢˜ + å…³é—­ç©ºé—´ */\r\n.modal-content-floating h3 {\r\n    margin: 0;\r\n    padding-bottom: 8px;\r\n    font-size: 15px;\r\n    font-weight: 600;\r\n    color: #e5e7eb;\r\n    border-bottom: 1px solid rgba(51, 65, 85, 0.9);\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 6px;\r\n}\r\n\r\n.modal-content-floating h3::before {\r\n    content: '';\r\n    width: 8px;\r\n    height: 8px;\r\n    border-radius: 999px;\r\n    background: radial-gradient(circle, #38bdf8, #6366f1);\r\n    box-shadow: 0 0 10px rgba(56, 189, 248, 0.9);\r\n}\r\n\r\n/* å°è¯´æ˜æ–‡å­— */\r\n.modal-content-floating p {\r\n    margin: 0;\r\n    font-size: 12px;\r\n    color: #9ca3af;\r\n}\r\n\r\n/* Element è¡¨å•åœ¨å¼¹çª—å†…çš„æ•´ä½“å‹ç¼©ä¸€ç‚¹é—´è· */\r\n.modal-content-floating .el-form {\r\n    margin-top: 4px;\r\n}\r\n\r\n.modal-content-floating .el-form-item {\r\n    margin-bottom: 10px;\r\n}\r\n\r\n.modal-content-floating .el-form-item__label {\r\n    color: #cbd5f5;\r\n    font-size: 12px;\r\n}\r\n\r\n/* é€‰æ‹©æ¡†æ ·å¼å¾®è°ƒ */\r\n.modal-content-floating .el-input__inner {\r\n    background-color: rgba(15, 23, 42, 0.9);\r\n    border-color: rgba(75, 85, 99, 0.9);\r\n    color: #e5e7eb;\r\n}\r\n\r\n.modal-content-floating .el-input__inner::placeholder {\r\n    color: #6b7280;\r\n}\r\n\r\n/* ç±»å‹åˆ‡æ¢æŒ‰é’®ç»„ */\r\n.modal-type-switcher {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 6px;\r\n    margin: 6px 0 4px;\r\n}\r\n\r\n.modal-type-switcher button {\r\n    background: rgba(30, 64, 175, 0.75);\r\n    border: 1px solid rgba(129, 140, 248, 0.5);\r\n    color: #e5e7eb;\r\n    padding: 4px 10px;\r\n    border-radius: 999px;\r\n    cursor: pointer;\r\n    font-size: 12px;\r\n    line-height: 1;\r\n    white-space: nowrap;\r\n    transition: all 0.18s ease;\r\n}\r\n\r\n.modal-type-switcher button:hover {\r\n    background: rgba(59, 130, 246, 0.9);\r\n    box-shadow: 0 0 0 1px rgba(191, 219, 254, 0.4);\r\n}\r\n\r\n.modal-type-switcher button.active {\r\n    background: #3b82f6;\r\n    border-color: #93c5fd;\r\n    box-shadow: 0 0 0 1px rgba(191, 219, 254, 0.5),\r\n        0 0 15px rgba(59, 130, 246, 0.75);\r\n}\r\n\r\n/* è¾“å…¥åŒºåŸŸï¼ˆtextarea / inputï¼‰ç»Ÿä¸€æ ·å¼ */\r\n.modal-content-floating textarea,\r\n.modal-content-floating input {\r\n    width: 100%;\r\n    padding: 9px 10px;\r\n    margin-top: 6px;\r\n    border: 1px solid rgba(71, 85, 105, 0.9);\r\n    border-radius: 8px;\r\n    background: rgba(15, 23, 42, 0.95);\r\n    color: #e5e7eb;\r\n    resize: vertical;\r\n    min-height: 70px;\r\n    box-sizing: border-box;\r\n    font-size: 13px;\r\n    outline: none;\r\n    transition: border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;\r\n}\r\n\r\n.modal-content-floating textarea::placeholder,\r\n.modal-content-floating input::placeholder {\r\n    color: #6b7280;\r\n}\r\n\r\n.modal-content-floating textarea:focus,\r\n.modal-content-floating input:focus {\r\n    border-color: #3b82f6;\r\n    box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.6);\r\n    background: rgba(15, 23, 42, 1);\r\n}\r\n\r\n/* åº•éƒ¨æŒ‰é’®åŒºåŸŸ */\r\n.modal-actions {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: 8px;\r\n    margin-top: 6px;\r\n}\r\n\r\n.modal-actions button {\r\n    padding: 7px 14px;\r\n    border: none;\r\n    border-radius: 999px;\r\n    cursor: pointer;\r\n    font-weight: 600;\r\n    font-size: 12px;\r\n    line-height: 1;\r\n    transition: all 0.18s ease;\r\n}\r\n\r\n/* å–æ¶ˆæŒ‰é’® */\r\n.btn-cancel {\r\n    background: rgba(31, 41, 55, 0.95);\r\n    color: #e5e7eb;\r\n}\r\n\r\n.btn-cancel:hover {\r\n    background: rgba(55, 65, 81, 0.95);\r\n}\r\n\r\n/* ç¡®è®¤æŒ‰é’® */\r\n.btn-confirm {\r\n    background: linear-gradient(135deg, #2563eb, #4f46e5);\r\n    color: #f9fafb;\r\n    box-shadow: 0 8px 18px rgba(37, 99, 235, 0.45);\r\n}\r\n\r\n.btn-confirm:hover {\r\n    transform: translateY(-1px);\r\n    box-shadow: 0 10px 22px rgba(59, 130, 246, 0.6);\r\n}\r\n\r\n/* ç¦ç”¨çŠ¶æ€ */\r\n.btn-confirm:disabled {\r\n    background: rgba(75, 85, 99, 0.8);\r\n    color: #9ca3af;\r\n    box-shadow: none;\r\n    cursor: not-allowed;\r\n    transform: none;\r\n}\r\n</style>\r\n\r\n<style>\r\n::v-deep .el-form-item__label {\r\n    color: #66b1ff;\r\n}\r\n\r\n.ice-node-loading-overlay {\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n\r\n    /* åŸºç¡€èƒŒæ™¯è‰²ï¼šä¿æŒæ·±è‰²åŸºåº• */\r\n    background-color: #2c3340;\r\n\r\n    /* æ ¸å¿ƒï¼šä½¿ç”¨çº¿æ€§æ¸å˜åˆ›å»ºé«˜äº®è„‰å†²å…‰å¸¦ */\r\n    background-image:\r\n        linear-gradient(90deg,\r\n            transparent 0%,\r\n            rgba(77, 219, 255, 0.5) 30%,\r\n            rgba(77, 219, 255, 0.15) 60%,\r\n            transparent 100%);\r\n\r\n    /* å…³é”® 1: æ‰©å¤§èƒŒæ™¯å°ºå¯¸ï¼Œç¡®ä¿å…‰å¸¦å¤Ÿé•¿ï¼Œä¸”è¡Œç¨‹è¶³å¤Ÿéšè—è·³è·ƒ */\r\n    background-size: 200% 100%;\r\n    /* background-repeat: no-repeat; */\r\n    background-repeat: repeat-x;\r\n\r\n    /* å…³é”® 2: åŠ¨ç”»é€Ÿåº¦æ”¾æ…¢ (4s)ï¼Œä½¿ç”¨ linear å®ç°ç¼“æ…¢åŒ€é€Ÿæ»‘åŠ¨ */\r\n    animation:\r\n        switch-slow-flow 4s linear infinite,\r\n        /* ä¸»å…‰å¸¦ç¼“æ…¢æ»‘åŠ¨ */\r\n        pulse-opacity 3s ease-in-out infinite alternate;\r\n    /* æ•´ä½“å‘¼å¸æ•ˆæœ */\r\n\r\n    color: #fff;\r\n    font-size: 14px;\r\n    z-index: 5;\r\n    border-radius: 8px;\r\n    overflow: hidden;\r\n\r\n    box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.3);\r\n}\r\n\r\n/* åŠ¨ç”» Aï¼šä¸»å…‰å¸¦ç¼“æ…¢ã€è¿ç»­åœ°ä»å·¦åˆ°å³æ»‘åŠ¨ */\r\n@keyframes switch-slow-flow {\r\n    0% {\r\n        /* èµ·ç‚¹ï¼šå…‰å¸¦åœ¨å·¦ä¾§å¤–éƒ¨ */\r\n        background-position: -200% 0;\r\n    }\r\n\r\n    100% {\r\n        /* ç»ˆç‚¹ï¼šå…‰å¸¦åœ¨å³ä¾§å¤–éƒ¨ */\r\n        background-position: 200% 0;\r\n    }\r\n}\r\n\r\n/* åŠ¨ç”» Bï¼šæ•´ä½“ç½©å±‚çš„ç»†å¾®å‘¼å¸æ•ˆæœ (ä¿æŒä¸å˜) */\r\n@keyframes pulse-opacity {\r\n    0% {\r\n        opacity: 1;\r\n    }\r\n\r\n    100% {\r\n        opacity: 0.95;\r\n    }\r\n}\r\n\r\n\r\n/* æ–‡æœ¬æ ·å¼ä¿æŒä¸å˜ (æ²¿ç”¨é«˜çº§æ„Ÿæ ·å¼) */\r\n.ice-node-loading-overlay p {\r\n    z-index: 10;\r\n    position: relative;\r\n    background-color: transparent;\r\n    border: none;\r\n    padding: 0;\r\n    border-radius: 0;\r\n    color: rgba(255, 255, 255, 0.9);\r\n    font-size: 16px;\r\n    font-weight: 500;\r\n    opacity: 0.6;\r\n    letter-spacing: 0.5px;\r\n    text-shadow:\r\n        0 0 5px rgba(0, 0, 0, 0.6),\r\n        0 0 10px rgba(0, 120, 255, 0.3);\r\n}\r\n\r\n.ice-node-loading-overlay p::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: -5px;\r\n    left: -10px;\r\n    right: -10px;\r\n    bottom: -5px;\r\n    border-radius: 6px;\r\n    z-index: -1;\r\n    backdrop-filter: blur(5px);\r\n    -webkit-backdrop-filter: blur(5px);\r\n}\r\n</style>"],"mappings":";;;;;;;;;;;;AAwHA,IAAAA,GAAA,GAAAC,OAAA;AACA,IAAAC,SAAA;AACA,MAAAC,KAAA,GAAAC,MAAA,IAAAA,MAAA,GAAAF,SAAA;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,MAAA;MACAC,aAAA;MACAC,IAAA;QACAC,SAAA;QACAC,UAAA;MACA;MACAC,YAAA,GACA;QACAC,KAAA;QACAC,KAAA;MACA;QACAD,KAAA;QACAC,KAAA;MACA,EACA;MACA;MACAC,YAAA,GACA;QACAD,KAAA;QACAD,KAAA;MACA,GACA;QACAC,KAAA;QACAD,KAAA;MACA,GACA;QACAC,KAAA;QACAD,KAAA;MACA,GACA;QACAC,KAAA;QACAD,KAAA;MACA,GACA;QACAC,KAAA;QACAD,KAAA;MACA,EACA;MACAH,SAAA;MAAA;MACA;MACA;MACAM,eAAA;MAAA;MACAC,cAAA;MAAA;MACAC,cAAA;QAAAC,CAAA;QAAAC,CAAA;MAAA;MAAA;MACAC,YAAA;QAAAF,CAAA;QAAAC,CAAA;MAAA;MAAA;MACAE,cAAA;MAAA;MACA;MACAC,YAAA;MACAC,aAAA;QAAAL,CAAA;QAAAC,CAAA;MAAA;MACA;MACAK,eAAA;MACA;MACA;MACAC,gBAAA;MAAA;MACA;MACAC,cAAA;MACAC,iBAAA;MAAA;MACAC,YAAA;MAAA;MACAC,YAAA;MAAA;MACAC,WAAA;MAAA;MACAC,QAAA;QAAAb,CAAA;QAAAC,CAAA;MAAA;MAAA;MACA;MACAa,OAAA;MACAC,OAAA;MACAC,KAAA;MACA;MACAC,SAAA;MACAC,QAAA;QAAAlB,CAAA;QAAAC,CAAA;MAAA;MACAkB,SAAA;QAAAnB,CAAA;QAAAC,CAAA;MAAA;MACAG,YAAA;MACAC,aAAA;QAAAL,CAAA;QAAAC,CAAA;MAAA;MACAmB,UAAA;QAAApB,CAAA;QAAAC,CAAA;MAAA;MACAoB,YAAA;MACAC,WAAA;QAAAtB,CAAA;QAAAC,CAAA;MAAA;MACAsB,gBAAA;QAAAC,CAAA;QAAAC,CAAA;MAAA;MACAC,cAAA;MACA7B,eAAA;MAAA;MACA;MACA8B,KAAA,GACA;QACAC,EAAA,EAAA/C,KAAA;QACAmB,CAAA;QAAAC,CAAA;QAAA4B,KAAA;QAAAC,MAAA;QACAC,KAAA;QACAC,WAAA;QAAA;QACAC,OAAA;QACAC,GAAA;QACAC,MAAA;QAAA;QACAC,KAAA;MACA,EACA;MACAC,KAAA;MACA;MACAC,cAAA;MACA;MACAC,WAAA,MAAAC,GAAA;IACA;EACA;EACAC,QAAA;IACA;IACAC,MAAA,CAAAC,gBAAA,mBAAAC,iBAAA;IACAF,MAAA,CAAAC,gBAAA,iBAAAE,eAAA;IACA;IACAH,MAAA,CAAAC,gBAAA,mBAAAG,2BAAA;;IAEA;IACA,KAAAC,SAAA;EACA;EACAC,QAAA;IACA;AACA;AACA;IACAC,cAAA;MACA,UAAAzC,cAAA;MACA,MAAA0C,SAAA,QAAAC,aAAA,MAAAtC,QAAA,CAAAb,CAAA,OAAAa,QAAA,CAAAZ,CAAA;MACA;QACAmD,SAAA,eAAAF,SAAA,CAAAlD,CAAA,OAAAkD,SAAA,CAAAjD,CAAA;QACA;QACA;QACA;MACA;IACA;EACA;EACAoD,cAAA;IACAX,MAAA,CAAAY,mBAAA,mBAAAV,iBAAA;IACAF,MAAA,CAAAY,mBAAA,iBAAAT,eAAA;IACAH,MAAA,CAAAY,mBAAA,mBAAAR,2BAAA;IAEA,KAAAnB,KAAA,CAAA4B,OAAA,CAAAC,IAAA;MACA,IAAAA,IAAA,CAAApB,KAAA;QACA,KAAAqB,cAAA,CAAAD,IAAA;MACA;IACA;IACAE,OAAA,CAAAC,GAAA;EACA;EACAC,OAAA;IACA;AACA;AACA;IACAC,kBAAAC,CAAA;MACAJ,OAAA,CAAAC,GAAA,eAAA7D,cAAA;MACA,UAAAA,cAAA;;MAEA;MACA,KAAAI,YAAA;QAAAF,CAAA,EAAA8D,CAAA,CAAAC,OAAA;QAAA9D,CAAA,EAAA6D,CAAA,CAAAE;MAAA;;MAEA;MACA,MAAAnC,KAAA,QAAA3B,YAAA,CAAAF,CAAA,QAAAD,cAAA,CAAAC,CAAA;MACA,MAAA8B,MAAA,QAAA5B,YAAA,CAAAD,CAAA,QAAAF,cAAA,CAAAE,CAAA;;MAEA;MACA,KAAAE,cAAA;QACA8D,IAAA,OAAAlE,cAAA,CAAAC,CAAA;QACAkE,GAAA,OAAAnE,cAAA,CAAAE,CAAA;QACA4B,KAAA,KAAAA,KAAA;QACAC,MAAA,KAAAA,MAAA;MACA;IACA;IAEA;AACA;AACA;IACAqC,gBAAAL,CAAA;MACA,KAAAhE,cAAA;;MAEA;MACA,MAAAsE,MAAA,GAAAC,IAAA,CAAAC,GAAA,MAAAvE,cAAA,CAAAC,CAAA,OAAAE,YAAA,CAAAF,CAAA;MACA,MAAAuE,MAAA,GAAAF,IAAA,CAAAC,GAAA,MAAAvE,cAAA,CAAAE,CAAA,OAAAC,YAAA,CAAAD,CAAA;MACA,MAAAuE,IAAA,GAAAH,IAAA,CAAAI,GAAA,MAAA1E,cAAA,CAAAC,CAAA,OAAAE,YAAA,CAAAF,CAAA;MACA,MAAA0E,IAAA,GAAAL,IAAA,CAAAI,GAAA,MAAA1E,cAAA,CAAAE,CAAA,OAAAC,YAAA,CAAAD,CAAA;;MAEA;MACA,KAAAJ,eAAA,QAAA8B,KAAA,CAAAgD,MAAA,CAAAnB,IAAA;QACA,MAAAoB,OAAA,QAAAC,eAAA,CAAArB,IAAA;QACA,OACAoB,OAAA,CAAA5E,CAAA,IAAAoE,MAAA,IACAQ,OAAA,CAAA5E,CAAA,GAAAwD,IAAA,CAAA3B,KAAA,IAAA2C,IAAA,IACAI,OAAA,CAAA3E,CAAA,IAAAsE,MAAA,IACAK,OAAA,CAAA3E,CAAA,GAAAuD,IAAA,CAAA1B,MAAA,IAAA4C,IAAA;MAEA,GAAAI,GAAA,CAAAtB,IAAA,IAAAA,IAAA,CAAA5B,EAAA;;MAEA;MACA,KAAAzB,cAAA;IACA;IACA;IACA0E,gBAAArB,IAAA;MACA,MAAAuB,GAAA,QAAA5B,aAAA,CAAAK,IAAA,CAAAxD,CAAA,EAAAwD,IAAA,CAAAvD,CAAA;MACA;QACAD,CAAA,EAAA+E,GAAA,CAAA/E,CAAA;QACAC,CAAA,EAAA8E,GAAA,CAAA9E,CAAA;QACA4B,KAAA,EAAA2B,IAAA,CAAA3B,KAAA,QAAAb,KAAA;QACAc,MAAA,EAAA0B,IAAA,CAAA1B,MAAA,QAAAd;MACA;IACA;IACA;AACA;AACA;IACAgE,UAAA;MACA,KAAAC,QAAA;QACAC,iBAAA;QACAC,gBAAA;QACAC,IAAA;MACA,GAAAC,IAAA;QACA,KAAAC,WAAA;QACA,KAAAC,QAAA,CAAAC,OAAA;MACA,GAAAC,KAAA;QACA,KAAAF,QAAA,CAAAG,KAAA;MACA;IACA;IACA;AACA;AACA;IACAJ,YAAA;MACA;MACA,KAAA3D,KAAA,CAAA4B,OAAA,CAAAC,IAAA;QACA,IAAAA,IAAA,CAAApB,KAAA;UACA,KAAAqB,cAAA,CAAAD,IAAA;QACA;MACA;;MAEA;MACA,KAAA7B,KAAA;MACA,KAAAU,KAAA;MACA,KAAAX,cAAA;MACA,KAAAa,WAAA,CAAAoD,KAAA;;MAEA;MACA,KAAA7E,OAAA;MACA,KAAAC,OAAA;MACA,KAAAC,KAAA;;MAEA;MACA;QACA4E,YAAA,CAAAC,UAAA;MACA,SAAAH,KAAA;QACAhC,OAAA,CAAAgC,KAAA,4CAAAA,KAAA;MACA;;MAEA;MACA,KAAAI,SAAA;QACA,KAAAnE,KAAA,CAAAoE,IAAA;UACAnE,EAAA,EAAA/C,KAAA;UACAmB,CAAA;UAAAC,CAAA;UAAA4B,KAAA;UAAAC,MAAA;UACAC,KAAA;UACAC,WAAA;UACAC,OAAA;UACAC,GAAA;UACAC,MAAA;UACAC,KAAA;QACA;MACA;IACA;IACA;AACA;AACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;AACA;AACA;AACA;IACA4D,UAAA;MACA;MACA,MAAAC,iBAAA,QAAAtE,KAAA,CAAAmD,GAAA,CAAAtB,IAAA;QACA;QACA;UAAApB,KAAA;UAAA,GAAA8D;QAAA,IAAA1C,IAAA;QACA,OAAA0C,IAAA;MACA;MAEA,MAAAC,KAAA;QACAxE,KAAA,EAAAsE,iBAAA;QAAA;QACA5D,KAAA,OAAAA,KAAA;QACAvB,OAAA,OAAAA,OAAA;QACAC,OAAA,OAAAA,OAAA;QACAC,KAAA,OAAAA;MACA;MAEA;QACA4E,YAAA,CAAAQ,OAAA,wBAAAC,IAAA,CAAAC,SAAA,CAAAH,KAAA;QACA,KAAAZ,QAAA,CAAAC,OAAA;MACA,SAAAE,KAAA;QACAhC,OAAA,CAAAgC,KAAA,wCAAAA,KAAA;QACA,KAAAH,QAAA,CAAAG,KAAA;MACA;IACA;IACA;AACA;AACA;IACA;IACA;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;AACA;AACA;AACA;AACA;AACA;IACA3C,UAAA;MACA;QACA,MAAAwD,UAAA,GAAAX,YAAA,CAAAY,OAAA;QACA,IAAAD,UAAA;UACA,MAAAJ,KAAA,GAAAE,IAAA,CAAAI,KAAA,CAAAF,UAAA;;UAEA;UACA,KAAA5E,KAAA,GAAAwE,KAAA,CAAAxE,KAAA;UACA,KAAAU,KAAA,GAAA8D,KAAA,CAAA9D,KAAA;UACA,KAAAvB,OAAA,GAAAqF,KAAA,CAAArF,OAAA;UACA,KAAAC,OAAA,GAAAoF,KAAA,CAAApF,OAAA;UACA,KAAAC,KAAA,GAAAmF,KAAA,CAAAnF,KAAA;;UAEA;UACA,KAAAW,KAAA,CAAA4B,OAAA,CAAAC,IAAA;YACA;YACAA,IAAA,CAAApB,KAAA;YAEA,IAAAoB,IAAA,CAAArB,MAAA,qBAAAqB,IAAA,CAAApE,MAAA;cACA;cACA,IAAAsH,QAAA,GAAAlD,IAAA,CAAAkD,QAAA,KAAAlD,IAAA,CAAAxB,WAAA;cAEA,KAAA2E,eAAA,CAAAnD,IAAA,EAAAA,IAAA,CAAApE,MAAA,EAAAsH,QAAA;YACA;UACA;UAEA,KAAAnB,QAAA,CAAAC,OAAA;QAEA;UACA;UACA,SAAA7D,KAAA,CAAAiF,MAAA;YACA;YACA,KAAAC,OAAA;YACA,KAAAtB,QAAA,CAAAuB,IAAA;UACA;QACA;MACA,SAAApB,KAAA;QACAhC,OAAA,CAAAgC,KAAA,2CAAAA,KAAA;QACA,KAAAH,QAAA,CAAAG,KAAA;MACA;IACA;IACAqB,OAAA;MACA,KAAAC,OAAA,CAAAjB,IAAA;IACA;IACA;AACA;AACA;IACAkB,gBAAA;MACA,MAAAC,MAAA,QAAAzG,iBAAA;MACA,KAAAyG,MAAA,UAAAvG,YAAA,CAAAwG,IAAA;QACA,KAAA5B,QAAA,CAAA6B,OAAA;QACA;MACA;;MAEA;MACA,MAAAC,KAAA;QACAzF,EAAA,EAAA/C,KAAA;QACAmB,CAAA,EAAAkH,MAAA,CAAAlH,CAAA,GAAAkH,MAAA,CAAArF,KAAA;QACA5B,CAAA,EAAAiH,MAAA,CAAAjH,CAAA,GAAAiH,MAAA,CAAApF,MAAA;QAAA;QACAD,KAAA;QACAC,MAAA;QACAC,KAAA;QACAC,WAAA,OAAAtB,YAAA;QACAuB,OAAA,OAAAtB,YAAA;QAAA;QACAuB,GAAA;QACAC,MAAA;QAAA;QACAC,KAAA;MACA;MACAsB,OAAA,CAAAC,GAAA,wBAAAjD,YAAA;;MAEA;MACA,SAAAA,YAAA,CAAA4G,UAAA;QACAD,KAAA,CAAAtF,KAAA,kBAAArB,YAAA;QACA2G,KAAA,CAAAlF,MAAA;QACAkF,KAAA,CAAArF,WAAA;;QAEA;QACA,KAAAuF,cAAA,CAAAF,KAAA,OAAA3G,YAAA;MAEA,gBAAAA,YAAA;QACA;QACA2G,KAAA,CAAAtF,KAAA;QACAsF,KAAA,CAAAlF,MAAA;QACAkF,KAAA,CAAArF,WAAA;QACA;QACA,KAAAwF,oBAAA,CAAAH,KAAA,OAAA3G,YAAA;MAEA;QACA;QACA2G,KAAA,CAAAtF,KAAA,mBAAArB,YAAA;QACA2G,KAAA,CAAAnF,GAAA,QAAAtB,WAAA;MACA;;MAEA;MACA,KAAAe,KAAA,CAAAoE,IAAA,CAAAsB,KAAA;MACA,KAAAhF,KAAA,CAAA0D,IAAA;QACAnE,EAAA,EAAA/C,KAAA;QACA4I,MAAA,EAAAP,MAAA,CAAAtF,EAAA;QACA8F,IAAA,EAAAL,KAAA,CAAAzF;MACA;MAEA,KAAA+F,UAAA;IACA;IACA;AACA;AACA;AACA;IACAJ,eAAA/D,IAAA,EAAA9C,YAAA;MAEA,MAAAkH,KAAA;QACA;QACAC,MAAA,EAAArE,IAAA,CAAAvB,OAAA;QACA;QACA1C,SAAA,OAAAD,IAAA,CAAAC,SAAA;QACAC,UAAA,OAAAF,IAAA,CAAAE,UAAA;QACAsI,QAAA,OAAArH,iBAAA,CAAAyB,GAAA,SAAAzB,iBAAA,CAAAyB,GAAA,CAAAiF,IAAA,YACA,KAAA1G,iBAAA,CAAAyB,GAAA,GACA;MACA;;MAGA;MACAsB,IAAA,CAAArB,MAAA;MACAqB,IAAA,CAAAzB,KAAA;;MAEA;MACA,IAAAwF,kBAAA,EAAAK,KAAA,EAAAvC,IAAA,CAAA0C,GAAA;QACA,IAAAA,GAAA,IAAAA,GAAA,CAAA5I,IAAA,CAAA6I,IAAA,YAAAD,GAAA,CAAA5I,IAAA,CAAAA,IAAA;UACA,MAAAC,MAAA,GAAA2I,GAAA,CAAA5I,IAAA,CAAAA,IAAA;UACAqE,IAAA,CAAApE,MAAA,GAAAA,MAAA;;UAEAsE,OAAA,CAAAC,GAAA,YAAAvE,MAAA;;UAEA;UACA,KAAAuH,eAAA,CAAAnD,IAAA,EAAApE,MAAA;QAEA;UACA;UACAoE,IAAA,CAAArB,MAAA;UACAqB,IAAA,CAAAzB,KAAA;UACA,KAAAwD,QAAA,CAAAG,KAAA,kBAAAqC,GAAA,CAAA5I,IAAA,CAAA8I,GAAA;QACA;MACA,GAAAxC,KAAA,CAAAyC,GAAA;QACAxE,OAAA,CAAAgC,KAAA,+BAAAwC,GAAA;QACA1E,IAAA,CAAArB,MAAA;QACAqB,IAAA,CAAAzB,KAAA;QACA,KAAAwD,QAAA,CAAAG,KAAA;MACA;IACA;IACA;AACA;AACA;IACA8B,qBAAAhE,IAAA,EAAA9C,YAAA;MACA,MAAAkH,KAAA;QACAC,MAAA,EAAArE,IAAA,CAAAvB,OAAA;QACA1C,SAAA,OAAAD,IAAA,CAAAC,SAAA;QACAC,UAAA,OAAAF,IAAA,CAAAE,UAAA;QACA;QACAsI,QAAA,OAAArH,iBAAA,SAAAA,iBAAA,CAAAyB,GAAA,GACA,KAAAzB,iBAAA,CAAAyB,GAAA,GACA;MACA;;MAEA;MACAsB,IAAA,CAAArB,MAAA;MACAqB,IAAA,CAAAzB,KAAA;MACA;MACAyB,IAAA,CAAAxB,WAAA;;MAEA;MACA,IAAAmG,kBAAA,EAAAP,KAAA,EAAAvC,IAAA,CAAA0C,GAAA;QACA,IAAAA,GAAA,IAAAA,GAAA,CAAA5I,IAAA,CAAA6I,IAAA,YAAAD,GAAA,CAAA5I,IAAA,CAAAA,IAAA;UACA,MAAAC,MAAA,GAAA2I,GAAA,CAAA5I,IAAA,CAAAA,IAAA;UACAqE,IAAA,CAAApE,MAAA,GAAAA,MAAA;;UAEA;UACA,KAAAuH,eAAA,CAAAnD,IAAA,EAAApE,MAAA;QACA;UACAoE,IAAA,CAAArB,MAAA;UACAqB,IAAA,CAAAzB,KAAA;UACA,KAAAwD,QAAA,CAAAG,KAAA;QACA;MACA,GAAAD,KAAA,CAAAyC,GAAA;QACAxE,OAAA,CAAAgC,KAAA,+BAAAwC,GAAA;QACA1E,IAAA,CAAArB,MAAA;QACAqB,IAAA,CAAAzB,KAAA;MACA;IACA;IACA;AACA;AACA;AACA;AACA;IACAqG,mBAAA5E,IAAA,EAAApE,MAAA;MACA,MAAAwI,KAAA;QAAAxI;MAAA;MAEA,IAAAiJ,0BAAA,EAAAT,KAAA,EAAAvC,IAAA,CAAA0C,GAAA;QACA,IAAAA,GAAA,IAAAA,GAAA,CAAA5I,IAAA,CAAA6I,IAAA,YAAAD,GAAA,CAAA5I,IAAA,CAAAA,IAAA;UACAuE,OAAA,CAAAC,GAAA,wBAAAoE,GAAA;UACA,MAAA5B,KAAA,GAAA4B,GAAA,CAAA5I,IAAA,CAAAA,IAAA;UAGA,IAAAgH,KAAA;YACAzC,OAAA,CAAAC,GAAA,OAAAH,IAAA,CAAA5B,EAAA;YACA4B,IAAA,CAAAzB,KAAA;UACA,WAAAoE,KAAA;YACAzC,OAAA,CAAAC,GAAA,OAAAH,IAAA,CAAA5B,EAAA;YACA4B,IAAA,CAAAzB,KAAA;UACA,WAAAoE,KAAA;YACA;YACA3C,IAAA,CAAArB,MAAA;YACAqB,IAAA,CAAAzB,KAAA;YACA,KAAA0B,cAAA,CAAAD,IAAA;YACA,KAAA+B,QAAA,CAAAG,KAAA,OAAAlC,IAAA,CAAA5B,EAAA;UAEA,WAAAuE,KAAA;YACAzC,OAAA,CAAAC,GAAA;YACA,KAAAF,cAAA,CAAAD,IAAA;UACA;YACA;YACA,MAAA8E,OAAA,GAAAnC,KAAA;YAEA3C,IAAA,CAAArB,MAAA;YACAqB,IAAA,CAAAzB,KAAA;YACAyB,IAAA,CAAAxB,WAAA;YACAwB,IAAA,CAAAtB,GAAA,GAAAoG,OAAA;;YAEA,KAAA7E,cAAA,CAAAD,IAAA;YACA,KAAA+B,QAAA,CAAAC,OAAA,OAAAhC,IAAA,CAAA5B,EAAA;UACA;QACA;UACA;UACA4B,IAAA,CAAArB,MAAA;UACAqB,IAAA,CAAAzB,KAAA;UACA,KAAA0B,cAAA,CAAAD,IAAA;UACA,KAAA+B,QAAA,CAAAG,KAAA;QACA;MACA,GAAAD,KAAA,CAAAyC,GAAA;QACAxE,OAAA,CAAAgC,KAAA,qBAAAwC,GAAA;QACA1E,IAAA,CAAArB,MAAA;QACAqB,IAAA,CAAAzB,KAAA;QACA,KAAA0B,cAAA,CAAAD,IAAA;MACA;IACA;IACA;AACA;AACA;IACA+E,wBAAA/E,IAAA,EAAApE,MAAA;MACA,MAAAwI,KAAA;QAAAxI;MAAA;MAEA,IAAAoJ,qBAAA,EAAAZ,KAAA,EAAAvC,IAAA,CAAA0C,GAAA;QACA,IAAAA,GAAA,IAAAA,GAAA,CAAA5I,IAAA,CAAA6I,IAAA,YAAAD,GAAA,CAAA5I,IAAA,CAAAA,IAAA;UACA,MAAAsJ,QAAA,GAAAV,GAAA,CAAA5I,IAAA,CAAAA,IAAA;UACA;;UAEA,IAAAsJ,QAAA,CAAAC,MAAA;YACA;YACA,MAAAC,QAAA,GAAAF,QAAA,CAAAX,QAAA;;YAEA;YACAtE,IAAA,CAAArB,MAAA;YACAqB,IAAA,CAAAzB,KAAA;;YAEA;YACAyB,IAAA,CAAAxB,WAAA;YACAwB,IAAA,CAAAtB,GAAA,GAAAyG,QAAA;;YAEA;YACA,KAAAlF,cAAA,CAAAD,IAAA;YACA,KAAA+B,QAAA,CAAAC,OAAA,OAAAhC,IAAA,CAAA5B,EAAA;UAEA,WAAA6G,QAAA,CAAAC,MAAA;YACA;YACAlF,IAAA,CAAArB,MAAA;YACAqB,IAAA,CAAAzB,KAAA;YAEA,KAAA0B,cAAA,CAAAD,IAAA;YACA,KAAA+B,QAAA,CAAAG,KAAA,OAAAlC,IAAA,CAAA5B,EAAA;UAEA;YACA;YACA8B,OAAA,CAAAC,GAAA,OAAAH,IAAA,CAAA5B,EAAA;YACA;YACA;UACA;QAEA;UACA;UACA4B,IAAA,CAAArB,MAAA;UACA,KAAAsB,cAAA,CAAAD,IAAA;QACA;MACA,GAAAiC,KAAA,CAAAyC,GAAA;QACAxE,OAAA,CAAAgC,KAAA,2BAAAwC,GAAA;QACA1E,IAAA,CAAArB,MAAA;QACA,KAAAsB,cAAA,CAAAD,IAAA;MACA;IACA;IACA;AACA;AACA;AACA;AACA;AACA;IACAmD,gBAAAnD,IAAA,EAAApE,MAAA,EAAAsH,QAAA;MACA;MACA,KAAAjD,cAAA,CAAAD,IAAA;;MAEA;MACA,MAAApB,KAAA,GAAAwG,WAAA;QACA,IAAAlC,QAAA;UACA,KAAA6B,uBAAA,CAAA/E,IAAA,EAAApE,MAAA;QACA;UACA,KAAAgJ,kBAAA,CAAA5E,IAAA,EAAApE,MAAA;QACA;MACA;;MAEA;MACAoE,IAAA,CAAApB,KAAA,GAAAA,KAAA;MACA,KAAAG,WAAA,CAAAsG,GAAA,CAAArF,IAAA,CAAA5B,EAAA,EAAAQ,KAAA;IACA;IACA;IACAqB,eAAAD,IAAA;MACA,IAAAA,IAAA,CAAApB,KAAA;QACA0G,aAAA,CAAAtF,IAAA,CAAApB,KAAA;QACAoB,IAAA,CAAApB,KAAA;QACA,KAAAG,WAAA,CAAAwG,MAAA,CAAAvF,IAAA,CAAA5B,EAAA;MACA;IACA;IACAkB,4BAAAgB,CAAA;MACA,UAAAtD,cAAA;MAEA,MAAAwI,KAAA,QAAAC,GAAA,CAAAC,aAAA;;MAEA;MACA,IAAAF,KAAA,IAAAA,KAAA,CAAAG,QAAA,CAAArF,CAAA,CAAAsF,MAAA;QACA;MACA;;MAEA;MACA;MACA;MACA,IAAAC,aAAA;MACA,IAAAD,MAAA,GAAAtF,CAAA,CAAAsF,MAAA;MACA,OAAAA,MAAA,IAAAA,MAAA,CAAAE,QAAA;QACA;QACA;QACA,IAAAF,MAAA,CAAAG,SAAA,CAAAJ,QAAA,0BAAAC,MAAA,CAAAG,SAAA,CAAAJ,QAAA;UACAE,aAAA;UACA;QACA;QACAD,MAAA,GAAAA,MAAA,CAAAI,UAAA;MACA;MAEA,IAAAH,aAAA;QACA;MACA;;MAEA;MACA,KAAA1B,UAAA;IACA;IACA;AACA;AACA;IACA8B,yBAAA;MACA,SAAAlJ,gBAAA,CAAA4G,IAAA;QACAuC,KAAA,cAAAnJ,gBAAA;MACA;IACA;IACA;IACAoJ,kBAAAzC,MAAA;MACA,KAAAzG,iBAAA,GAAAyG,MAAA;MACA,KAAAxG,YAAA,GAAAwG,MAAA,CAAAlF,WAAA;MACA,KAAArB,YAAA;MACA,KAAAC,WAAA;MAEA,IAAAsG,MAAA,CAAAlF,WAAA;QACA,KAAArB,YAAA,GAAAuG,MAAA,CAAA0C,IAAA;MACA;MAEA,KAAApJ,cAAA;;MAEA;MACA;MACA,KAAAK,QAAA;QACAb,CAAA,EAAAkH,MAAA,CAAAlH,CAAA,GAAAkH,MAAA,CAAArF,KAAA;QACA5B,CAAA,EAAAiH,MAAA,CAAAjH,CAAA;MACA;;MAEA;MACA,KAAA6F,SAAA;QACA,MAAA+D,KAAA,QAAAZ,GAAA,CAAAC,aAAA;QACA,IAAAW,KAAA,EAAAA,KAAA,CAAAC,KAAA;MACA;IACA;IACA;AACA;AACA;IACAnC,WAAA;MACA,KAAAnH,cAAA;MACA,KAAAC,iBAAA;MACA,KAAAE,YAAA;MACA,KAAAC,WAAA;MACA,KAAAC,QAAA;QAAAb,CAAA;QAAAC,CAAA;MAAA;IACA;IACA;IACAkD,cAAAnD,CAAA,EAAAC,CAAA;MACA;QACAD,CAAA,GAAAA,CAAA,QAAAc,OAAA,SAAAE,KAAA;QACAf,CAAA,GAAAA,CAAA,QAAAc,OAAA,SAAAC;MACA;IACA;IACA+I,cAAA/J,CAAA,EAAAC,CAAA;MACA;QACAD,CAAA,EAAAA,CAAA,QAAAgB,KAAA,QAAAF,OAAA;QACAb,CAAA,EAAAA,CAAA,QAAAe,KAAA,QAAAD;MACA;IACA;IAEA;IACAiJ,aAAAxG,IAAA;MACA,MAAAuB,GAAA,QAAA5B,aAAA,CAAAK,IAAA,CAAAxD,CAAA,EAAAwD,IAAA,CAAAvD,CAAA;MACA;QACAmD,SAAA,eAAA2B,GAAA,CAAA/E,CAAA,OAAA+E,GAAA,CAAA9E,CAAA;QAAA;QACA4B,KAAA,EAAA2B,IAAA,CAAA3B,KAAA,QAAAb,KAAA;QACAc,MAAA,EAAA0B,IAAA,CAAA1B,MAAA,QAAAd,KAAA;QACAiJ,MAAA,OAAAvI,cAAA,KAAA8B,IAAA,CAAA5B,EAAA;MACA;IACA;IACAsI,YAAAC,IAAA;MACA,MAAAC,IAAA,QAAAzI,KAAA,CAAA0I,IAAA,CAAAC,CAAA,IAAAA,CAAA,CAAA1I,EAAA,KAAAuI,IAAA,CAAA1C,MAAA;MACA,MAAA8C,EAAA,QAAA5I,KAAA,CAAA0I,IAAA,CAAAC,CAAA,IAAAA,CAAA,CAAA1I,EAAA,KAAAuI,IAAA,CAAAzC,IAAA;MACA,KAAA0C,IAAA,KAAAG,EAAA;;MAEA;MACA,MAAAC,WAAA,GAAAJ,IAAA,CAAApK,CAAA,GAAAoK,IAAA,CAAAvI,KAAA;MACA,MAAA4I,WAAA,GAAAL,IAAA,CAAAnK,CAAA,GAAAmK,IAAA,CAAAtI,MAAA;MACA,MAAA4I,SAAA,GAAAH,EAAA,CAAAvK,CAAA;MACA,MAAA2K,SAAA,GAAAJ,EAAA,CAAAtK,CAAA,GAAAsK,EAAA,CAAAzI,MAAA;MAEA,MAAA8I,KAAA,QAAAzH,aAAA,CAAAqH,WAAA,EAAAC,WAAA;MACA,MAAAI,GAAA,QAAA1H,aAAA,CAAAuH,SAAA,EAAAC,SAAA;MAEA,MAAAG,IAAA,GAAAzG,IAAA,CAAA0G,GAAA,CAAAF,GAAA,CAAA7K,CAAA,GAAA4K,KAAA,CAAA5K,CAAA;MACA,MAAAgL,GAAA;QAAAhL,CAAA,EAAA4K,KAAA,CAAA5K,CAAA,GAAA8K,IAAA;QAAA7K,CAAA,EAAA2K,KAAA,CAAA3K;MAAA;MACA,MAAAgL,GAAA;QAAAjL,CAAA,EAAA6K,GAAA,CAAA7K,CAAA,GAAA8K,IAAA;QAAA7K,CAAA,EAAA4K,GAAA,CAAA5K;MAAA;;MAEA,YAAA2K,KAAA,CAAA5K,CAAA,IAAA4K,KAAA,CAAA3K,CAAA,MAAA+K,GAAA,CAAAhL,CAAA,IAAAgL,GAAA,CAAA/K,CAAA,IAAAgL,GAAA,CAAAjL,CAAA,IAAAiL,GAAA,CAAAhL,CAAA,IAAA4K,GAAA,CAAA7K,CAAA,IAAA6K,GAAA,CAAA5K,CAAA;IACA;IACA;IACA;IACAiL,kBAAApH,CAAA;MACA;;MAEAA,CAAA,CAAAqH,cAAA;;MAEA,IAAArH,CAAA,CAAAsH,MAAA;QACA,KAAAtL,cAAA;;QAEA4D,OAAA,CAAAC,GAAA,OAAAG,CAAA;QACAJ,OAAA,CAAAC,GAAA,yBAAA7D,cAAA;QACA,KAAAC,cAAA;UAAAC,CAAA,EAAA8D,CAAA,CAAAC,OAAA;UAAA9D,CAAA,EAAA6D,CAAA,CAAAE;QAAA;MACA;MAIA,KAAA/C,SAAA;MACA,KAAAC,QAAA;QAAAlB,CAAA,EAAA8D,CAAA,CAAAC,OAAA;QAAA9D,CAAA,EAAA6D,CAAA,CAAAE;MAAA;MACA,KAAA7C,SAAA;QAAAnB,CAAA,OAAAc,OAAA;QAAAb,CAAA,OAAAc;MAAA;MACA,KAAAW,cAAA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA2J,gBAAA7H,IAAA,EAAAM,CAAA;MACA,MAAAwH,aAAA,GAAAxH,CAAA,CAAAyH,OAAA,IAAAzH,CAAA,CAAA0H,OAAA;;MAEA,IAAAF,aAAA;QACA;QACA,SAAAzL,eAAA,CAAA4L,QAAA,CAAAjI,IAAA,CAAA5B,EAAA;UACA,KAAA/B,eAAA,QAAAA,eAAA,CAAA8E,MAAA,CAAA/C,EAAA,IAAAA,EAAA,KAAA4B,IAAA,CAAA5B,EAAA;QACA;UACA;UACA,KAAA/B,eAAA,CAAAkG,IAAA,CAAAvC,IAAA,CAAA5B,EAAA;QACA;MACA;QACA;QACA,KAAA/B,eAAA,IAAA2D,IAAA,CAAA5B,EAAA;MACA;IACA;IACA8J,mBAAA;MACA,KAAA7L,eAAA;IACA;IAEA8L,sBAAAnI,IAAA,EAAAM,CAAA;MACA,KAAAzC,YAAA,GAAAmC,IAAA;MACA,KAAAlC,WAAA;QAAAtB,CAAA,EAAA8D,CAAA,CAAAC,OAAA;QAAA9D,CAAA,EAAA6D,CAAA,CAAAE;MAAA;MACA,KAAAzC,gBAAA;QAAAC,CAAA,EAAAgC,IAAA,CAAA3B,KAAA;QAAAJ,CAAA,EAAA+B,IAAA,CAAA1B;MAAA;MACA,KAAA6F,UAAA;IACA;IAEA;IACA/E,kBAAAkB,CAAA;MAEA,MAAA8H,UAAA,QAAAC,KAAA,CAAAC,MAAA,CAAAC,qBAAA;MACA,MAAAC,MAAA,GAAAlI,CAAA,CAAAC,OAAA,GAAA6H,UAAA,CAAA3H,IAAA;MACA,MAAAgI,MAAA,GAAAnI,CAAA,CAAAE,OAAA,GAAA4H,UAAA,CAAA1H,GAAA;;MAEA;MACA,SAAA9D,YAAA;QACA,MAAA8L,EAAA,IAAApI,CAAA,CAAAC,OAAA,QAAA1D,aAAA,CAAAL,CAAA,SAAAgB,KAAA;QACA,MAAAmL,EAAA,IAAArI,CAAA,CAAAE,OAAA,QAAA3D,aAAA,CAAAJ,CAAA,SAAAe,KAAA;QACA,KAAAZ,YAAA,CAAAJ,CAAA,QAAAoB,UAAA,CAAApB,CAAA,GAAAkM,EAAA;QACA,KAAA9L,YAAA,CAAAH,CAAA,QAAAmB,UAAA,CAAAnB,CAAA,GAAAkM,EAAA;QACA;MACA;MACA;MACA,SAAA9K,YAAA;QACA,MAAA6K,EAAA,IAAApI,CAAA,CAAAC,OAAA,QAAAzC,WAAA,CAAAtB,CAAA,SAAAgB,KAAA;QACA,MAAAmL,EAAA,IAAArI,CAAA,CAAAE,OAAA,QAAA1C,WAAA,CAAArB,CAAA,SAAAe,KAAA;QACA;AACA;AACA;QACA,KAAAK,YAAA,CAAAQ,KAAA,GAAAwC,IAAA,CAAAI,GAAA,WAAAlD,gBAAA,CAAAC,CAAA,GAAA0K,EAAA;QACA,KAAA7K,YAAA,CAAAS,MAAA,GAAAuC,IAAA,CAAAI,GAAA,WAAAlD,gBAAA,CAAAE,CAAA,GAAA0K,EAAA;QACA;MACA;MACA;MACA,SAAAlL,SAAA;QACA,MAAAiL,EAAA,IAAApI,CAAA,CAAAC,OAAA,QAAA7C,QAAA,CAAAlB,CAAA,SAAAgB,KAAA;QACA,MAAAmL,EAAA,IAAArI,CAAA,CAAAE,OAAA,QAAA9C,QAAA,CAAAjB,CAAA,SAAAe,KAAA;QACA,KAAAF,OAAA,QAAAK,SAAA,CAAAnB,CAAA,GAAAkM,EAAA;QACA,KAAAnL,OAAA,QAAAI,SAAA,CAAAlB,CAAA,GAAAkM,EAAA;MACA;IACA;IACA;IACAtJ,gBAAAiB,CAAA;MACA,KAAA7C,SAAA;MACA,KAAAb,YAAA;MACA,KAAAiB,YAAA;IACA;IACA+K,QAAAtI,CAAA;MACA;MACA,MAAAuI,aAAA;MACA,MAAAC,KAAA,GAAAxI,CAAA,CAAAyI,MAAA,QAAAF,aAAA,GAAAA,aAAA;;MAEA;MACA,MAAAG,SAAA;MACA,MAAAC,SAAA;MAEA,MAAAC,QAAA,GAAArI,IAAA,CAAAC,GAAA,CAAAmI,SAAA,EAAApI,IAAA,CAAAI,GAAA,CAAA+H,SAAA,OAAAxL,KAAA,GAAAsL,KAAA;;MAEA;;MAEA;MACA,MAAAK,IAAA,QAAAd,KAAA,CAAAC,MAAA,CAAAC,qBAAA;MACA,MAAAC,MAAA,GAAAlI,CAAA,CAAAC,OAAA,GAAA4I,IAAA,CAAA1I,IAAA;MACA,MAAAgI,MAAA,GAAAnI,CAAA,CAAAE,OAAA,GAAA2I,IAAA,CAAAzI,GAAA;MAEA,MAAA0I,QAAA,QAAA7C,aAAA,CAAAiC,MAAA,EAAAC,MAAA;;MAEA;MACA,KAAAjL,KAAA,GAAA0L,QAAA;;MAEA;MACA,KAAA5L,OAAA,GAAAkL,MAAA,QAAAhL,KAAA,GAAA4L,QAAA,CAAA5M,CAAA;MACA,KAAAe,OAAA,GAAAkL,MAAA,QAAAjL,KAAA,GAAA4L,QAAA,CAAA3M,CAAA;IACA;IAEA;IACA4G,QAAAzB,IAAA;MACA;MACA,MAAAyH,MAAA,QAAA9C,aAAA,MAAA8B,KAAA,CAAAC,MAAA,CAAAgB,WAAA,WAAAjB,KAAA,CAAAC,MAAA,CAAAiB,YAAA;MACA,KAAApL,KAAA,CAAAoE,IAAA;QACAnE,EAAA,EAAA/C,KAAA;QACAmB,CAAA,EAAA6M,MAAA,CAAA7M,CAAA;QACAC,CAAA,EAAA4M,MAAA,CAAA5M,CAAA;QACA4B,KAAA;QACAC,MAAA;QACAC,KAAA;QACAC,WAAA,EAAAoD,IAAA;QACAnD,OAAA;QACAC,GAAA;QACA;QACAC,MAAA;QACAC,KAAA;QACA;MACA;IACA;IAEA4K,eAAAxJ,IAAA,EAAA4B,IAAA;MACA5B,IAAA,CAAAxB,WAAA,GAAAoD,IAAA;IACA;IAEA6H,WAAArL,EAAA;MACA,MAAAsL,YAAA,QAAAvL,KAAA,CAAA0I,IAAA,CAAAC,CAAA,IAAAA,CAAA,CAAA1I,EAAA,KAAAA,EAAA;MACA,IAAAsL,YAAA;QACA,KAAAzJ,cAAA,CAAAyJ,YAAA;MACA;MACA,KAAAvL,KAAA,QAAAA,KAAA,CAAAgD,MAAA,CAAA2F,CAAA,IAAAA,CAAA,CAAA1I,EAAA,KAAAA,EAAA;MACA,KAAAS,KAAA,QAAAA,KAAA,CAAAsC,MAAA,CAAAb,CAAA,IAAAA,CAAA,CAAA2D,MAAA,KAAA7F,EAAA,IAAAkC,CAAA,CAAA4D,IAAA,KAAA9F,EAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}