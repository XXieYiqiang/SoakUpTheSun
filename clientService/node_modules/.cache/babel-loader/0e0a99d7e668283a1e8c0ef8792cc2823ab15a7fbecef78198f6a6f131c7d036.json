{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.map.js\");\nvar _file = require(\"@/api/file.js\");\nvar _default = exports.default = {\n  name: 'MoveFileDialog',\n  data() {\n    return {\n      visible: false,\n      //  对话框是否可见\n      targetPath: '/',\n      //  目标路径\n      fileTree: [],\n      //  文件夹目录树\n      loading: false,\n      //  文件夹目录树 loading 状态\n      defaultExpandedKeys: [],\n      sureBtnLoading: false //  确定按钮 loading 状态\n    };\n  },\n  methods: {\n    /**\r\n     * 取消按钮点击事件 & 对话框关闭的回调\r\n     */\n    handleDialogClose() {\n      this.visible = false;\n      this.callback('cancel');\n    },\n    /**\r\n     * 对话框打开的回调\r\n     */\n    handleDialogOpen() {\n      this.initFileTree();\n    },\n    /**\r\n     * 初始化文件目录树\r\n     */\n    initFileTree(id) {\n      this.loading = true;\n      (0, _file.getFoldTree)().then(res => {\n        this.loading = false;\n        console.log('res====');\n        console.log(res);\n        if (res.data.code === 200) {\n          this.fileTree = [res.data.data];\n          this.defaultExpandedKeys = id ? [id] : [this.fileTree[0].id];\n        } else {\n          this.$message.error(res.message);\n        }\n      });\n    },\n    /**\r\n     * 目录树节点点击回调函数\r\n     * @description 将当前节点中的文件夹路径传递给父组件\r\n     * @param {object} data 当前点击的节点信息\r\n     */\n    handleNodeClick(data) {\n      this.targetPath = data.filePath ? data.filePath : '/';\n    },\n    /**\r\n     * 新建文件夹按钮点击事件\r\n     * @description 调用新建文件夹服务，并在弹窗确认回调事件中刷新文件夹树\r\n     */\n    handleAddFolderBtnClick(data) {\n      this.$openDialog.addFolder({\n        filePath: data.filePath || '/'\n      }).then(() => {\n        this.initFileTree(data.id);\n      });\n    },\n    /**\r\n     * 确定按钮点击事件\r\n     * @description 调用移动文件接口\r\n     */\n    handleDialogSure() {\n      this.sureBtnLoading = true;\n      if (this.isBatchOperation) {\n        //  批量移动\n        let data = {\n          filePath: this.targetPath,\n          userFileIds: this.fileInfo.map(item => {\n            return item.userFileId;\n          }).join(',')\n        };\n        (0, _file.batchMoveFile)(data).then(res => {\n          this.sureBtnLoading = false;\n          if (res.success) {\n            this.$message.success('移动成功');\n            this.visible = false;\n            this.fileInfo = {};\n            this.callback('confirm');\n          } else {\n            this.$message.error(res.message);\n          }\n        }).catch(() => {\n          this.sureBtnLoading = false;\n        });\n      } else {\n        //  单文件移动\n        let data = {\n          userFileId: this.fileInfo.userFileId,\n          filePath: this.targetPath\n        };\n        (0, _file.moveFile)(data).then(res => {\n          this.sureBtnLoading = false;\n          if (res.success) {\n            this.$message.success('移动成功');\n            this.visible = false;\n            this.callback('confirm');\n          } else {\n            this.$message.error(res.message);\n          }\n        }).catch(() => {\n          this.sureBtnLoading = false;\n        });\n      }\n    }\n  }\n};","map":{"version":3,"names":["_file","require","_default","exports","default","name","data","visible","targetPath","fileTree","loading","defaultExpandedKeys","sureBtnLoading","methods","handleDialogClose","callback","handleDialogOpen","initFileTree","id","getFoldTree","then","res","console","log","code","$message","error","message","handleNodeClick","filePath","handleAddFolderBtnClick","$openDialog","addFolder","handleDialogSure","isBatchOperation","userFileIds","fileInfo","map","item","userFileId","join","batchMoveFile","success","catch","moveFile"],"sources":["src/components/file/dialog/moveFile/Dialog.vue"],"sourcesContent":["<template>\r\n\t<!-- 移动文件-选择目标路径 -->\r\n\t<el-dialog\r\n\t\ttitle=\"选择目标路径\"\r\n\t\t:visible.sync=\"visible\"\r\n\t\t:close-on-click-modal=\"false\"\r\n\t\t@open=\"handleDialogOpen\"\r\n\t\t@close=\"handleDialogClose\"\r\n\t>\r\n\t\t<div class=\"el-dialog-div\">\r\n\t\t\t<!-- 选择的目标路径 -->\r\n\t\t\t<div class=\"target-path\">\r\n\t\t\t\t<span class=\"label\">目标路径：</span>\r\n\t\t\t\t<el-input\r\n\t\t\t\t\tclass=\"content\"\r\n\t\t\t\t\tv-model=\"targetPath\"\r\n\t\t\t\t\treadonly\r\n\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t></el-input>\r\n\t\t\t</div>\r\n\t\t\t<!-- 文件目录树 -->\r\n\t\t\t<el-tree\r\n\t\t\t\t:data=\"fileTree\"\r\n\t\t\t\t:props=\"{\r\n\t\t\t\t\tchildren: 'children',\r\n\t\t\t\t\tlabel: 'label'\r\n\t\t\t\t}\"\r\n\t\t\t\t:highlight-current=\"true\"\r\n\t\t\t\t:expand-on-click-node=\"false\"\r\n\t\t\t\t:default-expanded-keys=\"defaultExpandedKeys\"\r\n\t\t\t\tnode-key=\"id\"\r\n\t\t\t\tv-loading=\"loading\"\r\n\t\t\t\t@node-click=\"handleNodeClick\"\r\n\t\t\t>\r\n\t\t\t\t<span class=\"custom-tree-node\" slot-scope=\"{ node, data }\">\r\n\t\t\t\t\t<span class=\"label\">{{ node.label }}</span>\r\n\t\t\t\t\t<el-button\r\n\t\t\t\t\t\tclass=\"add-folder-btn\"\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tsize=\"mini\"\r\n\t\t\t\t\t\t@click.stop=\"handleAddFolderBtnClick(data)\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t新建文件夹\r\n\t\t\t\t\t</el-button>\r\n\t\t\t\t</span>\r\n\t\t\t</el-tree>\r\n\t\t</div>\r\n\t\t<div slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t<el-button @click=\"handleDialogClose\">取 消</el-button>\r\n\t\t\t<el-button\r\n\t\t\t\ttype=\"primary\"\r\n\t\t\t\t:loading=\"sureBtnLoading\"\r\n\t\t\t\t@click=\"handleDialogSure\"\r\n\t\t\t\t>确 定</el-button\r\n\t\t\t>\r\n\t\t</div>\r\n\t</el-dialog>\r\n</template>\r\n\r\n<script>\r\nimport { getFoldTree, moveFile, batchMoveFile } from '@/api/file.js'\r\n\r\nexport default {\r\n\tname: 'MoveFileDialog',\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tvisible: false, //  对话框是否可见\r\n\t\t\ttargetPath: '/', //  目标路径\r\n\t\t\tfileTree: [], //  文件夹目录树\r\n\t\t\tloading: false, //  文件夹目录树 loading 状态\r\n\t\t\tdefaultExpandedKeys: [],\r\n\t\t\tsureBtnLoading: false //  确定按钮 loading 状态\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 取消按钮点击事件 & 对话框关闭的回调\r\n\t\t */\r\n\t\thandleDialogClose() {\r\n\t\t\tthis.visible = false\r\n\t\t\tthis.callback('cancel')\r\n\t\t},\r\n\t\t/**\r\n\t\t * 对话框打开的回调\r\n\t\t */\r\n\t\thandleDialogOpen() {\r\n\t\t\tthis.initFileTree()\r\n\t\t},\r\n\t\t/**\r\n\t\t * 初始化文件目录树\r\n\t\t */\r\n\t\tinitFileTree(id) {\r\n\t\t\tthis.loading = true\r\n\t\t\tgetFoldTree().then((res) => {\r\n\t\t\t\tthis.loading = false\r\n\t\t\t\tconsole.log('res====')\r\n\t\t\t\tconsole.log(res)\r\n\t\t\t\tif (res.data.code === 200) {\r\n\t\t\t\t\tthis.fileTree = [res.data.data]\r\n\t\t\t\t\tthis.defaultExpandedKeys = id ? [id] : [this.fileTree[0].id]\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$message.error(res.message)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t/**\r\n\t\t * 目录树节点点击回调函数\r\n\t\t * @description 将当前节点中的文件夹路径传递给父组件\r\n\t\t * @param {object} data 当前点击的节点信息\r\n\t\t */\r\n\t\thandleNodeClick(data) {\r\n\t\t\tthis.targetPath = data.filePath ? data.filePath : '/'\r\n\t\t},\r\n\t\t/**\r\n\t\t * 新建文件夹按钮点击事件\r\n\t\t * @description 调用新建文件夹服务，并在弹窗确认回调事件中刷新文件夹树\r\n\t\t */\r\n\t\thandleAddFolderBtnClick(data) {\r\n\t\t\tthis.$openDialog\r\n\t\t\t\t.addFolder({\r\n\t\t\t\t\tfilePath: data.filePath || '/'\r\n\t\t\t\t})\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tthis.initFileTree(data.id)\r\n\t\t\t\t})\r\n\t\t},\r\n\t\t/**\r\n\t\t * 确定按钮点击事件\r\n\t\t * @description 调用移动文件接口\r\n\t\t */\r\n\t\thandleDialogSure() {\r\n\t\t\tthis.sureBtnLoading = true\r\n\t\t\tif (this.isBatchOperation) {\r\n\t\t\t\t//  批量移动\r\n\t\t\t\tlet data = {\r\n\t\t\t\t\tfilePath: this.targetPath,\r\n\t\t\t\t\tuserFileIds: this.fileInfo\r\n\t\t\t\t\t\t.map((item) => {\r\n\t\t\t\t\t\t\treturn item.userFileId\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.join(',')\r\n\t\t\t\t}\r\n\t\t\t\tbatchMoveFile(data)\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tthis.sureBtnLoading = false\r\n\t\t\t\t\t\tif (res.success) {\r\n\t\t\t\t\t\t\tthis.$message.success('移动成功')\r\n\t\t\t\t\t\t\tthis.visible = false\r\n\t\t\t\t\t\t\tthis.fileInfo = {}\r\n\t\t\t\t\t\t\tthis.callback('confirm')\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.$message.error(res.message)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(() => {\r\n\t\t\t\t\t\tthis.sureBtnLoading = false\r\n\t\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\t//  单文件移动\r\n\t\t\t\tlet data = {\r\n\t\t\t\t\tuserFileId: this.fileInfo.userFileId,\r\n\t\t\t\t\tfilePath: this.targetPath\r\n\t\t\t\t}\r\n\t\t\t\tmoveFile(data)\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tthis.sureBtnLoading = false\r\n\t\t\t\t\t\tif (res.success) {\r\n\t\t\t\t\t\t\tthis.$message.success('移动成功')\r\n\t\t\t\t\t\t\tthis.visible = false\r\n\t\t\t\t\t\t\tthis.callback('confirm')\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.$message.error(res.message)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(() => {\r\n\t\t\t\t\t\tthis.sureBtnLoading = false\r\n\t\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n@import '~_a/styles/varibles.styl';\r\n@import '~_a/styles/mixins.styl';\r\n\r\n>>> .el-dialog {\r\n  .el-dialog__header {\r\n    display: flex;\r\n  }\r\n\r\n  .el-dialog__body {\r\n    padding: 10px 30px;\r\n\r\n    .el-dialog-div {\r\n      height: 300px;\r\n      overflow: auto;\r\n      setScrollbar(6px);\r\n\r\n      .target-path {\r\n        display: flex;\r\n        align-items: center;\r\n\r\n        .label {\r\n          width: 80px;\r\n        }\r\n\r\n        .content {\r\n          flex: 1;\r\n        }\r\n      }\r\n\r\n      .el-tree {\r\n        .el-tree-node__content {\r\n          height: 34px;\r\n          font-size: 16px;\r\n\r\n          .el-icon-caret-right {\r\n            font-size: 18px;\r\n          }\r\n\r\n          .custom-tree-node {\r\n            flex: 1;\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: space-between;\r\n            font-size: 14px;\r\n            padding-right: 8px;\r\n          }\r\n\r\n          .add-folder-btn {\r\n            display: none;\r\n          }\r\n\r\n          &:hover {\r\n            .add-folder-btn {\r\n              display: block;\r\n            }\r\n          }\r\n        }\r\n\r\n        .el-tree-node.is-current>.el-tree-node__content {\r\n          color: $Primary;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"mappings":";;;;;;;;AA4DA,IAAAA,KAAA,GAAAC,OAAA;AAAA,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,OAAA;MAAA;MACAC,UAAA;MAAA;MACAC,QAAA;MAAA;MACAC,OAAA;MAAA;MACAC,mBAAA;MACAC,cAAA;IACA;EACA;EACAC,OAAA;IACA;AACA;AACA;IACAC,kBAAA;MACA,KAAAP,OAAA;MACA,KAAAQ,QAAA;IACA;IACA;AACA;AACA;IACAC,iBAAA;MACA,KAAAC,YAAA;IACA;IACA;AACA;AACA;IACAA,aAAAC,EAAA;MACA,KAAAR,OAAA;MACA,IAAAS,iBAAA,IAAAC,IAAA,CAAAC,GAAA;QACA,KAAAX,OAAA;QACAY,OAAA,CAAAC,GAAA;QACAD,OAAA,CAAAC,GAAA,CAAAF,GAAA;QACA,IAAAA,GAAA,CAAAf,IAAA,CAAAkB,IAAA;UACA,KAAAf,QAAA,IAAAY,GAAA,CAAAf,IAAA,CAAAA,IAAA;UACA,KAAAK,mBAAA,GAAAO,EAAA,IAAAA,EAAA,UAAAT,QAAA,IAAAS,EAAA;QACA;UACA,KAAAO,QAAA,CAAAC,KAAA,CAAAL,GAAA,CAAAM,OAAA;QACA;MACA;IACA;IACA;AACA;AACA;AACA;AACA;IACAC,gBAAAtB,IAAA;MACA,KAAAE,UAAA,GAAAF,IAAA,CAAAuB,QAAA,GAAAvB,IAAA,CAAAuB,QAAA;IACA;IACA;AACA;AACA;AACA;IACAC,wBAAAxB,IAAA;MACA,KAAAyB,WAAA,CACAC,SAAA;QACAH,QAAA,EAAAvB,IAAA,CAAAuB,QAAA;MACA,GACAT,IAAA;QACA,KAAAH,YAAA,CAAAX,IAAA,CAAAY,EAAA;MACA;IACA;IACA;AACA;AACA;AACA;IACAe,iBAAA;MACA,KAAArB,cAAA;MACA,SAAAsB,gBAAA;QACA;QACA,IAAA5B,IAAA;UACAuB,QAAA,OAAArB,UAAA;UACA2B,WAAA,OAAAC,QAAA,CACAC,GAAA,CAAAC,IAAA;YACA,OAAAA,IAAA,CAAAC,UAAA;UACA,GACAC,IAAA;QACA;QACA,IAAAC,mBAAA,EAAAnC,IAAA,EACAc,IAAA,CAAAC,GAAA;UACA,KAAAT,cAAA;UACA,IAAAS,GAAA,CAAAqB,OAAA;YACA,KAAAjB,QAAA,CAAAiB,OAAA;YACA,KAAAnC,OAAA;YACA,KAAA6B,QAAA;YACA,KAAArB,QAAA;UACA;YACA,KAAAU,QAAA,CAAAC,KAAA,CAAAL,GAAA,CAAAM,OAAA;UACA;QACA,GACAgB,KAAA;UACA,KAAA/B,cAAA;QACA;MACA;QACA;QACA,IAAAN,IAAA;UACAiC,UAAA,OAAAH,QAAA,CAAAG,UAAA;UACAV,QAAA,OAAArB;QACA;QACA,IAAAoC,cAAA,EAAAtC,IAAA,EACAc,IAAA,CAAAC,GAAA;UACA,KAAAT,cAAA;UACA,IAAAS,GAAA,CAAAqB,OAAA;YACA,KAAAjB,QAAA,CAAAiB,OAAA;YACA,KAAAnC,OAAA;YACA,KAAAQ,QAAA;UACA;YACA,KAAAU,QAAA,CAAAC,KAAA,CAAAL,GAAA,CAAAM,OAAA;UACA;QACA,GACAgB,KAAA;UACA,KAAA/B,cAAA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}