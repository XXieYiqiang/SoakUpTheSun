{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"C:/Users/Administrator/Desktop/SoakUpTheSun/clientService/node_modules/@babel/runtime/helpers/interopRequireDefault.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _vue = _interopRequireDefault(require(\"vue\"));\nvar _Dialog = _interopRequireDefault(require(\"./Dialog.vue\"));\n// 导入组件\n\n// 使用基础 Vue 构造器，创建一个“子类”\nconst DeleteFileConstructor = _vue.default.extend(_Dialog.default);\nlet deleteFileInstance = null;\n/**\r\n * 初始化删除文件实例\r\n * @param {boolean} isBatchOperation 是否为批量删除：true - 批量删除，false - 单文件删除\r\n * @param {object | array} fileInfo 文件信息，批量时为数组、单文件时为对象\r\n * @param {number} deleteMode 删除模式：1-删除到回收站 2-彻底删除\r\n */\nconst initInstanceDeleteFile = (isBatchOperation, fileInfo, deleteMode) => {\n  deleteFileInstance = new DeleteFileConstructor({\n    el: document.createElement('div'),\n    data() {\n      return {\n        isBatchOperation,\n        fileInfo,\n        deleteMode\n      };\n    }\n  });\n};\n/**\r\n * 删除文件 Promise 函数\r\n * @returns {Promise} 抛出确认和取消回调函数\r\n */\nconst showDeleteFileDialog = obj => {\n  // 非首次调用服务时，在 DOM 中移除上个实例\n  if (deleteFileInstance !== null) {\n    document.body.removeChild(deleteFileInstance.$el);\n  }\n  let {\n    isBatchOperation,\n    fileInfo,\n    deleteMode\n  } = obj;\n  return new Promise(reslove => {\n    initInstanceDeleteFile(isBatchOperation, fileInfo, deleteMode);\n    deleteFileInstance.callback = res => {\n      reslove(res);\n      // 服务取消时卸载 DOM\n      if (res === 'cancel' && deleteFileInstance !== null) {\n        document.body.removeChild(deleteFileInstance.$el);\n        deleteFileInstance = null;\n      }\n    };\n    document.body.appendChild(deleteFileInstance.$el); //  挂载 DOM\n    _vue.default.nextTick(() => {\n      deleteFileInstance.visible = true; //  打开对话框\n    });\n  });\n};\nvar _default = exports.default = showDeleteFileDialog;","map":{"version":3,"names":["_vue","_interopRequireDefault","require","_Dialog","DeleteFileConstructor","Vue","extend","DeleteFileDialog","deleteFileInstance","initInstanceDeleteFile","isBatchOperation","fileInfo","deleteMode","el","document","createElement","data","showDeleteFileDialog","obj","body","removeChild","$el","Promise","reslove","callback","res","appendChild","nextTick","visible","_default","exports","default"],"sources":["C:/Users/Administrator/Desktop/SoakUpTheSun/clientService/src/components/file/dialog/deleteFile/index.js"],"sourcesContent":["import Vue from 'vue'\r\n// 导入组件\r\nimport DeleteFileDialog from './Dialog.vue'\r\n// 使用基础 Vue 构造器，创建一个“子类”\r\nconst DeleteFileConstructor = Vue.extend(DeleteFileDialog)\r\n\r\nlet deleteFileInstance = null\r\n/**\r\n * 初始化删除文件实例\r\n * @param {boolean} isBatchOperation 是否为批量删除：true - 批量删除，false - 单文件删除\r\n * @param {object | array} fileInfo 文件信息，批量时为数组、单文件时为对象\r\n * @param {number} deleteMode 删除模式：1-删除到回收站 2-彻底删除\r\n */\r\nconst initInstanceDeleteFile = (isBatchOperation, fileInfo, deleteMode) => {\r\n\tdeleteFileInstance = new DeleteFileConstructor({\r\n\t\tel: document.createElement('div'),\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tisBatchOperation,\r\n\t\t\t\tfileInfo,\r\n\t\t\t\tdeleteMode\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n}\r\n/**\r\n * 删除文件 Promise 函数\r\n * @returns {Promise} 抛出确认和取消回调函数\r\n */\r\nconst showDeleteFileDialog = (obj) => {\r\n\t// 非首次调用服务时，在 DOM 中移除上个实例\r\n\tif (deleteFileInstance !== null) {\r\n\t\tdocument.body.removeChild(deleteFileInstance.$el)\r\n\t}\r\n\tlet { isBatchOperation, fileInfo, deleteMode } = obj\r\n\treturn new Promise((reslove) => {\r\n\t\tinitInstanceDeleteFile(isBatchOperation, fileInfo, deleteMode)\r\n\t\tdeleteFileInstance.callback = (res) => {\r\n\t\t\treslove(res)\r\n\t\t\t// 服务取消时卸载 DOM\r\n\t\t\tif (res === 'cancel' && deleteFileInstance !== null) {\r\n\t\t\t\tdocument.body.removeChild(deleteFileInstance.$el)\r\n\t\t\t\tdeleteFileInstance = null\r\n\t\t\t}\r\n\t\t}\r\n\t\tdocument.body.appendChild(deleteFileInstance.$el) //  挂载 DOM\r\n\t\tVue.nextTick(() => {\r\n\t\t\tdeleteFileInstance.visible = true //  打开对话框\r\n\t\t})\r\n\t})\r\n}\r\n\r\nexport default showDeleteFileDialog\r\n"],"mappings":";;;;;;;AAAA,IAAAA,IAAA,GAAAC,sBAAA,CAAAC,OAAA;AAEA,IAAAC,OAAA,GAAAF,sBAAA,CAAAC,OAAA;AADA;;AAEA;AACA,MAAME,qBAAqB,GAAGC,YAAG,CAACC,MAAM,CAACC,eAAgB,CAAC;AAE1D,IAAIC,kBAAkB,GAAG,IAAI;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,sBAAsB,GAAGA,CAACC,gBAAgB,EAAEC,QAAQ,EAAEC,UAAU,KAAK;EAC1EJ,kBAAkB,GAAG,IAAIJ,qBAAqB,CAAC;IAC9CS,EAAE,EAAEC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;IACjCC,IAAIA,CAAA,EAAG;MACN,OAAO;QACNN,gBAAgB;QAChBC,QAAQ;QACRC;MACD,CAAC;IACF;EACD,CAAC,CAAC;AACH,CAAC;AACD;AACA;AACA;AACA;AACA,MAAMK,oBAAoB,GAAIC,GAAG,IAAK;EACrC;EACA,IAAIV,kBAAkB,KAAK,IAAI,EAAE;IAChCM,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACZ,kBAAkB,CAACa,GAAG,CAAC;EAClD;EACA,IAAI;IAAEX,gBAAgB;IAAEC,QAAQ;IAAEC;EAAW,CAAC,GAAGM,GAAG;EACpD,OAAO,IAAII,OAAO,CAAEC,OAAO,IAAK;IAC/Bd,sBAAsB,CAACC,gBAAgB,EAAEC,QAAQ,EAAEC,UAAU,CAAC;IAC9DJ,kBAAkB,CAACgB,QAAQ,GAAIC,GAAG,IAAK;MACtCF,OAAO,CAACE,GAAG,CAAC;MACZ;MACA,IAAIA,GAAG,KAAK,QAAQ,IAAIjB,kBAAkB,KAAK,IAAI,EAAE;QACpDM,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACZ,kBAAkB,CAACa,GAAG,CAAC;QACjDb,kBAAkB,GAAG,IAAI;MAC1B;IACD,CAAC;IACDM,QAAQ,CAACK,IAAI,CAACO,WAAW,CAAClB,kBAAkB,CAACa,GAAG,CAAC,EAAC;IAClDhB,YAAG,CAACsB,QAAQ,CAAC,MAAM;MAClBnB,kBAAkB,CAACoB,OAAO,GAAG,IAAI,EAAC;IACnC,CAAC,CAAC;EACH,CAAC,CAAC;AACH,CAAC;AAAA,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEcd,oBAAoB","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}