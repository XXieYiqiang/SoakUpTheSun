{"ast":null,"code":"import { createFold } from '@/api/file.js';\nexport default {\n  name: 'AddFolderDialog',\n  data() {\n    const validateFileName = (rule, value, callback) => {\n      const fileNameReg = new RegExp(`[\\\\\\\\/:*?\"<>|]`);\n      if (value && fileNameReg.test(value)) {\n        callback(new Error(`文件夹名称不能包含下列任何字符：\\\\/:*?\"<>|`));\n      } else {\n        callback();\n      }\n    };\n    return {\n      visible: false,\n      //  对话框是否可见\n      form: {\n        fileName: ''\n      },\n      formRules: {\n        fileName: [{\n          required: true,\n          message: '请输入文件夹名称',\n          trigger: 'blur'\n        }, {\n          validator: validateFileName,\n          trigger: ['blur', 'change']\n        }]\n      },\n      sureBtnLoading: false\n    };\n  },\n  watch: {\n    /**\r\n     * 监听对话框打开、关闭状态\r\n     */\n    visible(newValue) {\n      if (newValue) {\n        // 打开时绑定回车事件\n        document.addEventListener('keyup', this.handleAddKeyupEnter);\n      } else {\n        // 关闭时移除回车事件\n        document.removeEventListener('keyup', this.handleAddKeyupEnter);\n      }\n    }\n  },\n  methods: {\n    /**\r\n     * DOM 绑定回车事件\r\n     * @description 回车触发新增文件夹事件\r\n     * @param {event} event 事件\r\n     */\n    handleAddKeyupEnter(event) {\n      if (event.key === 'Enter') {\n        this.handleDialogSure('addFolderForm');\n      }\n    },\n    /**\r\n     * 取消按钮点击事件 & 对话框关闭的回调\r\n     * @description 关闭对话框，重置表单\r\n     */\n    handleDialogClose() {\n      this.$refs['addFolderForm'].resetFields();\n      this.visible = false;\n      this.callback('cancel');\n    },\n    /**\r\n     * 确定按钮点击事件\r\n     * @description 校验表单，校验通过后调用新建文件夹接口\r\n     * @param {string} formName 表单ref值\r\n     */\n    handleDialogSure(formName) {\n      console.log('创建文件夹');\n      this.sureBtnLoading = true;\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          createFold({\n            fileName: this.form.fileName,\n            filePath: this.filePath\n          }).then(res => {\n            this.sureBtnLoading = false;\n            console.log('res=====');\n            console.log(res);\n            if (res.data.code === 200) {\n              this.$message.success('文件夹创建成功');\n              this.$refs[formName].resetFields();\n              this.visible = false;\n              this.callback('confirm');\n            } else {\n              this.$message.warning(res.message);\n            }\n          }).catch(() => {\n            this.sureBtnLoading = false;\n          });\n        } else {\n          this.sureBtnLoading = false;\n          return false;\n        }\n      });\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}