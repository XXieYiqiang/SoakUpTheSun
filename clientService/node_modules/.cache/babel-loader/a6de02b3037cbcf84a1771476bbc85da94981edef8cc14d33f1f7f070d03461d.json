{"ast":null,"code":"import Vue from 'vue';\n// 导入组件\nimport UploadFile from './Box.vue';\n// 使用基础 Vue 构造器，创建一个“子类”\nconst UploadFileConstructor = Vue.extend(UploadFile);\nlet uploadFileInstance = null;\n/**\r\n * 初始化右键菜单实例\r\n * @param {string} params 上传文件组件参数\r\n * @param {object} uploadWay 上传方式 0-文件上传 1-文件夹上传 2-粘贴图片或拖拽上传\r\n * @param {} serviceEl 组件实例\r\n * @param {} callType 是否组件本身\r\n */\nconst initInstanceUploadFile = (params, uploadWay, serviceEl, callType) => {\n  uploadFileInstance = new UploadFileConstructor({\n    el: document.createElement('div'),\n    data() {\n      return {\n        params,\n        uploadWay,\n        serviceEl,\n        callType\n      };\n    }\n  });\n};\n/**\r\n * 右键菜单 Promise 函数\r\n * @returns {Promise} 抛出确认和取消回调函数\r\n */\nconst showUploadFileBox = obj => {\n  // 非首次调用服务时，在 DOM 中移除上个实例\n  if (uploadFileInstance !== null) {\n    let {\n      params,\n      uploadWay,\n      serviceEl,\n      callType\n    } = obj;\n    uploadFileInstance.params = params;\n    uploadFileInstance.uploadWay = uploadWay;\n    uploadFileInstance.serviceEl = serviceEl;\n    uploadFileInstance.callType = callType;\n    uploadFileInstance.handlePrepareUpload(); //  上传组件开始预处理\n  } else {\n    let {\n      params,\n      uploadWay,\n      serviceEl,\n      callType\n    } = obj;\n    return new Promise(reslove => {\n      initInstanceUploadFile(params, uploadWay, serviceEl, callType);\n      uploadFileInstance.callback = res => {\n        reslove(res);\n        // 服务取消时卸载 DOM\n        if (res === 'cancel' && uploadFileInstance !== null) {\n          document.body.removeChild(uploadFileInstance.$el);\n          uploadFileInstance = null;\n        }\n      };\n      document.body.appendChild(uploadFileInstance.$el); //  挂载 DOM\n      Vue.nextTick(() => {\n        uploadFileInstance.handlePrepareUpload(); //  上传组件开始预处理\n      });\n    });\n  }\n};\nexport default showUploadFileBox;","map":{"version":3,"names":["Vue","UploadFile","UploadFileConstructor","extend","uploadFileInstance","initInstanceUploadFile","params","uploadWay","serviceEl","callType","el","document","createElement","data","showUploadFileBox","obj","handlePrepareUpload","Promise","reslove","callback","res","body","removeChild","$el","appendChild","nextTick"],"sources":["C:/Users/Administrator/Desktop/GimChat/front/gim-chat/src/components/uploadFile/index.js"],"sourcesContent":["import Vue from 'vue'\r\n// 导入组件\r\nimport UploadFile from './Box.vue'\r\n// 使用基础 Vue 构造器，创建一个“子类”\r\nconst UploadFileConstructor = Vue.extend(UploadFile)\r\n\r\nlet uploadFileInstance = null\r\n/**\r\n * 初始化右键菜单实例\r\n * @param {string} params 上传文件组件参数\r\n * @param {object} uploadWay 上传方式 0-文件上传 1-文件夹上传 2-粘贴图片或拖拽上传\r\n * @param {} serviceEl 组件实例\r\n * @param {} callType 是否组件本身\r\n */\r\nconst initInstanceUploadFile = (params, uploadWay, serviceEl, callType) => {\r\n\tuploadFileInstance = new UploadFileConstructor({\r\n\t\tel: document.createElement('div'),\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tparams,\r\n\t\t\t\tuploadWay,\r\n\t\t\t\tserviceEl,\r\n\t\t\t\tcallType\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n}\r\n/**\r\n * 右键菜单 Promise 函数\r\n * @returns {Promise} 抛出确认和取消回调函数\r\n */\r\nconst showUploadFileBox = (obj) => {\r\n\t// 非首次调用服务时，在 DOM 中移除上个实例\r\n\tif (uploadFileInstance !== null) {\r\n\t\tlet { params, uploadWay, serviceEl, callType } = obj\r\n\t\tuploadFileInstance.params = params\r\n\t\tuploadFileInstance.uploadWay = uploadWay\r\n\t\tuploadFileInstance.serviceEl = serviceEl\r\n\t\tuploadFileInstance.callType = callType\r\n\t\tuploadFileInstance.handlePrepareUpload() //  上传组件开始预处理\r\n\t} else {\r\n\t\tlet { params, uploadWay, serviceEl, callType } = obj\r\n\t\treturn new Promise((reslove) => {\r\n\t\t\tinitInstanceUploadFile(params, uploadWay, serviceEl, callType)\r\n\t\t\tuploadFileInstance.callback = (res) => {\r\n\t\t\t\treslove(res)\r\n\t\t\t\t// 服务取消时卸载 DOM\r\n\t\t\t\tif (res === 'cancel' && uploadFileInstance !== null) {\r\n\t\t\t\t\tdocument.body.removeChild(uploadFileInstance.$el)\r\n\t\t\t\t\tuploadFileInstance = null\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdocument.body.appendChild(uploadFileInstance.$el) //  挂载 DOM\r\n\t\t\tVue.nextTick(() => {\r\n\t\t\t\tuploadFileInstance.handlePrepareUpload() //  上传组件开始预处理\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n}\r\n\r\nexport default showUploadFileBox\r\n"],"mappings":"AAAA,OAAOA,GAAG,MAAM,KAAK;AACrB;AACA,OAAOC,UAAU,MAAM,WAAW;AAClC;AACA,MAAMC,qBAAqB,GAAGF,GAAG,CAACG,MAAM,CAACF,UAAU,CAAC;AAEpD,IAAIG,kBAAkB,GAAG,IAAI;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,sBAAsB,GAAGA,CAACC,MAAM,EAAEC,SAAS,EAAEC,SAAS,EAAEC,QAAQ,KAAK;EAC1EL,kBAAkB,GAAG,IAAIF,qBAAqB,CAAC;IAC9CQ,EAAE,EAAEC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;IACjCC,IAAIA,CAAA,EAAG;MACN,OAAO;QACNP,MAAM;QACNC,SAAS;QACTC,SAAS;QACTC;MACD,CAAC;IACF;EACD,CAAC,CAAC;AACH,CAAC;AACD;AACA;AACA;AACA;AACA,MAAMK,iBAAiB,GAAIC,GAAG,IAAK;EAClC;EACA,IAAIX,kBAAkB,KAAK,IAAI,EAAE;IAChC,IAAI;MAAEE,MAAM;MAAEC,SAAS;MAAEC,SAAS;MAAEC;IAAS,CAAC,GAAGM,GAAG;IACpDX,kBAAkB,CAACE,MAAM,GAAGA,MAAM;IAClCF,kBAAkB,CAACG,SAAS,GAAGA,SAAS;IACxCH,kBAAkB,CAACI,SAAS,GAAGA,SAAS;IACxCJ,kBAAkB,CAACK,QAAQ,GAAGA,QAAQ;IACtCL,kBAAkB,CAACY,mBAAmB,CAAC,CAAC,EAAC;EAC1C,CAAC,MAAM;IACN,IAAI;MAAEV,MAAM;MAAEC,SAAS;MAAEC,SAAS;MAAEC;IAAS,CAAC,GAAGM,GAAG;IACpD,OAAO,IAAIE,OAAO,CAAEC,OAAO,IAAK;MAC/Bb,sBAAsB,CAACC,MAAM,EAAEC,SAAS,EAAEC,SAAS,EAAEC,QAAQ,CAAC;MAC9DL,kBAAkB,CAACe,QAAQ,GAAIC,GAAG,IAAK;QACtCF,OAAO,CAACE,GAAG,CAAC;QACZ;QACA,IAAIA,GAAG,KAAK,QAAQ,IAAIhB,kBAAkB,KAAK,IAAI,EAAE;UACpDO,QAAQ,CAACU,IAAI,CAACC,WAAW,CAAClB,kBAAkB,CAACmB,GAAG,CAAC;UACjDnB,kBAAkB,GAAG,IAAI;QAC1B;MACD,CAAC;MACDO,QAAQ,CAACU,IAAI,CAACG,WAAW,CAACpB,kBAAkB,CAACmB,GAAG,CAAC,EAAC;MAClDvB,GAAG,CAACyB,QAAQ,CAAC,MAAM;QAClBrB,kBAAkB,CAACY,mBAAmB,CAAC,CAAC,EAAC;MAC1C,CAAC,CAAC;IACH,CAAC,CAAC;EACH;AACD,CAAC;AAED,eAAeF,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}