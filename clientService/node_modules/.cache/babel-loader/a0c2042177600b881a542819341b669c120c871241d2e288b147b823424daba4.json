{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.array.push.js\");\nvar _file = require(\"@/api/file\");\nvar _default = exports.default = {\n  name: 'BreadCrumb',\n  props: {\n    // 文件类型\n    fileType: {\n      required: true,\n      type: Number\n    },\n    // 文件路径\n    filePath: {\n      require: true,\n      type: String\n    }\n  },\n  data() {\n    return {\n      fileTypeMap: {\n        1: '全部图片',\n        2: '全部文档',\n        3: '全部视频',\n        4: '全部音乐',\n        5: '其他',\n        6: '回收站'\n      },\n      pageData: {\n        currentPage: 1,\n        pageCount: 50,\n        total: 0\n      },\n      isShowInput: false,\n      //  是否展示路径输入框\n      inputFilePath: '' //  路径输入\n    };\n  },\n  computed: {\n    /**\r\n     * 面包屑导航栏数组\r\n     */\n    breadCrumbList: {\n      get() {\n        let filePath = this.$route.query.filePath;\n        let filePathList = filePath ? filePath.split('/') : [];\n        let res = []; //  返回结果数组\n        let _path = []; //  存放祖先路径\n        for (let i = 0; i < filePathList.length; i++) {\n          if (filePathList[i]) {\n            _path.push(filePathList[i]);\n            res.push({\n              path: _path.join('/'),\n              name: filePathList[i]\n            });\n          } else if (i === 0) {\n            //  根目录\n            filePathList[i] = '';\n            _path.push(filePathList[i]);\n            res.push({\n              path: '/',\n              name: this.fileType === 0 ? '全部文件' : this.fileType === 8 ? '我的分享' : this.$route.name === 'Share' ? '全部分享' : ''\n            });\n          }\n        }\n        return res;\n      },\n      set() {\n        return [];\n      }\n    }\n  },\n  watch: {\n    '$route.query': {\n      immediate: true,\n      handler(newQuery) {\n        console.log('watch 路由跳转');\n        console.log(newQuery);\n        this.showFileList(newQuery);\n      }\n    }\n  },\n  methods: {\n    /**\r\n     * 表格数据获取相关事件 | 获取当前路径下的文件列表\r\n     */\n    showFileList(queryParams) {\n      console.log('路由跳转==');\n      console.log(queryParams);\n      let params = {\n        fileType: queryParams.fileType,\n        filePath: queryParams.filePath,\n        currentPage: this.pageData.currentPage,\n        pageCount: this.pageData.pageCount\n      };\n      console.log('请求参数：');\n      console.log(params);\n      (0, _file.getFileListByPath)(params).then(res => {\n        if (res && res.data && res.data.code === 200) {\n          console.log('result====');\n          console.log(res.data);\n          this.fileList = res.data.data.records;\n          this.pageData.total = Number(res.data.data.total);\n          this.loading = false;\n        } else {\n          this.$message.error(res.data.message);\n        }\n      });\n    },\n    /**\r\n     * 点击面包屑导航栏空白处\r\n     */\n    handleClickBreadCrumbSelf() {\n      console.log('点击面包屑导航栏空白处');\n      if (this.fileType === 0) {\n        this.inputFilePath = this.filePath;\n        this.isShowInput = true;\n        this.$nextTick(() => {\n          this.$refs.filePathInputRef.focus();\n        });\n      }\n    },\n    /**\r\n     * 路径输入框失去焦点或用户按下回车时触发\r\n     */\n    handleInputBlurEnter() {\n      this.isShowInput = false;\n      if (this.inputFilePath !== this.filePath) {\n        const fixInputFilePath = this.inputFilePath.endsWith('/') ? this.inputFilePath.slice(0, -1) : this.inputFilePath;\n        this.$router.push({\n          query: {\n            filePath: `${fixInputFilePath}`,\n            fileType: 0\n          }\n        });\n      }\n    },\n    // 获取文件参数\n    getRouteQuery(item) {\n      console.log('获取文件参数 === getRouteQuery');\n      let routeName = this.$route.name;\n      console.log('routeName===');\n      console.log(routeName);\n      if (routeName === 'Share') {\n        console.log('Share===' + routeName);\n        // 当前是查看他人分享列表的页面\n        return {\n          query: {\n            filePath: item.path\n          }\n        };\n      } else if (this.fileType === 8) {\n        console.log('this.fileType' + this.fileType);\n        // 当前是我的已分享列表页面\n        return {\n          query: {\n            fileType: 8,\n            filePath: item.path,\n            shareBatchNum: item.path === '/' ? undefined : this.$route.query.shareBatchNum //  当查看的是根目录，批次号置空\n          }\n        };\n      } else {\n        console.log('网盘页面跳转：');\n        console.log(item);\n        console.log(item.path);\n        // 网盘页面\n        return {\n          query: {\n            filePath: item.path,\n            fileType: 0\n          }\n        };\n      }\n    }\n  }\n};","map":{"version":3,"names":["_file","require","_default","exports","default","name","props","fileType","required","type","Number","filePath","String","data","fileTypeMap","pageData","currentPage","pageCount","total","isShowInput","inputFilePath","computed","breadCrumbList","get","$route","query","filePathList","split","res","_path","i","length","push","path","join","set","watch","immediate","handler","newQuery","console","log","showFileList","methods","queryParams","params","getFileListByPath","then","code","fileList","records","loading","$message","error","message","handleClickBreadCrumbSelf","$nextTick","$refs","filePathInputRef","focus","handleInputBlurEnter","fixInputFilePath","endsWith","slice","$router","getRouteQuery","item","routeName","shareBatchNum","undefined"],"sources":["src/components/file/components/BreadCrumb.vue"],"sourcesContent":["<template>\r\n\t<div class=\"breadcrumb-wrapper\">\r\n\t\t<div class=\"title\">当前位置：</div>\r\n\t\t<el-input class=\"file-path-input\" ref=\"filePathInputRef\" placeholder=\"请输入路径\" v-model=\"inputFilePath\" size=\"mini\"\r\n\t\t\t:autofocus=\"true\" v-show=\"isShowInput\" @blur=\"handleInputBlurEnter\"\r\n\t\t\t@change=\"handleInputBlurEnter\"></el-input>\r\n\t\t<div class=\"breadcrumb-box\" :class=\"{ 'able-input': fileType === 0 }\" v-show=\"!isShowInput\"\r\n\t\t\t@click.self=\"handleClickBreadCrumbSelf\">\r\n\t\t\t<el-breadcrumb v-if=\"![0, 8].includes(fileType) && !['Share'].includes($route.name)\"\r\n\t\t\t\tseparator-class=\"el-icon-arrow-right\">\r\n\t\t\t\t<el-breadcrumb-item>{{ fileTypeMap[fileType] }}</el-breadcrumb-item>\r\n\t\t\t</el-breadcrumb>\r\n\t\t\t<el-breadcrumb v-else separator-class=\"el-icon-arrow-right\">\r\n\t\t\t\t<el-breadcrumb-item v-for=\"(item, index) in breadCrumbList\" :key=\"index\" :to=\"getRouteQuery(item)\">{{\r\n\t\t\t\t\titem.name }}</el-breadcrumb-item>\r\n\t\t\t</el-breadcrumb>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { getFileListByPath } from '@/api/file'\r\nexport default {\r\n\tname: 'BreadCrumb',\r\n\tprops: {\r\n\t\t// 文件类型\r\n\t\tfileType: {\r\n\t\t\trequired: true,\r\n\t\t\ttype: Number\r\n\t\t},\r\n\t\t// 文件路径\r\n\t\tfilePath: {\r\n\t\t\trequire: true,\r\n\t\t\ttype: String\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tfileTypeMap: {\r\n\t\t\t\t1: '全部图片',\r\n\t\t\t\t2: '全部文档',\r\n\t\t\t\t3: '全部视频',\r\n\t\t\t\t4: '全部音乐',\r\n\t\t\t\t5: '其他',\r\n\t\t\t\t6: '回收站'\r\n\t\t\t},\r\n\t\t\tpageData: {\r\n\t\t\t\tcurrentPage: 1,\r\n\t\t\t\tpageCount: 50,\r\n\t\t\t\ttotal: 0\r\n\t\t\t},\r\n\t\t\tisShowInput: false, //  是否展示路径输入框\r\n\t\t\tinputFilePath: '' //  路径输入\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t/**\r\n\t\t * 面包屑导航栏数组\r\n\t\t */\r\n\t\tbreadCrumbList: {\r\n\t\t\tget() {\r\n\t\t\t\tlet filePath = this.$route.query.filePath\r\n\t\t\t\tlet filePathList = filePath ? filePath.split('/') : []\r\n\t\t\t\tlet res = [] //  返回结果数组\r\n\t\t\t\tlet _path = [] //  存放祖先路径\r\n\t\t\t\tfor (let i = 0; i < filePathList.length; i++) {\r\n\t\t\t\t\tif (filePathList[i]) {\r\n\t\t\t\t\t\t_path.push(filePathList[i])\r\n\t\t\t\t\t\tres.push({\r\n\t\t\t\t\t\t\tpath: _path.join('/'),\r\n\t\t\t\t\t\t\tname: filePathList[i]\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else if (i === 0) {\r\n\t\t\t\t\t\t//  根目录\r\n\t\t\t\t\t\tfilePathList[i] = ''\r\n\t\t\t\t\t\t_path.push(filePathList[i])\r\n\t\t\t\t\t\tres.push({\r\n\t\t\t\t\t\t\tpath: '/',\r\n\t\t\t\t\t\t\tname:\r\n\t\t\t\t\t\t\t\tthis.fileType === 0\r\n\t\t\t\t\t\t\t\t\t? '全部文件'\r\n\t\t\t\t\t\t\t\t\t: this.fileType === 8\r\n\t\t\t\t\t\t\t\t\t\t? '我的分享'\r\n\t\t\t\t\t\t\t\t\t\t: this.$route.name === 'Share'\r\n\t\t\t\t\t\t\t\t\t\t\t? '全部分享'\r\n\t\t\t\t\t\t\t\t\t\t\t: ''\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn res\r\n\t\t\t},\r\n\t\t\tset() {\r\n\t\t\t\treturn []\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\t'$route.query': {\r\n\t\t\timmediate: true,\r\n\t\t\thandler(newQuery) {\r\n\t\t\t\tconsole.log('watch 路由跳转')\r\n\t\t\t\tconsole.log(newQuery)\r\n\t\t\t\tthis.showFileList(newQuery)\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 表格数据获取相关事件 | 获取当前路径下的文件列表\r\n\t\t */\r\n\t\tshowFileList(queryParams) {\r\n\t\t\tconsole.log('路由跳转==')\r\n\t\t\tconsole.log(queryParams)\r\n\t\t\tlet params = {\r\n\t\t\t\tfileType: queryParams.fileType,\r\n\t\t\t\tfilePath: queryParams.filePath,\r\n\t\t\t\tcurrentPage: this.pageData.currentPage,\r\n\t\t\t\tpageCount: this.pageData.pageCount\r\n\t\t\t}\r\n\t\t\tconsole.log('请求参数：')\r\n\t\t\tconsole.log(params)\r\n\t\t\tgetFileListByPath(params).then((res) => {\r\n\t\t\t\tif (res && res.data && res.data.code === 200) {\r\n\t\t\t\t\tconsole.log('result====')\r\n\t\t\t\t\tconsole.log(res.data)\r\n\t\t\t\t\tthis.fileList = res.data.data.records\r\n\t\t\t\t\tthis.pageData.total = Number(res.data.data.total)\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$message.error(res.data.message)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t/**\r\n\t\t * 点击面包屑导航栏空白处\r\n\t\t */\r\n\t\thandleClickBreadCrumbSelf() {\r\n\t\t\tconsole.log('点击面包屑导航栏空白处')\r\n\t\t\tif (this.fileType === 0) {\r\n\t\t\t\tthis.inputFilePath = this.filePath\r\n\t\t\t\tthis.isShowInput = true\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.$refs.filePathInputRef.focus()\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * 路径输入框失去焦点或用户按下回车时触发\r\n\t\t */\r\n\t\thandleInputBlurEnter() {\r\n\t\t\tthis.isShowInput = false\r\n\t\t\tif (this.inputFilePath !== this.filePath) {\r\n\t\t\t\tconst fixInputFilePath = this.inputFilePath.endsWith('/')\r\n\t\t\t\t\t? this.inputFilePath.slice(0, -1)\r\n\t\t\t\t\t: this.inputFilePath\r\n\t\t\t\tthis.$router.push({\r\n\t\t\t\t\tquery: { filePath: `${fixInputFilePath}`, fileType: 0 }\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 获取文件参数\r\n\t\tgetRouteQuery(item) {\r\n\t\t\tconsole.log('获取文件参数 === getRouteQuery')\r\n\t\t\tlet routeName = this.$route.name\r\n\r\n\t\t\tconsole.log('routeName===')\r\n\t\t\tconsole.log(routeName)\r\n\t\t\tif (routeName === 'Share') {\r\n\t\t\t\tconsole.log('Share===' + routeName)\r\n\t\t\t\t// 当前是查看他人分享列表的页面\r\n\t\t\t\treturn { query: { filePath: item.path } }\r\n\t\t\t} else if (this.fileType === 8) {\r\n\t\t\t\tconsole.log('this.fileType' + this.fileType)\r\n\t\t\t\t// 当前是我的已分享列表页面\r\n\t\t\t\treturn {\r\n\t\t\t\t\tquery: {\r\n\t\t\t\t\t\tfileType: 8,\r\n\t\t\t\t\t\tfilePath: item.path,\r\n\t\t\t\t\t\tshareBatchNum:\r\n\t\t\t\t\t\t\titem.path === '/' ? undefined : this.$route.query.shareBatchNum //  当查看的是根目录，批次号置空\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log('网盘页面跳转：')\r\n\t\t\t\tconsole.log(item)\r\n\t\t\t\tconsole.log(item.path)\r\n\t\t\t\t// 网盘页面\r\n\t\t\t\treturn { query: { filePath: item.path, fileType: 0 } }\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n@import '~_a/styles/varibles.styl';\r\n\r\n.breadcrumb-wrapper {\r\n  padding: 0;\r\n  height: 30px;\r\n  line-height: 30px;\r\n  display: flex;\r\n\r\n  .title,\r\n  >>> .el-breadcrumb {\r\n    height: 30px;\r\n    line-height: 30px;\r\n  }\r\n\r\n  .file-path-input {\r\n    flex: 1;\r\n    font-size: 14px;\r\n  }\r\n  .breadcrumb-box {\r\n    padding: 0 8px;\r\n    flex: 1;\r\n    display: flex;\r\n    &.able-input {\r\n      cursor: pointer;\r\n      &:hover {\r\n        background: $tabBackColor;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}