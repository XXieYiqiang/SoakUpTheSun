{"ast":null,"code":"import Vue from 'vue';\n// 导入组件\nimport ImgPreview from './BoxMask.vue';\n// 使用基础 Vue 构造器，创建一个“子类”\nconst ImgPreviewConstructor = Vue.extend(ImgPreview);\nlet imgPreviewInstance = null;\n/**\r\n * 初始化图片预览实例\r\n * @param {string} imgList 图片列表\r\n * @param {object} defaultIndex 当前查看的图片索引\r\n */\nconst initInstanceImgPreview = (imgList, defaultIndex) => {\n  imgPreviewInstance = new ImgPreviewConstructor({\n    el: document.createElement('div'),\n    data() {\n      return {\n        imgList,\n        defaultIndex\n      };\n    }\n  });\n};\n/**\r\n * 图片预览 Promise 函数\r\n * @returns {Promise} 抛出确认和取消回调函数\r\n */\nconst showImgPreviewBox = obj => {\n  // 非首次调用服务时，在 DOM 中移除上个实例\n  if (imgPreviewInstance !== null) {\n    document.body.removeChild(imgPreviewInstance.$el);\n  }\n  let {\n    imgList,\n    defaultIndex\n  } = obj;\n  return new Promise(reslove => {\n    initInstanceImgPreview(imgList, defaultIndex);\n    imgPreviewInstance.callback = res => {\n      reslove(res);\n      // 服务取消时卸载 DOM\n      if (res === 'cancel' && imgPreviewInstance !== null) {\n        document.body.removeChild(imgPreviewInstance.$el);\n        imgPreviewInstance = null;\n      }\n    };\n    document.body.appendChild(imgPreviewInstance.$el); //  挂载 DOM\n    Vue.nextTick(() => {\n      imgPreviewInstance.visible = true; //  打开图片预览遮罩层\n    });\n  });\n};\nexport default showImgPreviewBox;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}