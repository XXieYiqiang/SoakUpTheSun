{"ast":null,"code":"import Vue from 'vue';\n// 导入组件\nimport DeleteFileDialog from './Dialog.vue';\n// 使用基础 Vue 构造器，创建一个“子类”\nconst DeleteFileConstructor = Vue.extend(DeleteFileDialog);\nlet deleteFileInstance = null;\n/**\r\n * 初始化删除文件实例\r\n * @param {boolean} isBatchOperation 是否为批量删除：true - 批量删除，false - 单文件删除\r\n * @param {object | array} fileInfo 文件信息，批量时为数组、单文件时为对象\r\n * @param {number} deleteMode 删除模式：1-删除到回收站 2-彻底删除\r\n */\nconst initInstanceDeleteFile = (isBatchOperation, fileInfo, deleteMode) => {\n  deleteFileInstance = new DeleteFileConstructor({\n    el: document.createElement('div'),\n    data() {\n      return {\n        isBatchOperation,\n        fileInfo,\n        deleteMode\n      };\n    }\n  });\n};\n/**\r\n * 删除文件 Promise 函数\r\n * @returns {Promise} 抛出确认和取消回调函数\r\n */\nconst showDeleteFileDialog = obj => {\n  // 非首次调用服务时，在 DOM 中移除上个实例\n  if (deleteFileInstance !== null) {\n    document.body.removeChild(deleteFileInstance.$el);\n  }\n  let {\n    isBatchOperation,\n    fileInfo,\n    deleteMode\n  } = obj;\n  return new Promise(reslove => {\n    initInstanceDeleteFile(isBatchOperation, fileInfo, deleteMode);\n    deleteFileInstance.callback = res => {\n      reslove(res);\n      // 服务取消时卸载 DOM\n      if (res === 'cancel' && deleteFileInstance !== null) {\n        document.body.removeChild(deleteFileInstance.$el);\n        deleteFileInstance = null;\n      }\n    };\n    document.body.appendChild(deleteFileInstance.$el); //  挂载 DOM\n    Vue.nextTick(() => {\n      deleteFileInstance.visible = true; //  打开对话框\n    });\n  });\n};\nexport default showDeleteFileDialog;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}