{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { getNewsTop10 } from '@/api/news';\nexport default {\n  data() {\n    return {\n      baseUrl: process.env.VUE_APP_BASE_API,\n      currentTime: '',\n      lunarDate: '',\n      // 补全 data 定义\n      timer: null,\n      timer1: null,\n      boardList: [{\n        title: \"新浪微博\",\n        tag: \"热搜\",\n        icon: \"/upload/xlwb.png\",\n        lastUpdate: new Date(Date.now() - 5 * 60 * 1000),\n        items: [{\n          title: '2025年度热词有哪些？',\n          url: '#'\n        }, {\n          title: 'AI 辅助编程进入主流了吗？',\n          url: '#'\n        }, {\n          title: '未来科技趋势展望报告',\n          url: '#'\n        }, {\n          title: 'SpaceX 新一代星舰发射成功',\n          url: '#'\n        }, {\n          title: '全球气候变化峰会开幕',\n          url: '#'\n        }],\n        loading: false\n      }, {\n        title: \"抖音\",\n        tag: \"视频\",\n        icon: \"/upload/dy.png\",\n        lastUpdate: new Date(Date.now() - 60 * 60 * 1000),\n        items: [],\n        loading: false\n      }, {\n        title: \"知乎\",\n        tag: \"讨论\",\n        icon: \"/upload/zh.png\",\n        lastUpdate: new Date(Date.now() - 3 * 60 * 60 * 1000),\n        items: [],\n        loading: false\n      }, {\n        title: \"澎湃新闻\",\n        tag: \"时事\",\n        icon: \"/upload/pp.png\",\n        lastUpdate: new Date(Date.now() - 2 * 60 * 60 * 1000),\n        items: [],\n        loading: false\n      }, {\n        title: \"网易新闻\",\n        tag: \"综合\",\n        icon: \"/upload/wy.png\",\n        lastUpdate: new Date(Date.now() - 30 * 60 * 1000),\n        items: [],\n        loading: false\n      }, {\n        title: \"CSDN\",\n        tag: \"技术\",\n        icon: \"/upload/csdn.png\",\n        lastUpdate: new Date(Date.now() - 10 * 60 * 1000),\n        items: [],\n        loading: false\n      }]\n    };\n  },\n  methods: {\n    getTagClass(tag) {\n      // 根据标签内容返回不同的颜色样式类，这里统一样式，可根据需求扩展\n      return 'tag-default';\n    },\n    onToNewsDetails(row) {\n      console.log('跳转到新闻详情页面，row=', row);\n      if (row.url) window.open(row.url);\n    },\n    getData() {\n      // 页面初始加载时，全部卡片都显示 loading\n      this.boardList.forEach(board => board.loading = true);\n      let param = {};\n      getNewsTop10(param).then(res => {\n        if (res && res.data.code === 200 && res.data.data) {\n          const dataMap = {\n            0: 'XINLANGB',\n            1: 'DOUYIN',\n            2: 'XINLANGNEWS',\n            3: 'PENGPAI',\n            4: 'WANGYIXINWEN',\n            5: 'CSDN'\n          };\n          Object.keys(dataMap).forEach(index => {\n            const i = Number(index);\n            // 确保 items 存在\n            const items = res.data.data[dataMap[i]] || [];\n            if (items.length > 0) {\n              this.boardList[i].items = items;\n            }\n            this.boardList[i].loading = false;\n            this.boardList[i].lastUpdate = new Date();\n          });\n        } else {\n          // 模拟数据（如果接口不通，防止页面空白，仅供展示效果）\n          this.boardList.forEach(board => {\n            if (board.items.length === 0) board.loading = false;\n          });\n          // this.$message.error(res.data.message)\n        }\n      }).catch(err => {\n        console.error(err);\n        this.boardList.forEach(board => board.loading = false);\n      });\n    },\n    toNewsDetails() {\n      this.$router.push({\n        name: 'newDetails'\n      });\n    },\n    getRelativeTime(time) {\n      if (!time) return '';\n      const diff = (Date.now() - new Date(time)) / 1000;\n      if (diff < 60) return \"刚刚更新\";\n      if (diff < 3600) return Math.floor(diff / 60) + \" 分钟前\";\n      if (diff < 86400) return Math.floor(diff / 3600) + \" 小时前\";\n      return Math.floor(diff / 86400) + \" 天前\";\n    },\n    async refreshBoard(index) {\n      this.boardList[index].loading = true;\n      try {\n        const res = await getNewsTop10({});\n        if (res && res.data.code === 200 && res.data.data) {\n          // 逻辑同 getData，这里简化\n          // 实际应根据 index 映射 key\n          setTimeout(() => {\n            this.boardList[index].loading = false;\n          }, 800); // 模拟网络延迟感\n          this.boardList[index].lastUpdate = new Date();\n        } else {\n          this.$message.error(res.data.message);\n          this.boardList[index].loading = false;\n        }\n      } catch (error) {\n        console.error(error);\n        this.boardList[index].loading = false;\n      }\n    },\n    updateTime() {\n      const now = new Date();\n      const pad = n => n.toString().padStart(2, '0');\n      const week = ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'];\n      this.currentTime = `${now.getFullYear()}-${pad(now.getMonth() + 1)}-${pad(now.getDate())} ${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;\n      this.lunarDate = `农历十月十三 ${week[now.getDay()]}`;\n    }\n  },\n  mounted() {\n    this.updateTime();\n    this.timer = setInterval(this.updateTime, 1000);\n    this.getData();\n    this.timer1 = setInterval(() => {\n      this.getData();\n    }, 30 * 1000);\n  },\n  beforeDestroy() {\n    clearInterval(this.timer);\n    clearInterval(this.timer1);\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}