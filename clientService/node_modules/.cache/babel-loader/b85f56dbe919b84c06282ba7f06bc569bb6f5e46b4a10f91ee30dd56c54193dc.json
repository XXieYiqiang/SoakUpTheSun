{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"C:/Users/Administrator/Desktop/SoakUpTheSun/clientService/node_modules/@babel/runtime/helpers/interopRequireWildcard.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.filter.js\");\nrequire(\"core-js/modules/es.iterator.for-each.js\");\nrequire(\"core-js/modules/es.iterator.map.js\");\nvar _file = require(\"@/api/file.js\");\nvar Base64 = _interopRequireWildcard(require(\"js-base64\"));\nvar _default = exports.default = {\n  name: 'AudioPreview',\n  data() {\n    return {\n      visible: false,\n      //  音频预览组件是否可见\n      activeIndex: 0,\n      //  当前打开的音频索引\n      activePlayIcon: require('_a/images/audio/wave.gif'),\n      cycleType: 1,\n      //  音频播放的循环模式\n      // 音频循环模式和图标对应的 Map\n      cycleTypeMap: {\n        1: {\n          icon: 'icon-xunhuanbofang',\n          text: '列表循环'\n        },\n        2: {\n          icon: 'icon-danquxunhuan1',\n          text: '单曲循环'\n        },\n        3: {\n          icon: 'icon-suijibofang1',\n          text: '随机播放'\n        }\n      },\n      isPlay: false,\n      //  是否正在播放\n      currentTime: 0,\n      //  当前播放的秒\n      isDrop: false,\n      //  是否正在拖拽播放进度滑块\n      volume: 0,\n      //  音量\n      audioInfo: {},\n      //  音频信息\n      lyricsList: [],\n      //  歌词列表\n      currentLyricsLineIndex: 0 //  当前高亮的歌词行索引，从 0 开始\n    };\n  },\n  computed: {\n    // 当前显示的文件信息\n    activeFileObj() {\n      const res = this.audioList.length ? this.audioList[this.activeIndex] : {};\n      return res;\n    },\n    // 隐藏的 audio 标签\n    audioElement() {\n      return this.$refs.audioRef;\n    },\n    // 歌曲封面\n    musicImgUrl() {\n      return this.audioInfo.albumImage ? `data:image/jpeg;base64,${this.audioInfo.albumImage}` : require('_a/images/file/file_music.png');\n    },\n    // 播放进度条步长\n    progressStep() {\n      return this.audioInfo.duration / 100;\n    }\n  },\n  watch: {\n    // 监听音频预览组件状态\n    visible(newValue) {\n      if (newValue) {\n        this.activeIndex = this.defaultIndex;\n        this.getFileDetailData();\n        // 添加键盘相关事件\n        document.addEventListener('keyup', this.handleAddKeyupEvent);\n      } else {\n        // 移除键盘相关事件\n        document.removeEventListener('keyup', this.handleAddKeyupEvent);\n      }\n    },\n    // 监听当前索引变化\n    activeIndex() {\n      this.getFileDetailData();\n    }\n  },\n  methods: {\n    /**\r\n     * DOM 绑定 Esc 键、左方向键、右方向键的键盘按下事件\r\n     * @param {event} event 事件\r\n     */\n    handleAddKeyupEvent(event) {\n      switch (event.code) {\n        // 关闭预览\n        case 'Escape':\n          {\n            this.handleClosePreview();\n            break;\n          }\n        // 切换到上一个\n        case 'ArrowLeft':\n          {\n            this.handleChangeAudioIndex('pre');\n            break;\n          }\n        // 切换到下一个\n        case 'ArrowRight':\n          {\n            this.handleChangeAudioIndex('next');\n            break;\n          }\n        // 音量调大\n        case 'ArrowUp':\n          {\n            this.volume = this.volume === 1 ? 1 : this.volume + 0.1;\n            this.volume = Number(this.volume.toFixed(1));\n            this.handleChangeVolumeBar(this.volume);\n            break;\n          }\n        // 音量调小\n        case 'ArrowDown':\n          {\n            this.volume = this.volume === 0 ? 0 : this.volume - 0.1;\n            this.volume = Number(this.volume.toFixed(1));\n            this.handleChangeVolumeBar(this.volume);\n            break;\n          }\n        // 暂停/播放\n        case 'Space':\n          {\n            this.handleChangeAudioIndex('manual', this.activeIndex);\n            break;\n          }\n      }\n    },\n    /**\r\n     * 获取文件信息\r\n     */\n    getFileDetailData() {\n      this.handleClickPauseIcon();\n      this.loading = true;\n      (0, _file.getFileDetail)({\n        userFileId: this.activeFileObj.userFileId\n      }).then(res => {\n        this.loading = false;\n        if (res.success) {\n          this.audioInfo = {\n            ...res.data.music,\n            duration: res.data.music.trackLength\n          };\n          // Base64 解码为 lrc 格式的歌词文件\n          let lyricsStr = Base64.decode(this.audioInfo.lyrics);\n          if (lyricsStr.includes('[offset:0]')) {\n            // 有歌词，从标志位 [offset:0] 下一行开始截取\n            lyricsStr = lyricsStr.split('[offset:0]\\n')[1];\n          }\n          this.lyricsList = lyricsStr.split('\\n').map(item => {\n            const line = item.split('[')[1].split(']');\n            return {\n              time: line[0],\n              //  当前行歌词开始播放的秒数\n              text: line[1] //  当前歌词文本\n            };\n          }).filter(item => item.text !== '');\n          this.lyricsList = this.lyricsList.map((item, index) => {\n            return {\n              ...item,\n              // 当前行歌词起始秒数\n              startSeconds: this.transferTimeToSeconds(item.time),\n              // 当前行歌词结束秒数\n              endSeconds: index < this.lyricsList.length - 1 ? this.transferTimeToSeconds(this.lyricsList[index + 1].time) : this.audioInfo.duration\n            };\n          });\n          // 当切换完歌曲时，歌词重新滚动到顶部\n          this.$refs.lyricsListRef.scrollTo({\n            top: 0,\n            behavior: 'smooth'\n          });\n          this.currentLyricsLineIndex = 0;\n        }\n      }).catch(() => {\n        this.loading = false;\n      });\n    },\n    /**\r\n     * 获取播放器参数\r\n     */\n    handleLoadedmetadata(event) {\n      const audioDom = event.target;\n      this.volume = audioDom.volume || 0.5;\n      this.currentTime = audioDom.currentTime;\n      this.handleClickPlayIcon();\n    },\n    /**\r\n     * 将秒转化为时分秒\r\n     * @param {number} duration 总秒数\r\n     */\n    transferSecondsToTime(duration) {\n      const hour = Math.floor(duration / 3600);\n      const minutes = Math.floor(duration / 60);\n      const seconds = Math.ceil(duration % 60);\n      return `${hour < 10 ? `0${hour}` : hour}:${minutes < 10 ? `0${minutes}` : minutes}:${seconds < 10 ? `0${seconds}` : seconds}`;\n    },\n    /**\r\n     * 将分秒转化为秒\r\n     * @param {string} time 分秒，格式 00:00\r\n     */\n    transferTimeToSeconds(time) {\n      const timeList = time.split('.')[0].split(':');\n      return Number(timeList[1]) + Number(timeList[0]) * 60;\n    },\n    /**\r\n     * 当前播放时间改变时触发\r\n     */\n    handleTimeUpdate(event) {\n      // 如果正在拖拽进度滑块，函数结束，不计算当前时间\n      if (this.isDrop) return;\n      this.currentTime = event.target.currentTime;\n      if (this.lyricsList.length) {\n        // 遍历歌词，当前秒对应的歌词整行添加高亮效果\n        this.lyricsList.forEach((item, index) => {\n          if (item.startSeconds <= this.currentTime && this.currentTime < item.endSeconds && this.currentLyricsLineIndex !== index) {\n            // 确定高亮歌词行索引\n            this.currentLyricsLineIndex = index;\n            // 使高亮歌词行永远保持在第二行\n            if (this.currentLyricsLineIndex > 2) {\n              // 平滑滚动\n              this.$refs.lyricsListRef.scrollTo({\n                top: this.$refs.lyricsLineRef[index].clientHeight * (index - 2),\n                behavior: 'smooth'\n              });\n            }\n          }\n        });\n      }\n    },\n    /**\r\n     * 拖动播放进度滑块触发\r\n     */\n    handleChangeProgress(progress) {\n      this.audioElement.currentTime = progress;\n      this.isDrop = false;\n    },\n    /**\r\n     * 切换循环播放类型\r\n     */\n    handleChangeCycleType() {\n      if (this.cycleType === 3) {\n        this.cycleType = 1;\n      } else if (this.cycleType >= 1) {\n        this.cycleType++;\n      }\n    },\n    /**\r\n     * 点击播放图标触发\r\n     * @description 开始播放音频\r\n     */\n    handleClickPlayIcon() {\n      this.isPlay = true;\n      this.audioElement.play();\n    },\n    /**\r\n     * 点击暂停图标触发\r\n     * @description 暂停音频\r\n     */\n    handleClickPauseIcon() {\n      this.isPlay = false;\n      this.audioElement.pause();\n    },\n    /**\r\n     * 切换、暂停或播放歌曲\r\n     * @param {string} type pre - 上一首 | next - 下一首 | manual 手动切换\r\n     * @param {number} index 手动切换的音频索引，从 0 开始\r\n     */\n    handleChangeAudioIndex(type, index) {\n      // 如果当前手动切换\n      if (type === 'manual') {\n        if (this.activeIndex === index) {\n          if (this.isPlay) {\n            this.handleClickPauseIcon();\n          } else {\n            this.handleClickPlayIcon();\n          }\n        } else {\n          this.activeIndex = index;\n        }\n      } else {\n        this.handleClickPauseIcon();\n        // 判断当前循环播放类型\n        switch (this.cycleType) {\n          case 3:\n            {\n              let activeIndex = 0;\n              do {\n                activeIndex = Math.floor(Math.random() * (this.audioList.length - 1)) + 1;\n              } while (this.activeIndex === activeIndex);\n              this.activeIndex = activeIndex;\n              break;\n            }\n          default:\n            {\n              if (type === 'pre') {\n                if (this.activeIndex === 0) {\n                  this.activeIndex = this.audioList.length - 1;\n                } else {\n                  this.activeIndex--;\n                }\n              } else if (type === 'next') {\n                if (this.activeIndex === this.audioList.length - 1) {\n                  this.activeIndex = 0;\n                } else {\n                  this.activeIndex++;\n                }\n              }\n              break;\n            }\n        }\n      }\n    },\n    /**\r\n     * 点击音量图标\r\n     */\n    handleClickVolumeIcon() {\n      this.volume = this.volume === 0 ? 0.5 : 0;\n      this.handleChangeVolumeBar(this.volume);\n    },\n    /**\r\n     * 音量滑块改变时触发\r\n     */\n    handleChangeVolumeBar(volume) {\n      this.audioElement.volume = Number(volume.toFixed(1));\n    },\n    // 关闭音频预览\n    handleClosePreview() {\n      this.visible = false;\n      this.callback('cancel');\n    }\n  }\n};","map":{"version":3,"names":["_file","require","Base64","_interopRequireWildcard","_default","exports","default","name","data","visible","activeIndex","activePlayIcon","cycleType","cycleTypeMap","icon","text","isPlay","currentTime","isDrop","volume","audioInfo","lyricsList","currentLyricsLineIndex","computed","activeFileObj","res","audioList","length","audioElement","$refs","audioRef","musicImgUrl","albumImage","progressStep","duration","watch","newValue","defaultIndex","getFileDetailData","document","addEventListener","handleAddKeyupEvent","removeEventListener","methods","event","code","handleClosePreview","handleChangeAudioIndex","Number","toFixed","handleChangeVolumeBar","handleClickPauseIcon","loading","getFileDetail","userFileId","then","success","music","trackLength","lyricsStr","decode","lyrics","includes","split","map","item","line","time","filter","index","startSeconds","transferTimeToSeconds","endSeconds","lyricsListRef","scrollTo","top","behavior","catch","handleLoadedmetadata","audioDom","target","handleClickPlayIcon","transferSecondsToTime","hour","Math","floor","minutes","seconds","ceil","timeList","handleTimeUpdate","forEach","lyricsLineRef","clientHeight","handleChangeProgress","progress","handleChangeCycleType","play","pause","type","random","handleClickVolumeIcon","callback"],"sources":["src/components/file/box/audioPreview/BoxMask.vue"],"sourcesContent":["<template>\r\n\t<transition name=\"el-zoom-in-top\">\r\n\t\t<div class=\"audio-preview-wrapper\" v-show=\"visible\">\r\n\t\t\t<img class=\"audio-background\" :src=\"musicImgUrl\" alt=\"背景图\" />\r\n\t\t\t<!-- 右上角操作 -->\r\n\t\t\t<div class=\"operate-box\">\r\n\t\t\t\t<el-tooltip class=\"operate-tip\" effect=\"dark\" placement=\"bottom\">\r\n\t\t\t\t\t<div slot=\"content\" style=\"line-height: 2\">\r\n\t\t\t\t\t\t操作提示: <br />\r\n\t\t\t\t\t\t1. 按 Esc 键可退出查看；<br />\r\n\t\t\t\t\t\t2. 支持键盘控制：<br />\r\n\t\t\t\t\t\t&nbsp;&nbsp;空格 - 暂停/播放<br />\r\n\t\t\t\t\t\t&nbsp;&nbsp;左方向键 - 播放上一个<br />\r\n\t\t\t\t\t\t&nbsp;&nbsp;右方向键 - 播放下一个<br />\r\n\t\t\t\t\t\t&nbsp;&nbsp;上方向键 - 音量调大<br />\r\n\t\t\t\t\t\t&nbsp;&nbsp;下方向键 - 音量减小<br />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<i class=\"tip-icon el-icon-s-opportunity\"></i>\r\n\t\t\t\t</el-tooltip>\r\n\t\t\t\t<i\r\n\t\t\t\t\tclass=\"close-icon el-icon-close\"\r\n\t\t\t\t\ttitle=\"关闭（Escape）\"\r\n\t\t\t\t\t@click=\"handleClosePreview\"\r\n\t\t\t\t></i>\r\n\t\t\t</div>\r\n\t\t\t<audio\r\n\t\t\t\tref=\"audioRef\"\r\n\t\t\t\t:src=\"activeFileObj.fileUrl\"\r\n\t\t\t\tcontrols\r\n\t\t\t\tstyle=\"position: fixed; top: 0; left: 0; display: none\"\r\n\t\t\t\t@loadedmetadata=\"handleLoadedmetadata\"\r\n\t\t\t\t@timeupdate=\"handleTimeUpdate\"\r\n\t\t\t\t@ended=\"handleChangeAudioIndex('next')\"\r\n\t\t\t></audio>\r\n\t\t\t<div class=\"audio-list-wrapper\">\r\n\t\t\t\t<!-- 音频列表 -->\r\n\t\t\t\t<ul class=\"audio-list\">\r\n\t\t\t\t\t<li class=\"audio-list-header\">\r\n\t\t\t\t\t\t<span class=\"name\">音频名称</span>\r\n\t\t\t\t\t\t<span class=\"audio-size\">大小</span>\r\n\t\t\t\t\t\t<span class=\"path\">路径</span>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t<div class=\"audio-list-body\">\r\n\t\t\t\t\t\t<li\r\n\t\t\t\t\t\t\tclass=\"audio-item\"\r\n\t\t\t\t\t\t\tv-for=\"(item, index) in audioList\"\r\n\t\t\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t\t\t:class=\"[activeIndex === index ? 'active' : '']\"\r\n\t\t\t\t\t\t\t:title=\"isPlay ? '暂停' : '播放'\"\r\n\t\t\t\t\t\t\t@click=\"handleChangeAudioIndex('manual', index)\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<span class=\"name\">\r\n\t\t\t\t\t\t\t\t<span class=\"sequence\" v-show=\"activeIndex !== index\">\r\n\t\t\t\t\t\t\t\t\t{{ index + 1 }}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\tclass=\"wave\"\r\n\t\t\t\t\t\t\t\t\t:src=\"activePlayIcon\"\r\n\t\t\t\t\t\t\t\t\talt=\"波浪动图\"\r\n\t\t\t\t\t\t\t\t\tv-show=\"activeIndex === index && isPlay\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\tclass=\"no-wave el-icon-s-data\"\r\n\t\t\t\t\t\t\t\t\tv-show=\"activeIndex === index && !isPlay\"\r\n\t\t\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t\t\t<span class=\"text\"\r\n\t\t\t\t\t\t\t\t\t>{{ item.fileName }}.{{ item.extendName }}</span\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclass=\"play-icon iconfont icon-icon-7\"\r\n\t\t\t\t\t\t\t\tv-show=\"activeIndex === index && !isPlay\"\r\n\t\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclass=\"pause-icon iconfont icon-icon-3\"\r\n\t\t\t\t\t\t\t\tv-show=\"activeIndex === index && isPlay\"\r\n\t\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\tclass=\"download\"\r\n\t\t\t\t\t\t\t\t:href=\"$file.getDownloadFilePath(item)\"\r\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\t\t\ttitle=\"下载\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<i class=\"download-icon el-icon-download\"></i>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclass=\"share-icon el-icon-share\"\r\n\t\t\t\t\t\t\t\ttitle=\"分享\"\r\n\t\t\t\t\t\t\t\t@click.stop=\"\r\n\t\t\t\t\t\t\t\t\t$openDialog.shareFile({\r\n\t\t\t\t\t\t\t\t\t\tfileInfo: [\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tuserFileId: item.userFileId\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\"\r\n\t\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t\t<span class=\"audio-size\">{{\r\n\t\t\t\t\t\t\t\t$file.calculateFileSize(item.fileSize)\r\n\t\t\t\t\t\t\t}}</span>\r\n\t\t\t\t\t\t\t<span class=\"path\">{{ item.filePath }}</span>\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</ul>\r\n\t\t\t\t<!-- 歌曲图片和歌词 -->\r\n\t\t\t\t<div class=\"img-and-lyrics\">\r\n\t\t\t\t\t<img class=\"audio-img\" :src=\"musicImgUrl\" alt=\"歌曲图片\" />\r\n\t\t\t\t\t<div class=\"audio-name\">\r\n\t\t\t\t\t\t{{ activeFileObj.fileName }}.{{ activeFileObj.extendName }}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"album-artist\" v-show=\"audioInfo.artist\">\r\n\t\t\t\t\t\t歌手：{{ audioInfo.artist }}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"album-name\" v-if=\"audioInfo.album\">\r\n\t\t\t\t\t\t专辑：{{ audioInfo.album }}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<ul\r\n\t\t\t\t\t\tclass=\"lyrics-list\"\r\n\t\t\t\t\t\tref=\"lyricsListRef\"\r\n\t\t\t\t\t\t:class=\"{ one: lyricsList.length === 1 }\"\r\n\t\t\t\t\t\tv-if=\"lyricsList.length\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<li\r\n\t\t\t\t\t\t\tclass=\"lyrics-item\"\r\n\t\t\t\t\t\t\tref=\"lyricsLineRef\"\r\n\t\t\t\t\t\t\tv-for=\"(item, index) in lyricsList\"\r\n\t\t\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t\t\t:class=\"{\r\n\t\t\t\t\t\t\t\tactive: currentLyricsLineIndex === index\r\n\t\t\t\t\t\t\t}\"\r\n\t\t\t\t\t\t\t@click=\"handleChangeProgress(transferTimeToSeconds(item.time))\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{{ item.text }}\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<!-- 底部音乐控件 -->\r\n\t\t\t<div class=\"control-wrapper\">\r\n\t\t\t\t<div class=\"control-left\">\r\n\t\t\t\t\t<i\r\n\t\t\t\t\t\tclass=\"operate-icon iconfont icon-shangyishou\"\r\n\t\t\t\t\t\ttitle=\"上一个（按左方向键）\"\r\n\t\t\t\t\t\t@click=\"handleChangeAudioIndex('pre')\"\r\n\t\t\t\t\t></i>\r\n\t\t\t\t\t<i\r\n\t\t\t\t\t\tclass=\"operate-icon play-icon iconfont icon-icon-7\"\r\n\t\t\t\t\t\tv-show=\"!isPlay\"\r\n\t\t\t\t\t\ttitle=\"播放（按空格键）\"\r\n\t\t\t\t\t\t@click=\"handleClickPlayIcon\"\r\n\t\t\t\t\t></i>\r\n\t\t\t\t\t<i\r\n\t\t\t\t\t\tclass=\"operate-icon pause-icon iconfont icon-icon-3\"\r\n\t\t\t\t\t\tv-show=\"isPlay\"\r\n\t\t\t\t\t\ttitle=\"暂停（按空格键）\"\r\n\t\t\t\t\t\t@click=\"handleClickPauseIcon\"\r\n\t\t\t\t\t></i>\r\n\t\t\t\t\t<i\r\n\t\t\t\t\t\tclass=\"operate-icon iconfont icon-xiayishou\"\r\n\t\t\t\t\t\ttitle=\"下一个（按右方向键）\"\r\n\t\t\t\t\t\t@click=\"handleChangeAudioIndex('next')\"\r\n\t\t\t\t\t></i>\r\n\t\t\t\t\t<el-slider\r\n\t\t\t\t\t\tclass=\"progress-bar control-item\"\r\n\t\t\t\t\t\tv-model=\"currentTime\"\r\n\t\t\t\t\t\t:step=\"progressStep\"\r\n\t\t\t\t\t\t:max=\"audioInfo.duration\"\r\n\t\t\t\t\t\t:format-tooltip=\"(val) => transferSecondsToTime(val)\"\r\n\t\t\t\t\t\t@mousedown.native=\"isDrop = true\"\r\n\t\t\t\t\t\t@mouseup.native=\"isDrop = false\"\r\n\t\t\t\t\t\t@change=\"handleChangeProgress\"\r\n\t\t\t\t\t></el-slider>\r\n\t\t\t\t\t<span class=\"time control-item\"\r\n\t\t\t\t\t\t>{{ transferSecondsToTime(currentTime) }} /\r\n\t\t\t\t\t\t{{ transferSecondsToTime(audioInfo.duration) }}</span\r\n\t\t\t\t\t>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"control-right\">\r\n\t\t\t\t\t<i\r\n\t\t\t\t\t\tclass=\"operate-icon cycle-type iconfont\"\r\n\t\t\t\t\t\t:class=\"cycleTypeMap[String(cycleType)].icon\"\r\n\t\t\t\t\t\t:title=\"cycleTypeMap[String(cycleType)].text\"\r\n\t\t\t\t\t\t@click=\"handleChangeCycleType\"\r\n\t\t\t\t\t></i>\r\n\t\t\t\t\t<a\r\n\t\t\t\t\t\tclass=\"operate-icon download-link\"\r\n\t\t\t\t\t\t:href=\"$file.getDownloadFilePath(activeFileObj)\"\r\n\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\ttitle=\"下载\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"download-icon el-icon-download\"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<i\r\n\t\t\t\t\t\tclass=\"operate-icon share-icon el-icon-share\"\r\n\t\t\t\t\t\ttitle=\"分享\"\r\n\t\t\t\t\t\t@click.stop=\"\r\n\t\t\t\t\t\t\t$openDialog.shareFile({\r\n\t\t\t\t\t\t\t\tfileInfo: [\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tuserFileId: item.userFileId\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\"\r\n\t\t\t\t\t></i>\r\n\t\t\t\t\t<i\r\n\t\t\t\t\t\tclass=\"operate-icon volume-icon control-item iconfont\"\r\n\t\t\t\t\t\t:class=\"volume === 0 ? 'icon-jingyin01' : 'icon-yinliang101'\"\r\n\t\t\t\t\t\t@click=\"handleClickVolumeIcon\"\r\n\t\t\t\t\t></i>\r\n\t\t\t\t\t<el-slider\r\n\t\t\t\t\t\tclass=\"volume-bar control-item\"\r\n\t\t\t\t\t\tv-model=\"volume\"\r\n\t\t\t\t\t\t:step=\"0.01\"\r\n\t\t\t\t\t\t:max=\"1\"\r\n\t\t\t\t\t\t:format-tooltip=\"(val) => Math.floor(val * 100)\"\r\n\t\t\t\t\t\theight=\"100px\"\r\n\t\t\t\t\t\ttitle=\"可按上下方向键调节音量\"\r\n\t\t\t\t\t\t@input=\"handleChangeVolumeBar\"\r\n\t\t\t\t\t></el-slider>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</transition>\r\n</template>\r\n\r\n<script>\r\nimport { getFileDetail } from '@/api/file.js'\r\nimport * as Base64 from 'js-base64'\r\n\r\nexport default {\r\n\tname: 'AudioPreview',\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tvisible: false, //  音频预览组件是否可见\r\n\t\t\tactiveIndex: 0, //  当前打开的音频索引\r\n\t\t\tactivePlayIcon: require('_a/images/audio/wave.gif'),\r\n\t\t\tcycleType: 1, //  音频播放的循环模式\r\n\t\t\t// 音频循环模式和图标对应的 Map\r\n\t\t\tcycleTypeMap: {\r\n\t\t\t\t1: {\r\n\t\t\t\t\ticon: 'icon-xunhuanbofang',\r\n\t\t\t\t\ttext: '列表循环'\r\n\t\t\t\t},\r\n\t\t\t\t2: {\r\n\t\t\t\t\ticon: 'icon-danquxunhuan1',\r\n\t\t\t\t\ttext: '单曲循环'\r\n\t\t\t\t},\r\n\t\t\t\t3: {\r\n\t\t\t\t\ticon: 'icon-suijibofang1',\r\n\t\t\t\t\ttext: '随机播放'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tisPlay: false, //  是否正在播放\r\n\t\t\tcurrentTime: 0, //  当前播放的秒\r\n\t\t\tisDrop: false, //  是否正在拖拽播放进度滑块\r\n\t\t\tvolume: 0, //  音量\r\n\t\t\taudioInfo: {}, //  音频信息\r\n\t\t\tlyricsList: [], //  歌词列表\r\n\t\t\tcurrentLyricsLineIndex: 0 //  当前高亮的歌词行索引，从 0 开始\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t// 当前显示的文件信息\r\n\t\tactiveFileObj() {\r\n\t\t\tconst res = this.audioList.length ? this.audioList[this.activeIndex] : {}\r\n\t\t\treturn res\r\n\t\t},\r\n\t\t// 隐藏的 audio 标签\r\n\t\taudioElement() {\r\n\t\t\treturn this.$refs.audioRef\r\n\t\t},\r\n\t\t// 歌曲封面\r\n\t\tmusicImgUrl() {\r\n\t\t\treturn this.audioInfo.albumImage\r\n\t\t\t\t? `data:image/jpeg;base64,${this.audioInfo.albumImage}`\r\n\t\t\t\t: require('_a/images/file/file_music.png')\r\n\t\t},\r\n\t\t// 播放进度条步长\r\n\t\tprogressStep() {\r\n\t\t\treturn this.audioInfo.duration / 100\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\t// 监听音频预览组件状态\r\n\t\tvisible(newValue) {\r\n\t\t\tif (newValue) {\r\n\t\t\t\tthis.activeIndex = this.defaultIndex\r\n\t\t\t\tthis.getFileDetailData()\r\n\t\t\t\t// 添加键盘相关事件\r\n\t\t\t\tdocument.addEventListener('keyup', this.handleAddKeyupEvent)\r\n\t\t\t} else {\r\n\t\t\t\t// 移除键盘相关事件\r\n\t\t\t\tdocument.removeEventListener('keyup', this.handleAddKeyupEvent)\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 监听当前索引变化\r\n\t\tactiveIndex() {\r\n\t\t\tthis.getFileDetailData()\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * DOM 绑定 Esc 键、左方向键、右方向键的键盘按下事件\r\n\t\t * @param {event} event 事件\r\n\t\t */\r\n\t\thandleAddKeyupEvent(event) {\r\n\t\t\tswitch (event.code) {\r\n\t\t\t\t// 关闭预览\r\n\t\t\t\tcase 'Escape': {\r\n\t\t\t\t\tthis.handleClosePreview()\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t\t// 切换到上一个\r\n\t\t\t\tcase 'ArrowLeft': {\r\n\t\t\t\t\tthis.handleChangeAudioIndex('pre')\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t\t// 切换到下一个\r\n\t\t\t\tcase 'ArrowRight': {\r\n\t\t\t\t\tthis.handleChangeAudioIndex('next')\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t\t// 音量调大\r\n\t\t\t\tcase 'ArrowUp': {\r\n\t\t\t\t\tthis.volume = this.volume === 1 ? 1 : this.volume + 0.1\r\n\t\t\t\t\tthis.volume = Number(this.volume.toFixed(1))\r\n\t\t\t\t\tthis.handleChangeVolumeBar(this.volume)\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t\t// 音量调小\r\n\t\t\t\tcase 'ArrowDown': {\r\n\t\t\t\t\tthis.volume = this.volume === 0 ? 0 : this.volume - 0.1\r\n\t\t\t\t\tthis.volume = Number(this.volume.toFixed(1))\r\n\t\t\t\t\tthis.handleChangeVolumeBar(this.volume)\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t\t// 暂停/播放\r\n\t\t\t\tcase 'Space': {\r\n\t\t\t\t\tthis.handleChangeAudioIndex('manual', this.activeIndex)\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * 获取文件信息\r\n\t\t */\r\n\t\tgetFileDetailData() {\r\n\t\t\tthis.handleClickPauseIcon()\r\n\t\t\tthis.loading = true\r\n\t\t\tgetFileDetail({ userFileId: this.activeFileObj.userFileId })\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t\tif (res.success) {\r\n\t\t\t\t\t\tthis.audioInfo = {\r\n\t\t\t\t\t\t\t...res.data.music,\r\n\t\t\t\t\t\t\tduration: res.data.music.trackLength\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Base64 解码为 lrc 格式的歌词文件\r\n\t\t\t\t\t\tlet lyricsStr = Base64.decode(this.audioInfo.lyrics)\r\n\t\t\t\t\t\tif (lyricsStr.includes('[offset:0]')) {\r\n\t\t\t\t\t\t\t// 有歌词，从标志位 [offset:0] 下一行开始截取\r\n\t\t\t\t\t\t\tlyricsStr = lyricsStr.split('[offset:0]\\n')[1]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.lyricsList = lyricsStr\r\n\t\t\t\t\t\t\t.split('\\n')\r\n\t\t\t\t\t\t\t.map((item) => {\r\n\t\t\t\t\t\t\t\tconst line = item.split('[')[1].split(']')\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\ttime: line[0], //  当前行歌词开始播放的秒数\r\n\t\t\t\t\t\t\t\t\ttext: line[1] //  当前歌词文本\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.filter((item) => item.text !== '')\r\n\t\t\t\t\t\tthis.lyricsList = this.lyricsList.map((item, index) => {\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\t\t\t// 当前行歌词起始秒数\r\n\t\t\t\t\t\t\t\tstartSeconds: this.transferTimeToSeconds(item.time),\r\n\t\t\t\t\t\t\t\t// 当前行歌词结束秒数\r\n\t\t\t\t\t\t\t\tendSeconds:\r\n\t\t\t\t\t\t\t\t\tindex < this.lyricsList.length - 1\r\n\t\t\t\t\t\t\t\t\t\t? this.transferTimeToSeconds(\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.lyricsList[index + 1].time\r\n\t\t\t\t\t\t\t\t\t\t  )\r\n\t\t\t\t\t\t\t\t\t\t: this.audioInfo.duration\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// 当切换完歌曲时，歌词重新滚动到顶部\r\n\t\t\t\t\t\tthis.$refs.lyricsListRef.scrollTo({\r\n\t\t\t\t\t\t\ttop: 0,\r\n\t\t\t\t\t\t\tbehavior: 'smooth'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.currentLyricsLineIndex = 0\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(() => {\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t})\r\n\t\t},\r\n\t\t/**\r\n\t\t * 获取播放器参数\r\n\t\t */\r\n\t\thandleLoadedmetadata(event) {\r\n\t\t\tconst audioDom = event.target\r\n\t\t\tthis.volume = audioDom.volume || 0.5\r\n\t\t\tthis.currentTime = audioDom.currentTime\r\n\t\t\tthis.handleClickPlayIcon()\r\n\t\t},\r\n\t\t/**\r\n\t\t * 将秒转化为时分秒\r\n\t\t * @param {number} duration 总秒数\r\n\t\t */\r\n\t\ttransferSecondsToTime(duration) {\r\n\t\t\tconst hour = Math.floor(duration / 3600)\r\n\t\t\tconst minutes = Math.floor(duration / 60)\r\n\t\t\tconst seconds = Math.ceil(duration % 60)\r\n\t\t\treturn `${hour < 10 ? `0${hour}` : hour}:${\r\n\t\t\t\tminutes < 10 ? `0${minutes}` : minutes\r\n\t\t\t}:${seconds < 10 ? `0${seconds}` : seconds}`\r\n\t\t},\r\n\t\t/**\r\n\t\t * 将分秒转化为秒\r\n\t\t * @param {string} time 分秒，格式 00:00\r\n\t\t */\r\n\t\ttransferTimeToSeconds(time) {\r\n\t\t\tconst timeList = time.split('.')[0].split(':')\r\n\t\t\treturn Number(timeList[1]) + Number(timeList[0]) * 60\r\n\t\t},\r\n\t\t/**\r\n\t\t * 当前播放时间改变时触发\r\n\t\t */\r\n\t\thandleTimeUpdate(event) {\r\n\t\t\t// 如果正在拖拽进度滑块，函数结束，不计算当前时间\r\n\t\t\tif (this.isDrop) return\r\n\t\t\tthis.currentTime = event.target.currentTime\r\n\t\t\tif (this.lyricsList.length) {\r\n\t\t\t\t// 遍历歌词，当前秒对应的歌词整行添加高亮效果\r\n\t\t\t\tthis.lyricsList.forEach((item, index) => {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\titem.startSeconds <= this.currentTime &&\r\n\t\t\t\t\t\tthis.currentTime < item.endSeconds &&\r\n\t\t\t\t\t\tthis.currentLyricsLineIndex !== index\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\t// 确定高亮歌词行索引\r\n\t\t\t\t\t\tthis.currentLyricsLineIndex = index\r\n\t\t\t\t\t\t// 使高亮歌词行永远保持在第二行\r\n\t\t\t\t\t\tif (this.currentLyricsLineIndex > 2) {\r\n\t\t\t\t\t\t\t// 平滑滚动\r\n\t\t\t\t\t\t\tthis.$refs.lyricsListRef.scrollTo({\r\n\t\t\t\t\t\t\t\ttop: this.$refs.lyricsLineRef[index].clientHeight * (index - 2),\r\n\t\t\t\t\t\t\t\tbehavior: 'smooth'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * 拖动播放进度滑块触发\r\n\t\t */\r\n\t\thandleChangeProgress(progress) {\r\n\t\t\tthis.audioElement.currentTime = progress\r\n\t\t\tthis.isDrop = false\r\n\t\t},\r\n\t\t/**\r\n\t\t * 切换循环播放类型\r\n\t\t */\r\n\t\thandleChangeCycleType() {\r\n\t\t\tif (this.cycleType === 3) {\r\n\t\t\t\tthis.cycleType = 1\r\n\t\t\t} else if (this.cycleType >= 1) {\r\n\t\t\t\tthis.cycleType++\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * 点击播放图标触发\r\n\t\t * @description 开始播放音频\r\n\t\t */\r\n\t\thandleClickPlayIcon() {\r\n\t\t\tthis.isPlay = true\r\n\t\t\tthis.audioElement.play()\r\n\t\t},\r\n\t\t/**\r\n\t\t * 点击暂停图标触发\r\n\t\t * @description 暂停音频\r\n\t\t */\r\n\t\thandleClickPauseIcon() {\r\n\t\t\tthis.isPlay = false\r\n\t\t\tthis.audioElement.pause()\r\n\t\t},\r\n\t\t/**\r\n\t\t * 切换、暂停或播放歌曲\r\n\t\t * @param {string} type pre - 上一首 | next - 下一首 | manual 手动切换\r\n\t\t * @param {number} index 手动切换的音频索引，从 0 开始\r\n\t\t */\r\n\t\thandleChangeAudioIndex(type, index) {\r\n\t\t\t// 如果当前手动切换\r\n\t\t\tif (type === 'manual') {\r\n\t\t\t\tif (this.activeIndex === index) {\r\n\t\t\t\t\tif (this.isPlay) {\r\n\t\t\t\t\t\tthis.handleClickPauseIcon()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.handleClickPlayIcon()\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.activeIndex = index\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.handleClickPauseIcon()\r\n\t\t\t\t// 判断当前循环播放类型\r\n\t\t\t\tswitch (this.cycleType) {\r\n\t\t\t\t\tcase 3: {\r\n\t\t\t\t\t\tlet activeIndex = 0\r\n\t\t\t\t\t\tdo {\r\n\t\t\t\t\t\t\tactiveIndex =\r\n\t\t\t\t\t\t\t\tMath.floor(Math.random() * (this.audioList.length - 1)) + 1\r\n\t\t\t\t\t\t} while (this.activeIndex === activeIndex)\r\n\t\t\t\t\t\tthis.activeIndex = activeIndex\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdefault: {\r\n\t\t\t\t\t\tif (type === 'pre') {\r\n\t\t\t\t\t\t\tif (this.activeIndex === 0) {\r\n\t\t\t\t\t\t\t\tthis.activeIndex = this.audioList.length - 1\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.activeIndex--\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (type === 'next') {\r\n\t\t\t\t\t\t\tif (this.activeIndex === this.audioList.length - 1) {\r\n\t\t\t\t\t\t\t\tthis.activeIndex = 0\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.activeIndex++\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * 点击音量图标\r\n\t\t */\r\n\t\thandleClickVolumeIcon() {\r\n\t\t\tthis.volume = this.volume === 0 ? 0.5 : 0\r\n\t\t\tthis.handleChangeVolumeBar(this.volume)\r\n\t\t},\r\n\t\t/**\r\n\t\t * 音量滑块改变时触发\r\n\t\t */\r\n\t\thandleChangeVolumeBar(volume) {\r\n\t\t\tthis.audioElement.volume = Number(volume.toFixed(1))\r\n\t\t},\r\n\t\t// 关闭音频预览\r\n\t\thandleClosePreview() {\r\n\t\t\tthis.visible = false\r\n\t\t\tthis.callback('cancel')\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n/* ====== 主题变量（可按自己全局主题调整）====== */\r\n@PrimaryText: #14161a;         // 背景主色（比原来的 #303133 更偏音乐播放器风格）\r\n@BorderBase: #dcdfe6;\r\n@Warning: #e6a23c;             // 进度条 / 高亮橙色（保留原始语义）\r\n@TextPrimary: #f5f5f5;         // 主文字\r\n@TextSecondary: #a1a6b3;       // 次要文字\r\n@CardBg: rgba(18, 22, 34, 0.96);\r\n@CardBorder: rgba(255, 255, 255, 0.06);\r\n@BlurBg: rgba(10, 12, 20, 0.85);\r\n\r\n/* ====== 外层整体区域 ====== */\r\n.audio-preview-wrapper {\r\n  background: radial-gradient(circle at top left, #26293a 0, #14161a 40%, #050608 100%);\r\n  position: fixed;\r\n  inset: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  z-index: 100;\r\n  color: @TextPrimary;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n  overflow: hidden;\r\n\r\n  .audio-background {\r\n    position: fixed;\r\n    top: -40%;\r\n    left: -10%;\r\n    width: 120vw;\r\n    height: auto;\r\n    filter: blur(80px);\r\n    opacity: 0.55;\r\n    z-index: -1;\r\n    transform: scale(1.1);\r\n  }\r\n\r\n  /* 右上角操作按钮区域 */\r\n  .operate-box {\r\n    position: fixed;\r\n    top: 18px;\r\n    right: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    font-size: 14px;\r\n    color: @TextSecondary;\r\n\r\n    .tip-icon,\r\n    .close-icon {\r\n      margin-left: 16px;\r\n      cursor: pointer;\r\n      transition: color 0.25s ease, transform 0.25s ease, text-shadow 0.25s ease;\r\n\r\n      &:hover {\r\n        color: @Warning;\r\n        transform: translateY(-1px);\r\n        text-shadow: 0 0 8px fade(@Warning, 50%);\r\n      }\r\n    }\r\n\r\n    .tip-icon {\r\n      font-size: 24px;\r\n    }\r\n\r\n    .close-icon {\r\n      font-size: 28px;\r\n    }\r\n  }\r\n\r\n  /* ====== 中部内容区域：列表 + 封面 / 歌词 ====== */\r\n  .audio-list-wrapper {\r\n    margin: 72px auto 0;\r\n    width: 88%;\r\n    height: calc(100vh - 160px);\r\n    padding: 24px 26px 0;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    box-sizing: border-box;\r\n    border-radius: 24px 24px 18px 18px;\r\n    background: @BlurBg;\r\n    border: 1px solid @CardBorder;\r\n    box-shadow:\r\n      0 18px 45px rgba(0, 0, 0, 0.75),\r\n      0 0 0 1px rgba(255, 255, 255, 0.02);\r\n    backdrop-filter: blur(24px);\r\n\r\n    /* 左侧音频列表 */\r\n    .audio-list {\r\n      flex: 1;\r\n      list-style: none;\r\n      padding: 0;\r\n      margin: 0;\r\n      display: flex;\r\n      flex-direction: column;\r\n      color: @TextPrimary;\r\n\r\n      .audio-list-header,\r\n      .audio-item {\r\n        border-radius: 12px;\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        height: 56px;\r\n        cursor: pointer;\r\n        padding: 0 16px;\r\n        font-size: 13px;\r\n        transition:\r\n          background 0.2s ease,\r\n          transform 0.15s ease,\r\n          box-shadow 0.2s ease,\r\n          color 0.2s ease;\r\n      }\r\n\r\n      .audio-list-header {\r\n        margin-bottom: 4px;\r\n        background: rgba(255, 255, 255, 0.02);\r\n        border: 1px solid rgba(255, 255, 255, 0.04);\r\n        color: @TextSecondary;\r\n        padding-right: 24px;\r\n        font-size: 12px;\r\n        letter-spacing: 0.04em;\r\n\r\n        .name {\r\n          flex: 1;\r\n          padding-left: 18px;\r\n        }\r\n      }\r\n\r\n      .audio-list-body {\r\n        height: calc(100% - 56px);\r\n        overflow: auto;\r\n        padding-right: 6px;\r\n\r\n        /* 自定义滚动条，类似网易云窄滚动条 */\r\n        &::-webkit-scrollbar {\r\n          width: 6px;\r\n        }\r\n\r\n        &::-webkit-scrollbar-track {\r\n          background: transparent;\r\n        }\r\n\r\n        &::-webkit-scrollbar-thumb {\r\n          background: rgba(255, 255, 255, 0.15);\r\n          border-radius: 3px;\r\n        }\r\n\r\n        &::-webkit-scrollbar-thumb:hover {\r\n          background: rgba(255, 255, 255, 0.28);\r\n        }\r\n      }\r\n\r\n      .audio-item {\r\n        background: transparent;\r\n        color: @TextSecondary;\r\n        margin-bottom: 4px;\r\n\r\n        &:hover {\r\n          background: rgba(255, 255, 255, 0.04);\r\n          transform: translateY(-1px);\r\n          box-shadow: 0 6px 18px rgba(0, 0, 0, 0.45);\r\n          color: @TextPrimary;\r\n        }\r\n\r\n        &.active {\r\n          background: radial-gradient(circle at left, fade(@Warning, 35%) 0, rgba(255, 255, 255, 0.06) 32%, transparent 70%);\r\n          color: @Warning;\r\n          box-shadow:\r\n            0 0 16px fade(@Warning, 24%),\r\n            0 10px 28px rgba(0, 0, 0, 0.6);\r\n        }\r\n\r\n        .name {\r\n          flex: 1;\r\n          display: flex;\r\n          align-items: center;\r\n          overflow: hidden;\r\n          white-space: nowrap;\r\n          text-overflow: ellipsis;\r\n\r\n          .sequence {\r\n            display: inline-block;\r\n            margin-right: 8px;\r\n            width: 18px;\r\n            text-align: center;\r\n            font-size: 12px;\r\n            opacity: 0.7;\r\n          }\r\n\r\n          .wave {\r\n            margin-right: 8px;\r\n            width: 14px;\r\n            height: 14px;\r\n          }\r\n\r\n          .no-wave {\r\n            margin-right: 8px;\r\n            font-size: 16px;\r\n          }\r\n\r\n          .text {\r\n            max-width: 260px;\r\n            overflow: hidden;\r\n            white-space: nowrap;\r\n            text-overflow: ellipsis;\r\n          }\r\n        }\r\n\r\n        .play-icon,\r\n        .pause-icon,\r\n        .download-icon,\r\n        .share-icon {\r\n          margin-right: 12px;\r\n          font-size: 20px;\r\n          cursor: pointer;\r\n          transition: color 0.25s ease, transform 0.15s ease;\r\n          opacity: 0.88;\r\n\r\n          &:hover {\r\n            color: @Warning;\r\n            transform: translateY(-1px);\r\n          }\r\n        }\r\n\r\n        .download {\r\n          color: inherit;\r\n          text-decoration: none;\r\n\r\n          &:hover {\r\n            color: @Warning;\r\n          }\r\n        }\r\n\r\n        .audio-size {\r\n          width: 110px;\r\n          padding-right: 18px;\r\n          text-align: right;\r\n          font-variant-numeric: tabular-nums;\r\n        }\r\n\r\n        .path {\r\n          min-width: 120px;\r\n          font-size: 12px;\r\n          color: @TextSecondary;\r\n          opacity: 0.85;\r\n        }\r\n      }\r\n    }\r\n\r\n    /* 右侧封面 + 歌词区域 */\r\n    .img-and-lyrics {\r\n      padding: 6px 0 0 24px;\r\n      width: 360px;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      text-align: center;\r\n      box-sizing: border-box;\r\n      border-left: 1px solid rgba(255, 255, 255, 0.04);\r\n\r\n      .audio-img {\r\n        margin-bottom: 18px;\r\n        width: 180px;\r\n        height: 180px;\r\n        border-radius: 16px;\r\n        object-fit: cover;\r\n        box-shadow:\r\n          0 18px 45px rgba(0, 0, 0, 0.9),\r\n          0 0 0 1px rgba(255, 255, 255, 0.04);\r\n      }\r\n\r\n      .audio-name {\r\n        margin-bottom: 6px;\r\n        font-size: 18px;\r\n        line-height: 1.8;\r\n        font-weight: 600;\r\n        letter-spacing: 0.02em;\r\n      }\r\n\r\n      .album-artist,\r\n      .album-name {\r\n        margin-bottom: 4px;\r\n        font-size: 13px;\r\n        color: @TextSecondary;\r\n      }\r\n\r\n      .lyrics-list {\r\n        width: 100%;\r\n        flex: 1;\r\n        margin-top: 12px;\r\n        padding: 8px 6px 6px;\r\n        overflow: auto;\r\n        list-style: none;\r\n        box-sizing: border-box;\r\n        border-radius: 12px;\r\n        background: rgba(0, 0, 0, 0.18);\r\n        position: relative;\r\n\r\n        /* 渐隐遮罩，保持中间区域歌词最清晰 */\r\n        -webkit-mask-image: linear-gradient(\r\n          180deg,\r\n          rgba(255, 255, 255, 0) 0,\r\n          rgba(255, 255, 255, 0.6) 15%,\r\n          #fff 25%,\r\n          #fff 75%,\r\n          rgba(255, 255, 255, 0.6) 85%,\r\n          rgba(255, 255, 255, 0) 100%\r\n        );\r\n\r\n        &::-webkit-scrollbar {\r\n          width: 4px;\r\n        }\r\n\r\n        &::-webkit-scrollbar-track {\r\n          background: transparent;\r\n        }\r\n\r\n        &::-webkit-scrollbar-thumb {\r\n          background: rgba(255, 255, 255, 0.18);\r\n          border-radius: 3px;\r\n        }\r\n\r\n        &.one {\r\n          .lyrics-item {\r\n            margin-top: 40px;\r\n          }\r\n        }\r\n\r\n        .lyrics-item {\r\n          line-height: 32px;\r\n          cursor: pointer;\r\n          font-size: 13px;\r\n          color: @TextSecondary;\r\n          transition: color 0.25s ease, transform 0.18s ease, text-shadow 0.25s ease;\r\n\r\n          &:not(.active):hover {\r\n            color: #ffffff;\r\n            transform: translateY(-1px);\r\n          }\r\n\r\n          &.active {\r\n            color: @Warning;\r\n            font-size: 14px;\r\n            text-shadow: 0 0 12px fade(@Warning, 40%);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /* ====== 底部控制区域 ====== */\r\n  .control-wrapper {\r\n    margin: 0 auto;\r\n    width: 88%;\r\n    height: 120px;\r\n    padding: 18px 24px 26px;\r\n    box-sizing: border-box;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    font-size: 13px;\r\n    color: @TextSecondary;\r\n\r\n    .control-left {\r\n      flex: 1;\r\n      height: 100%;\r\n      display: flex;\r\n      align-items: center;\r\n      text-align: center;\r\n      padding-left: 4px;\r\n\r\n      .operate-icon {\r\n        margin-right: 18px;\r\n        font-size: 34px;\r\n        cursor: pointer;\r\n        transition: color 0.25s ease, transform 0.2s ease, text-shadow 0.25s ease;\r\n\r\n        &:hover {\r\n          color: @Warning;\r\n          transform: translateY(-1px) scale(1.03);\r\n          text-shadow: 0 0 10px fade(@Warning, 35%);\r\n        }\r\n      }\r\n\r\n      .play-icon {\r\n        font-size: 40px;\r\n      }\r\n\r\n      .progress-bar {\r\n        margin-right: 18px;\r\n        flex: 1;\r\n\r\n        /* 深度选择 ElementUI Slider */\r\n        ::v-deep .el-slider__runway {\r\n          height: 2px;\r\n          background: rgba(255, 255, 255, 0.08);\r\n          border-radius: 999px;\r\n\r\n          .el-slider__button-wrapper {\r\n            top: -16px;\r\n\r\n            .el-slider__button {\r\n              border: none;\r\n              width: 12px;\r\n              height: 12px;\r\n              box-shadow: 0 0 0 4px rgba(230, 162, 60, 0.18);\r\n            }\r\n          }\r\n\r\n          .el-slider__bar {\r\n            height: 100%;\r\n            background: linear-gradient(90deg, @Warning 0%, #ffd08a 60%, #ffffff 100%);\r\n          }\r\n        }\r\n      }\r\n\r\n      .time {\r\n        min-width: 155px;\r\n        text-align: right;\r\n        font-variant-numeric: tabular-nums;\r\n      }\r\n    }\r\n\r\n    .control-right {\r\n      width: 340px;\r\n      display: flex;\r\n      justify-content: flex-end;\r\n      align-items: center;\r\n      font-size: 28px;\r\n\r\n      .operate-icon {\r\n        margin-right: 16px;\r\n        cursor: pointer;\r\n        transition: color 0.25s ease, transform 0.18s ease;\r\n\r\n        &:hover {\r\n          color: @Warning;\r\n          transform: translateY(-1px);\r\n        }\r\n\r\n        &.download-link {\r\n          font-size: 26px;\r\n          color: inherit;\r\n          text-decoration: none;\r\n\r\n          .download-icon {\r\n            font-size: 24px;\r\n          }\r\n\r\n          &:hover {\r\n            .download-icon {\r\n              color: @Warning;\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      .cycle-type {\r\n        font-size: 24px;\r\n      }\r\n\r\n      .share-icon {\r\n        font-size: 24px;\r\n      }\r\n\r\n      .volume-icon {\r\n        margin-right: 8px;\r\n        font-size: 24px;\r\n      }\r\n\r\n      .volume-bar {\r\n        width: 110px;\r\n\r\n        ::v-deep .el-slider__runway {\r\n          height: 2px;\r\n          background: rgba(255, 255, 255, 0.12);\r\n          border-radius: 999px;\r\n\r\n          .el-slider__button-wrapper {\r\n            top: -18px;\r\n\r\n            .el-slider__button {\r\n              border: none;\r\n              width: 10px;\r\n              height: 10px;\r\n            }\r\n          }\r\n\r\n          .el-slider__bar {\r\n            height: 100%;\r\n            background: @Warning;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}