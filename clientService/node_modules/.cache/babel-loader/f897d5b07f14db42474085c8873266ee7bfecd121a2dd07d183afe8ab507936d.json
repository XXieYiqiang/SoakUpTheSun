{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _file = require(\"@/api/file.js\");\nvar _default = exports.default = {\n  name: 'AddFolderDialog',\n  data() {\n    const validateFileName = (rule, value, callback) => {\n      const fileNameReg = new RegExp(`[\\\\\\\\/:*?\"<>|]`);\n      if (value && fileNameReg.test(value)) {\n        callback(new Error(`文件夹名称不能包含下列任何字符：\\\\/:*?\"<>|`));\n      } else {\n        callback();\n      }\n    };\n    return {\n      visible: false,\n      //  对话框是否可见\n      form: {\n        fileName: ''\n      },\n      formRules: {\n        fileName: [{\n          required: true,\n          message: '请输入文件夹名称',\n          trigger: 'blur'\n        }, {\n          validator: validateFileName,\n          trigger: ['blur', 'change']\n        }]\n      },\n      sureBtnLoading: false\n    };\n  },\n  watch: {\n    /**\r\n     * 监听对话框打开、关闭状态\r\n     */\n    visible(newValue) {\n      if (newValue) {\n        // 打开时绑定回车事件\n        document.addEventListener('keyup', this.handleAddKeyupEnter);\n      } else {\n        // 关闭时移除回车事件\n        document.removeEventListener('keyup', this.handleAddKeyupEnter);\n      }\n    }\n  },\n  methods: {\n    /**\r\n     * DOM 绑定回车事件\r\n     * @description 回车触发新增文件夹事件\r\n     * @param {event} event 事件\r\n     */\n    handleAddKeyupEnter(event) {\n      if (event.key === 'Enter') {\n        this.handleDialogSure('addFolderForm');\n      }\n    },\n    /**\r\n     * 取消按钮点击事件 & 对话框关闭的回调\r\n     * @description 关闭对话框，重置表单\r\n     */\n    handleDialogClose() {\n      this.$refs['addFolderForm'].resetFields();\n      this.visible = false;\n      this.callback('cancel');\n    },\n    /**\r\n     * 确定按钮点击事件\r\n     * @description 校验表单，校验通过后调用新建文件夹接口\r\n     * @param {string} formName 表单ref值\r\n     */\n    handleDialogSure(formName) {\n      console.log('创建文件夹');\n      this.sureBtnLoading = true;\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          (0, _file.createFold)({\n            fileName: this.form.fileName,\n            filePath: this.filePath\n          }).then(res => {\n            this.sureBtnLoading = false;\n            console.log('res=====');\n            console.log(res);\n            if (res.data.code === 200) {\n              this.$message.success('文件夹创建成功');\n              this.$refs[formName].resetFields();\n              this.visible = false;\n              this.callback('confirm');\n            } else {\n              this.$message.warning(res.message);\n            }\n          }).catch(() => {\n            this.sureBtnLoading = false;\n          });\n        } else {\n          this.sureBtnLoading = false;\n          return false;\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["_file","require","_default","exports","default","name","data","validateFileName","rule","value","callback","fileNameReg","RegExp","test","Error","visible","form","fileName","formRules","required","message","trigger","validator","sureBtnLoading","watch","newValue","document","addEventListener","handleAddKeyupEnter","removeEventListener","methods","event","key","handleDialogSure","handleDialogClose","$refs","resetFields","formName","console","log","validate","valid","createFold","filePath","then","res","code","$message","success","warning","catch"],"sources":["src/components/file/dialog/addFolder/Dialog.vue"],"sourcesContent":["<template>\r\n\t<!-- 新建文件夹对话框 -->\r\n\t<el-dialog\r\n\t\ttitle=\"新建文件夹\"\r\n\t\t:visible.sync=\"visible\"\r\n\t\t:close-on-click-modal=\"false\"\r\n\t\twidth=\"580px\"\r\n\t\t@close=\"handleDialogClose\"\r\n\t>\r\n\t\t<el-form\r\n\t\t\tclass=\"add-folder-form\"\r\n\t\t\t:model=\"form\"\r\n\t\t\t:rules=\"formRules\"\r\n\t\t\tref=\"addFolderForm\"\r\n\t\t\tlabel-width=\"100px\"\r\n\t\t\tlabel-position=\"top\"\r\n\t\t>\r\n\t\t\t<el-form-item label=\"文件夹名称\" prop=\"fileName\">\r\n\t\t\t\t<el-input\r\n\t\t\t\t\tv-model=\"form.fileName\"\r\n\t\t\t\t\tplaceholder=\"请输入文件夹名称\"\r\n\t\t\t\t\ttype=\"textarea\"\r\n\t\t\t\t\t:autosize=\"{ minRows: 3, maxRows: 3 }\"\r\n\t\t\t\t\tmaxlength=\"255\"\r\n\t\t\t\t\tshow-word-limit\r\n\t\t\t\t\t@keydown.enter.native.prevent\r\n\t\t\t\t></el-input>\r\n\t\t\t</el-form-item>\r\n\t\t</el-form>\r\n\t\t<div slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t<el-button @click=\"handleDialogClose\">取 消</el-button>\r\n\t\t\t<el-button\r\n\t\t\t\ttype=\"primary\"\r\n\t\t\t\t:loading=\"sureBtnLoading\"\r\n\t\t\t\t@click=\"handleDialogSure('addFolderForm')\"\r\n\t\t\t\t>确 定</el-button\r\n\t\t\t>\r\n\t\t</div>\r\n\t</el-dialog>\r\n</template>\r\n\r\n<script>\r\nimport { createFold } from '@/api/file.js'\r\n\r\nexport default {\r\n\tname: 'AddFolderDialog',\r\n\tdata() {\r\n\t\tconst validateFileName = (rule, value, callback) => {\r\n\t\t\tconst fileNameReg = new RegExp(`[\\\\\\\\/:*?\"<>|]`)\r\n\t\t\tif (value && fileNameReg.test(value)) {\r\n\t\t\t\tcallback(new Error(`文件夹名称不能包含下列任何字符：\\\\/:*?\"<>|`))\r\n\t\t\t} else {\r\n\t\t\t\tcallback()\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tvisible: false, //  对话框是否可见\r\n\t\t\tform: {\r\n\t\t\t\tfileName: ''\r\n\t\t\t},\r\n\t\t\tformRules: {\r\n\t\t\t\tfileName: [\r\n\t\t\t\t\t{ required: true, message: '请输入文件夹名称', trigger: 'blur' },\r\n\t\t\t\t\t{ validator: validateFileName, trigger: ['blur', 'change'] }\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tsureBtnLoading: false\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\t/**\r\n\t\t * 监听对话框打开、关闭状态\r\n\t\t */\r\n\t\tvisible(newValue) {\r\n\t\t\tif (newValue) {\r\n\t\t\t\t// 打开时绑定回车事件\r\n\t\t\t\tdocument.addEventListener('keyup', this.handleAddKeyupEnter)\r\n\t\t\t} else {\r\n\t\t\t\t// 关闭时移除回车事件\r\n\t\t\t\tdocument.removeEventListener('keyup', this.handleAddKeyupEnter)\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * DOM 绑定回车事件\r\n\t\t * @description 回车触发新增文件夹事件\r\n\t\t * @param {event} event 事件\r\n\t\t */\r\n\t\thandleAddKeyupEnter(event) {\r\n\t\t\tif (event.key === 'Enter') {\r\n\t\t\t\tthis.handleDialogSure('addFolderForm')\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * 取消按钮点击事件 & 对话框关闭的回调\r\n\t\t * @description 关闭对话框，重置表单\r\n\t\t */\r\n\t\thandleDialogClose() {\r\n\t\t\tthis.$refs['addFolderForm'].resetFields()\r\n\t\t\tthis.visible = false\r\n\t\t\tthis.callback('cancel')\r\n\t\t},\r\n\t\t/**\r\n\t\t * 确定按钮点击事件\r\n\t\t * @description 校验表单，校验通过后调用新建文件夹接口\r\n\t\t * @param {string} formName 表单ref值\r\n\t\t */\r\n\t\thandleDialogSure(formName) {\r\n\t\t\tconsole.log('创建文件夹')\r\n\t\t\tthis.sureBtnLoading = true\r\n\t\t\tthis.$refs[formName].validate((valid) => {\r\n\t\t\t\tif (valid) {\r\n\t\t\t\t\tcreateFold({\r\n\t\t\t\t\t\tfileName: this.form.fileName,\r\n\t\t\t\t\t\tfilePath: this.filePath\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\t\tthis.sureBtnLoading = false\r\n\t\t\t\t\t\t\tconsole.log('res=====')\r\n\t\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t\tif (res.data.code === 200) {\r\n\t\t\t\t\t\t\t\tthis.$message.success('文件夹创建成功')\r\n\t\t\t\t\t\t\t\tthis.$refs[formName].resetFields()\r\n\t\t\t\t\t\t\t\tthis.visible = false\r\n\t\t\t\t\t\t\t\tthis.callback('confirm')\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.$message.warning(res.message)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch(() => {\r\n\t\t\t\t\t\t\tthis.sureBtnLoading = false\r\n\t\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.sureBtnLoading = false\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n"],"mappings":";;;;;;AA0CA,IAAAA,KAAA,GAAAC,OAAA;AAAA,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEA;EACAC,IAAA;EACAC,KAAA;IACA,MAAAC,gBAAA,GAAAA,CAAAC,IAAA,EAAAC,KAAA,EAAAC,QAAA;MACA,MAAAC,WAAA,OAAAC,MAAA;MACA,IAAAH,KAAA,IAAAE,WAAA,CAAAE,IAAA,CAAAJ,KAAA;QACAC,QAAA,KAAAI,KAAA;MACA;QACAJ,QAAA;MACA;IACA;IACA;MACAK,OAAA;MAAA;MACAC,IAAA;QACAC,QAAA;MACA;MACAC,SAAA;QACAD,QAAA,GACA;UAAAE,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAC,SAAA,EAAAf,gBAAA;UAAAc,OAAA;QAAA;MAEA;MACAE,cAAA;IACA;EACA;EACAC,KAAA;IACA;AACA;AACA;IACAT,QAAAU,QAAA;MACA,IAAAA,QAAA;QACA;QACAC,QAAA,CAAAC,gBAAA,eAAAC,mBAAA;MACA;QACA;QACAF,QAAA,CAAAG,mBAAA,eAAAD,mBAAA;MACA;IACA;EACA;EACAE,OAAA;IACA;AACA;AACA;AACA;AACA;IACAF,oBAAAG,KAAA;MACA,IAAAA,KAAA,CAAAC,GAAA;QACA,KAAAC,gBAAA;MACA;IACA;IACA;AACA;AACA;AACA;IACAC,kBAAA;MACA,KAAAC,KAAA,kBAAAC,WAAA;MACA,KAAArB,OAAA;MACA,KAAAL,QAAA;IACA;IACA;AACA;AACA;AACA;AACA;IACAuB,iBAAAI,QAAA;MACAC,OAAA,CAAAC,GAAA;MACA,KAAAhB,cAAA;MACA,KAAAY,KAAA,CAAAE,QAAA,EAAAG,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACA,IAAAC,gBAAA;YACAzB,QAAA,OAAAD,IAAA,CAAAC,QAAA;YACA0B,QAAA,OAAAA;UACA,GACAC,IAAA,CAAAC,GAAA;YACA,KAAAtB,cAAA;YACAe,OAAA,CAAAC,GAAA;YACAD,OAAA,CAAAC,GAAA,CAAAM,GAAA;YACA,IAAAA,GAAA,CAAAvC,IAAA,CAAAwC,IAAA;cACA,KAAAC,QAAA,CAAAC,OAAA;cACA,KAAAb,KAAA,CAAAE,QAAA,EAAAD,WAAA;cACA,KAAArB,OAAA;cACA,KAAAL,QAAA;YACA;cACA,KAAAqC,QAAA,CAAAE,OAAA,CAAAJ,GAAA,CAAAzB,OAAA;YACA;UACA,GACA8B,KAAA;YACA,KAAA3B,cAAA;UACA;QACA;UACA,KAAAA,cAAA;UACA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}