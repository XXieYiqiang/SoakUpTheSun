{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.filter.js\");\nrequire(\"core-js/modules/es.iterator.map.js\");\nvar _vuex = require(\"vuex\");\nvar _default = exports.default = {\n  name: 'FileGrid',\n  props: {\n    // 文件类型\n    fileType: {\n      required: true,\n      type: Number\n    },\n    // 文件路径\n    filePath: {\n      required: true,\n      type: String\n    },\n    fileList: Array,\n    //  文件列表\n    loading: Boolean\n  },\n  data() {\n    return {\n      fileListSorted: [],\n      officeFileType: ['ppt', 'pptx', 'doc', 'docx', 'xls', 'xlsx'],\n      selectedFile: {}\n    };\n  },\n  computed: {\n    /**\r\n     * gridSize: 图标大小\r\n     *  */\n    ...(0, _vuex.mapGetters)(['gridSize']),\n    // 是否批量操作\n    isBatchOperation() {\n      return this.$store.state.fileList.isBatchOperation;\n    },\n    // 批量操作模式 - 被选中的文件\n    selectedFileList() {\n      let res = this.fileListSorted.filter(item => item.checked);\n      return res;\n    },\n    // 屏幕宽度\n    screenWidth() {\n      return this.$store.state.common.screenWidth;\n    }\n  },\n  watch: {\n    // 文件平铺模式 排序-文件夹在前\n    fileList(newValue) {\n      this.fileListSorted = [...newValue].sort((pre, next) => {\n        return next.isDir - pre.isDir;\n      }).map(item => {\n        return {\n          ...item,\n          checked: false\n        };\n      });\n    },\n    // 批量操作模式 - 监听被选中的文件\n    selectedFileList(newValue) {\n      this.$store.commit('changeSelectedFiles', newValue);\n      this.$store.commit('changeIsBatchOperation', newValue.length !== 0);\n    }\n  },\n  methods: {\n    /**\r\n     * 文件鼠标右键事件\r\n     * @param {object} item 文件信息\r\n     * @param {number} index 文件索引\r\n     * @param {object} event 鼠标事件信息\r\n     */\n    handleContextMenu(item, index, event) {\n      // 阻止右键事件冒泡\n      event.cancelBubble = true;\n      // xs 以上的屏幕\n      if (this.screenWidth > 768) {\n        this.selectedFile = item;\n        if (!this.isBatchOperation) {\n          event.preventDefault();\n          this.$openBox.contextMenu({\n            selectedFile: item,\n            domEvent: event\n          }).then(res => {\n            this.selectedFile = {};\n            if (res === 'confirm') {\n              this.$emit('getTableDataByType'); //  刷新文件列表\n              this.$store.dispatch('showStorage'); //  刷新存储容量\n            }\n          });\n        }\n      }\n    },\n    /**\r\n     * 更多图标点击事件\r\n     * @description 打开右键菜单\r\n     * @param {object} item 当前行数据\r\n     * @param {object} event 当前右键元素\r\n     */\n    handleClickMore(item, event) {\n      this.selectedFile = item;\n      if (!this.isBatchOperation) {\n        event.preventDefault();\n        this.$openBox.contextMenu({\n          selectedFile: item,\n          domEvent: event\n        }).then(res => {\n          this.selectedFile = {};\n          if (res === 'confirm') {\n            this.$emit('getTableDataByType'); //  刷新文件列表\n            this.$store.dispatch('showStorage'); //  刷新存储容量\n          }\n        });\n      }\n    }\n  }\n};","map":{"version":3,"names":["_vuex","require","_default","exports","default","name","props","fileType","required","type","Number","filePath","String","fileList","Array","loading","Boolean","data","fileListSorted","officeFileType","selectedFile","computed","mapGetters","isBatchOperation","$store","state","selectedFileList","res","filter","item","checked","screenWidth","common","watch","newValue","sort","pre","next","isDir","map","commit","length","methods","handleContextMenu","index","event","cancelBubble","preventDefault","$openBox","contextMenu","domEvent","then","$emit","dispatch","handleClickMore"],"sources":["src/components/file/components/FileGrid.vue"],"sourcesContent":["<template>\r\n\t<!-- 文件平铺 -->\r\n\t<div class=\"file-grid-wrapper\">\r\n\t\t<ul\r\n\t\t\tclass=\"file-list\"\r\n\t\t\tv-loading=\"loading\"\r\n\t\t\telement-loading-text=\"文件加载中……\"\r\n\t\t>\r\n\t\t\t<li\r\n\t\t\t\tclass=\"file-item\"\r\n\t\t\t\tv-for=\"(item, index) in fileListSorted\"\r\n\t\t\t\t:key=\"index\"\r\n\t\t\t\t:title=\"$file.getFileNameComplete(item)\"\r\n\t\t\t\t:style=\"`width: ${gridSize + 40}px; `\"\r\n\t\t\t\t:class=\"item.userFileId === selectedFile.userFileId ? 'active' : ''\"\r\n\t\t\t\t@click=\"$file.handleFileNameClick(item, index, fileListSorted)\"\r\n\t\t\t\t@contextmenu.prevent=\"handleContextMenu(item, index, $event)\"\r\n\t\t\t>\r\n\t\t\t\t<video\r\n\t\t\t\t\t:style=\"`height:${gridSize}px; width:${gridSize}px`\"\r\n\t\t\t\t\tv-if=\"$file.isVideoFile(item)\"\r\n\t\t\t\t\t:src=\"$file.setFileImg(item)\"\r\n\t\t\t\t></video>\r\n\t\t\t\t<el-image\r\n\t\t\t\t\tclass=\"file-img\"\r\n\t\t\t\t\t:src=\"$file.setFileImg(item)\"\r\n\t\t\t\t\t:style=\"`width: ${gridSize}px; height: ${gridSize}px;`\"\r\n\t\t\t\t\tfit=\"cover\"\r\n\t\t\t\t\tv-else\r\n\t\t\t\t/>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"file-name\"\r\n\t\t\t\t\tv-html=\"$file.getFileNameComplete(item, true)\"\r\n\t\t\t\t></div>\r\n\t\t\t\t<i\r\n\t\t\t\t\tclass=\"file-operate el-icon-more\"\r\n\t\t\t\t\t:class=\"`operate-more-${index}`\"\r\n\t\t\t\t\tv-if=\"screenWidth <= 768\"\r\n\t\t\t\t\t@click.stop=\"handleClickMore(item, $event)\"\r\n\t\t\t\t></i>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"file-checked-wrapper\"\r\n\t\t\t\t\t:class=\"{ checked: item.checked }\"\r\n\t\t\t\t\tv-show=\"isBatchOperation\"\r\n\t\t\t\t\t@click.stop.self=\"item.checked = !item.checked\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<el-checkbox\r\n\t\t\t\t\t\tclass=\"file-checked\"\r\n\t\t\t\t\t\tv-model=\"item.checked\"\r\n\t\t\t\t\t\t@click.stop=\"item.checked = !item.checked\"\r\n\t\t\t\t\t></el-checkbox>\r\n\t\t\t\t</div>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\n\r\nexport default {\r\n\tname: 'FileGrid',\r\n\tprops: {\r\n\t\t// 文件类型\r\n\t\tfileType: {\r\n\t\t\trequired: true,\r\n\t\t\ttype: Number\r\n\t\t},\r\n\t\t// 文件路径\r\n\t\tfilePath: {\r\n\t\t\trequired: true,\r\n\t\t\ttype: String\r\n\t\t},\r\n\t\tfileList: Array, //  文件列表\r\n\t\tloading: Boolean\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tfileListSorted: [],\r\n\t\t\tofficeFileType: ['ppt', 'pptx', 'doc', 'docx', 'xls', 'xlsx'],\r\n\t\t\tselectedFile: {}\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t/**\r\n\t\t * gridSize: 图标大小\r\n\t\t *  */\r\n\t\t...mapGetters(['gridSize']),\r\n\t\t// 是否批量操作\r\n\t\tisBatchOperation() {\r\n\t\t\treturn this.$store.state.fileList.isBatchOperation\r\n\t\t},\r\n\t\t// 批量操作模式 - 被选中的文件\r\n\t\tselectedFileList() {\r\n\t\t\tlet res = this.fileListSorted.filter((item) => item.checked)\r\n\t\t\treturn res\r\n\t\t},\r\n\t\t// 屏幕宽度\r\n\t\tscreenWidth() {\r\n\t\t\treturn this.$store.state.common.screenWidth\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\t// 文件平铺模式 排序-文件夹在前\r\n\t\tfileList(newValue) {\r\n\t\t\tthis.fileListSorted = [...newValue]\r\n\t\t\t\t.sort((pre, next) => {\r\n\t\t\t\t\treturn next.isDir - pre.isDir\r\n\t\t\t\t})\r\n\t\t\t\t.map((item) => {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\tchecked: false\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t},\r\n\t\t// 批量操作模式 - 监听被选中的文件\r\n\t\tselectedFileList(newValue) {\r\n\t\t\tthis.$store.commit('changeSelectedFiles', newValue)\r\n\t\t\tthis.$store.commit('changeIsBatchOperation', newValue.length !== 0)\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 文件鼠标右键事件\r\n\t\t * @param {object} item 文件信息\r\n\t\t * @param {number} index 文件索引\r\n\t\t * @param {object} event 鼠标事件信息\r\n\t\t */\r\n\t\thandleContextMenu(item, index, event) {\r\n\t\t\t// 阻止右键事件冒泡\r\n\t\t\tevent.cancelBubble = true\r\n\t\t\t// xs 以上的屏幕\r\n\t\t\tif (this.screenWidth > 768) {\r\n\t\t\t\tthis.selectedFile = item\r\n\t\t\t\tif (!this.isBatchOperation) {\r\n\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\tthis.$openBox\r\n\t\t\t\t\t\t.contextMenu({\r\n\t\t\t\t\t\t\tselectedFile: item,\r\n\t\t\t\t\t\t\tdomEvent: event\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\t\tthis.selectedFile = {}\r\n\t\t\t\t\t\t\tif (res === 'confirm') {\r\n\t\t\t\t\t\t\t\tthis.$emit('getTableDataByType') //  刷新文件列表\r\n\t\t\t\t\t\t\t\tthis.$store.dispatch('showStorage') //  刷新存储容量\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * 更多图标点击事件\r\n\t\t * @description 打开右键菜单\r\n\t\t * @param {object} item 当前行数据\r\n\t\t * @param {object} event 当前右键元素\r\n\t\t */\r\n\t\thandleClickMore(item, event) {\r\n\t\t\tthis.selectedFile = item\r\n\t\t\tif (!this.isBatchOperation) {\r\n\t\t\t\tevent.preventDefault()\r\n\t\t\t\tthis.$openBox\r\n\t\t\t\t\t.contextMenu({\r\n\t\t\t\t\t\tselectedFile: item,\r\n\t\t\t\t\t\tdomEvent: event\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tthis.selectedFile = {}\r\n\t\t\t\t\t\tif (res === 'confirm') {\r\n\t\t\t\t\t\t\tthis.$emit('getTableDataByType') //  刷新文件列表\r\n\t\t\t\t\t\t\tthis.$store.dispatch('showStorage') //  刷新存储容量\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n@import '~_a/styles/varibles.styl';\r\n@import '~_a/styles/mixins.styl';\r\n\r\n.file-grid-wrapper {\r\n  border-top: 1px solid $BorderBase;\r\n\r\n  .file-list {\r\n    height: 45vh;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    align-items: flex-start;\r\n    align-content: flex-start;\r\n    list-style: none;\r\n    setScrollbar(6px, transparent, #C0C4CC);\r\n\r\n    .file-item {\r\n      margin: 0 16px 16px 0;\r\n      position: relative;\r\n      padding: 8px;\r\n      text-align: center;\r\n      cursor: pointer;\r\n      z-index: 1;\r\n\r\n      &:hover {\r\n        background: $tabBackColor;\r\n\r\n        .file-name {\r\n          font-weight: 550;\r\n        }\r\n      }\r\n\r\n      .file-name {\r\n        margin-top: 8px;\r\n        height: 44px;\r\n        line-height: 22px;\r\n        font-size: 12px;\r\n        word-break: break-all;\r\n        setEllipsis(2);\r\n        >>> .keyword {\r\n          color: $Danger;\r\n        }\r\n      }\r\n\r\n      .file-checked-wrapper {\r\n        position: absolute;\r\n        top: 0;\r\n        left: 0;\r\n        z-index: 2;\r\n        background: rgba(245, 247, 250, 0.5);\r\n        width: 100%;\r\n        height: 100%;\r\n\r\n        .file-checked {\r\n          position: absolute;\r\n          top: 16px;\r\n          left: 24px;\r\n        }\r\n      }\r\n\r\n      .file-checked-wrapper.checked {\r\n        background: rgba(245, 247, 250, 0);\r\n      }\r\n    }\r\n    .file-item.active {\r\n      background: $tabBackColor;\r\n    }\r\n  }\r\n\r\n  .right-menu-list {\r\n    position: fixed;\r\n    display: flex;\r\n    flex-direction: column;\r\n    background: #fff;\r\n    border: 1px solid $BorderLighter;\r\n    border-radius: 4px;\r\n    box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\r\n    z-index: 2;\r\n    padding: 4px 0;\r\n    color: $RegularText;\r\n\r\n    .right-menu-item,\r\n    .unzip-item {\r\n      padding: 0 16px;\r\n      height: 36px;\r\n      line-height: 36px;\r\n      cursor: pointer;\r\n      &:hover {\r\n        background: $PrimaryHover;\r\n        color: $Primary;\r\n      }\r\n      i {\r\n        margin-right: 8px;\r\n      }\r\n    }\r\n\r\n    .unzip-menu-item {\r\n      position: relative;\r\n      &:hover {\r\n        .unzip-list {\r\n          display: block;\r\n        }\r\n      }\r\n      .unzip-list {\r\n        position: absolute;\r\n        display: none;\r\n        .unzip-item {\r\n          width: 200px;\r\n          setEllipsis(1)\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .right-menu-list,\r\n  .unzip-list {\r\n    background: #fff;\r\n    border: 1px solid $BorderLighter;\r\n    border-radius: 4px;\r\n    box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\r\n    z-index: 2;\r\n    padding: 4px 0;\r\n    color: $RegularText;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":";;;;;;;;;AA0DA,IAAAA,KAAA,GAAAC,OAAA;AAAA,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEA;EACAC,IAAA;EACAC,KAAA;IACA;IACAC,QAAA;MACAC,QAAA;MACAC,IAAA,EAAAC;IACA;IACA;IACAC,QAAA;MACAH,QAAA;MACAC,IAAA,EAAAG;IACA;IACAC,QAAA,EAAAC,KAAA;IAAA;IACAC,OAAA,EAAAC;EACA;EACAC,KAAA;IACA;MACAC,cAAA;MACAC,cAAA;MACAC,YAAA;IACA;EACA;EACAC,QAAA;IACA;AACA;AACA;IACA,OAAAC,gBAAA;IACA;IACAC,iBAAA;MACA,YAAAC,MAAA,CAAAC,KAAA,CAAAZ,QAAA,CAAAU,gBAAA;IACA;IACA;IACAG,iBAAA;MACA,IAAAC,GAAA,QAAAT,cAAA,CAAAU,MAAA,CAAAC,IAAA,IAAAA,IAAA,CAAAC,OAAA;MACA,OAAAH,GAAA;IACA;IACA;IACAI,YAAA;MACA,YAAAP,MAAA,CAAAC,KAAA,CAAAO,MAAA,CAAAD,WAAA;IACA;EACA;EACAE,KAAA;IACA;IACApB,SAAAqB,QAAA;MACA,KAAAhB,cAAA,OAAAgB,QAAA,EACAC,IAAA,EAAAC,GAAA,EAAAC,IAAA;QACA,OAAAA,IAAA,CAAAC,KAAA,GAAAF,GAAA,CAAAE,KAAA;MACA,GACAC,GAAA,CAAAV,IAAA;QACA;UACA,GAAAA,IAAA;UACAC,OAAA;QACA;MACA;IACA;IACA;IACAJ,iBAAAQ,QAAA;MACA,KAAAV,MAAA,CAAAgB,MAAA,wBAAAN,QAAA;MACA,KAAAV,MAAA,CAAAgB,MAAA,2BAAAN,QAAA,CAAAO,MAAA;IACA;EACA;EACAC,OAAA;IACA;AACA;AACA;AACA;AACA;AACA;IACAC,kBAAAd,IAAA,EAAAe,KAAA,EAAAC,KAAA;MACA;MACAA,KAAA,CAAAC,YAAA;MACA;MACA,SAAAf,WAAA;QACA,KAAAX,YAAA,GAAAS,IAAA;QACA,UAAAN,gBAAA;UACAsB,KAAA,CAAAE,cAAA;UACA,KAAAC,QAAA,CACAC,WAAA;YACA7B,YAAA,EAAAS,IAAA;YACAqB,QAAA,EAAAL;UACA,GACAM,IAAA,CAAAxB,GAAA;YACA,KAAAP,YAAA;YACA,IAAAO,GAAA;cACA,KAAAyB,KAAA;cACA,KAAA5B,MAAA,CAAA6B,QAAA;YACA;UACA;QACA;MACA;IACA;IACA;AACA;AACA;AACA;AACA;AACA;IACAC,gBAAAzB,IAAA,EAAAgB,KAAA;MACA,KAAAzB,YAAA,GAAAS,IAAA;MACA,UAAAN,gBAAA;QACAsB,KAAA,CAAAE,cAAA;QACA,KAAAC,QAAA,CACAC,WAAA;UACA7B,YAAA,EAAAS,IAAA;UACAqB,QAAA,EAAAL;QACA,GACAM,IAAA,CAAAxB,GAAA;UACA,KAAAP,YAAA;UACA,IAAAO,GAAA;YACA,KAAAyB,KAAA;YACA,KAAA5B,MAAA,CAAA6B,QAAA;UACA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}