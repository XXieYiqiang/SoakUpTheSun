{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"C:/Users/Administrator/Desktop/GimChat/front/gim-chat/node_modules/@babel/runtime/helpers/interopRequireDefault.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.map.js\");\nvar _SelectColumn = _interopRequireDefault(require(\"./SelectColumn.vue\"));\nvar _vuex = require(\"vuex\");\nvar _default = exports.default = {\n  name: 'OperationMenu',\n  props: {\n    // 文件类型\n    fileType: {\n      required: true,\n      type: Number\n    },\n    // 文件路径\n    filePath: {\n      required: true,\n      type: String\n    }\n  },\n  components: {\n    SelectColumn: _SelectColumn.default\n  },\n  data() {\n    return {\n      // 文件搜索数据\n      searchFile: {\n        fileName: ''\n      },\n      operatePopoverVisible: false,\n      //  收纳栏是否显示\n      fileGroupLable: 0,\n      //  文件展示模式\n      dirImg: require('_a/images/file/dir.png'),\n      wordImg: require('_a/images/file/file_word.svg'),\n      excelImg: require('_a/images/file/file_excel.svg'),\n      pptImg: require('_a/images/file/file_ppt.svg')\n    };\n  },\n  computed: {\n    ...(0, _vuex.mapState)({\n      showUploadMask: state => state.uploadFile.showUploadMask\n    }),\n    // 上传文件组件参数\n    uploadFileParams() {\n      return {\n        filePath: this.filePath,\n        isDir: 0\n      };\n    },\n    // 文件查看模式 0 列表模式 1 网格模式 2 时间线模式\n    fileModel() {\n      return this.$store.getters.fileModel;\n    },\n    // 图标大小\n    gridSize: {\n      get() {\n        return this.$store.getters.gridSize;\n      },\n      set(val) {\n        this.$store.commit('changeGridSize', val);\n      }\n    },\n    // 被选中的文件列表\n    selectedFiles() {\n      return this.$store.state.fileList.selectedFiles;\n    },\n    // 是否批量操作\n    isBatchOperation() {\n      return this.$store.state.fileList.isBatchOperation;\n    },\n    // 屏幕宽度\n    screenWidth() {\n      return this.$store.state.common.screenWidth;\n    }\n  },\n  watch: {\n    // 显示拖拽上传文件遮罩\n    showUploadMask() {\n      this.handleUploadFileBtnClick(3);\n    },\n    fileType(newValue, oldValue) {\n      if (oldValue === 1 && this.fileModel === 2) {\n        this.$store.commit('changeFileModel', 0);\n        this.fileGroupLable = 0;\n      }\n    },\n    /**\r\n     * 监听收纳栏状态\r\n     * @description 打开时，body 添加点击事件的监听\r\n     */\n    operatePopoverVisible(newValue) {\n      if (newValue === true) {\n        document.body.addEventListener('click', this.closeOperatePopover);\n      } else {\n        document.body.removeEventListener('click', this.closeOperatePopover);\n      }\n    }\n  },\n  mounted() {\n    this.fileGroupLable = this.fileModel;\n  },\n  methods: {\n    /**\r\n     * 新建文件夹按钮点击事件\r\n     * @description 调用新建文件夹服务，并在弹窗确认回调事件中刷新文件列表\r\n     */\n    handleClickAddFolderBtn() {\n      this.$openDialog.addFolder({\n        filePath: this.$route.query.filePath || '/'\n      }).then(res => {\n        if (res === 'confirm') {\n          this.$emit('getTableDataByType');\n        }\n      });\n    },\n    /**\r\n     * 新建 office 文件\r\n     * @description 调用新建 office 文件服务，并在弹窗确认回调事件中刷新文件列表\r\n     * @param {string} 文件扩展名 docx xlsx pptx\r\n     */\n    handleCreateFile(extendName) {\n      this.$openDialog.addFile({\n        extendName: extendName\n      }).then(res => {\n        if (res === 'confirm') {\n          this.$emit('getTableDataByType');\n        }\n      });\n    },\n    /**\r\n     * 上传文件按钮点击事件\r\n     * @description 通过Bus通信，开启全局上传文件流程\r\n     * @param {boolean} uploadWay 上传方式 0-文件上传 1-文件夹上传 2-粘贴图片或拖拽上传\r\n     */\n    handleUploadFileBtnClick(uploadWay) {\n      console.log('this.$openBox');\n      console.log(this.$openBox);\n      console.log('this.$openBox.uploadFile');\n      console.log(this.$openBox.uploadFile);\n      const res = \"go\";\n      switch (res) {\n        case 'confirm':\n          {\n            this.$common.goAccount('/settings/account');\n            break;\n          }\n        case 'go':\n          {\n            this.$openBox.uploadFile({\n              params: this.uploadFileParams,\n              uploadWay,\n              serviceEl: this,\n              callType: 1 //  callType 调用此服务的方式：1 - 顶部栏，2 - 右键菜单\n            });\n            break;\n          }\n      }\n    },\n    /**\r\n     * 批量删除按钮点击事件\r\n     * @description 区分 删除到回收站中 | 在回收站中彻底删除，调用相应的删除文件接口\r\n     */\n    handleBatchDeleteBtnClick() {\n      this.$openDialog.deleteFile({\n        isBatchOperation: true,\n        fileInfo: this.selectedFiles,\n        deleteMode: this.fileType === 6 ? 2 : 1 //  删除模式：1-删除到回收站 2-彻底删除\n      }).then(res => {\n        if (res === 'confirm') {\n          this.$emit('getTableDataByType');\n          this.$store.dispatch('showStorage');\n        }\n      });\n    },\n    /**\r\n     * 批量移动按钮点击事件\r\n     */\n    handleBatchMoveBtnClick() {\n      if (this.selectedFiles.length > 0) {\n        this.$openDialog.moveFile({\n          isBatchOperation: true,\n          fileInfo: this.selectedFiles\n        }).then(res => {\n          if (res === 'confirm') {\n            this.$emit('getTableDataByType');\n          }\n        });\n      } else {\n        this.$message.warning('请先勾选文件');\n      }\n    },\n    /**\r\n     * 批量分享按钮点击事件\r\n     */\n    handleBatchShareBtnClick() {\n      this.$openDialog.shareFile({\n        fileInfo: this.selectedFiles.map(item => {\n          return {\n            userFileId: item.userFileId\n          };\n        })\n      });\n    },\n    /**\r\n     * 打包批量下载按钮点击事件\r\n     */\n    handleBatchDownloadBtnClick() {\n      this.$refs['batchDownloadRef'].click();\n    },\n    /**\r\n     * 搜索输入框搜索事件\r\n     * @param {string} value 搜索内容\r\n     */\n    handleSearchInputChange(value) {\n      if (value === '') {\n        this.$emit('getTableDataByType');\n      } else {\n        this.$emit('getSearchFileList', value);\n      }\n    },\n    /**\r\n     * 网格模式下，批量操作状态切换\r\n     */\n    handleBatchOperationChange() {\n      this.$store.commit('changeIsBatchOperation', !this.isBatchOperation);\n    },\n    /**\r\n     * 文件查看模式切换\r\n     * @param {number} label 0 列表 1 网格 2 时间线\r\n     */\n    handleFileDisplayModelChange(label) {\n      this.fileGroupLable = label;\n      // 关闭右键菜单事件\n      this.$openBox.contextMenu.close();\n      this.$store.commit('changeFileModel', label);\n      this.handleSearchInputChange(this.searchFile.fileName);\n      // 关闭收纳栏\n      this.operatePopoverVisible = false;\n    },\n    /**\r\n     * 格式化图标大小显示\r\n     * @param {number} val 改变后的数值\r\n     */\n    formatTooltip(val) {\n      return `${val}px`;\n    },\n    /**\r\n     * 关闭收纳栏\r\n     */\n    closeOperatePopover(event) {\n      if (!event.target.className.includes('setting-icon')) {\n        this.operatePopoverVisible = false;\n      }\n    }\n  }\n};","map":{"version":3,"names":["_SelectColumn","_interopRequireDefault","require","_vuex","_default","exports","default","name","props","fileType","required","type","Number","filePath","String","components","SelectColumn","data","searchFile","fileName","operatePopoverVisible","fileGroupLable","dirImg","wordImg","excelImg","pptImg","computed","mapState","showUploadMask","state","uploadFile","uploadFileParams","isDir","fileModel","$store","getters","gridSize","get","set","val","commit","selectedFiles","fileList","isBatchOperation","screenWidth","common","watch","handleUploadFileBtnClick","newValue","oldValue","document","body","addEventListener","closeOperatePopover","removeEventListener","mounted","methods","handleClickAddFolderBtn","$openDialog","addFolder","$route","query","then","res","$emit","handleCreateFile","extendName","addFile","uploadWay","console","log","$openBox","$common","goAccount","params","serviceEl","callType","handleBatchDeleteBtnClick","deleteFile","fileInfo","deleteMode","dispatch","handleBatchMoveBtnClick","length","moveFile","$message","warning","handleBatchShareBtnClick","shareFile","map","item","userFileId","handleBatchDownloadBtnClick","$refs","click","handleSearchInputChange","value","handleBatchOperationChange","handleFileDisplayModelChange","label","contextMenu","close","formatTooltip","event","target","className","includes"],"sources":["src/components/file/OperationMenu.vue"],"sourcesContent":["<template>\r\n\t<div class=\"operation-menu-wrapper\" :class=\"'file-type-' + fileType\" ref=\"operationMenuRef\">\r\n\t\t<el-button-group class=\"create-operate-group\"\r\n\t\t\tv-if=\"(!selectedFiles.length || !isBatchOperation) && fileType === 0\">\r\n\t\t\t<el-dropdown class=\"upload-drop\" trigger=\"hover\">\r\n\t\t\t\t<el-button size=\"mini\" type=\"primary\" icon=\"el-icon-upload2\" id=\"uploadFileId\">上传<i\r\n\t\t\t\t\t\tclass=\"el-icon-arrow-down el-icon--right\"></i></el-button>\r\n\t\t\t\t<el-dropdown-menu slot=\"dropdown\">\r\n\t\t\t\t\t<el-dropdown-item @click.native=\"handleUploadFileBtnClick(1)\">上传文件</el-dropdown-item>\r\n\t\t\t\t\t<el-dropdown-item @click.native=\"handleUploadFileBtnClick(2)\">上传文件夹</el-dropdown-item>\r\n\t\t\t\t\t<el-dropdown-item @click.native=\"handleUploadFileBtnClick(3)\" title=\"截图粘贴或拖拽上传\"\r\n\t\t\t\t\t\t:disabled=\"screenWidth <= 520\">拖拽上传</el-dropdown-item>\r\n\t\t\t\t</el-dropdown-menu>\r\n\t\t\t</el-dropdown>\r\n\r\n\t\t\t<el-dropdown class=\"create-drop\" trigger=\"hover\">\r\n\t\t\t\t<el-button size=\"mini\" type=\"primary\" icon=\"el-icon-plus\" id=\"uploadFileId\">新建<i\r\n\t\t\t\t\t\tclass=\"el-icon-arrow-down el-icon--right\"></i></el-button>\r\n\t\t\t\t<el-dropdown-menu slot=\"dropdown\">\r\n\t\t\t\t\t<el-dropdown-item @click.native=\"handleClickAddFolderBtn\">\r\n\t\t\t\t\t\t<div class=\"img-text-wrapper\"><img :src=\"dirImg\" /> 新建文件夹</div>\r\n\t\t\t\t\t</el-dropdown-item>\r\n\t\t\t\t\t<el-dropdown-item divided @click.native=\"handleCreateFile('docx')\">\r\n\t\t\t\t\t\t<div class=\"img-text-wrapper\"><img :src=\"wordImg\" />Word 文档</div>\r\n\t\t\t\t\t</el-dropdown-item>\r\n\t\t\t\t\t<el-dropdown-item @click.native=\"handleCreateFile('xlsx')\">\r\n\t\t\t\t\t\t<div class=\"img-text-wrapper\">\r\n\t\t\t\t\t\t\t<img :src=\"excelImg\" />Excel 工作表\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</el-dropdown-item>\r\n\t\t\t\t\t<el-dropdown-item @click.native=\"handleCreateFile('pptx')\">\r\n\t\t\t\t\t\t<div class=\"img-text-wrapper\">\r\n\t\t\t\t\t\t\t<img :src=\"pptImg\" />PPT 演示文稿\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</el-dropdown-item>\r\n\t\t\t\t</el-dropdown-menu>\r\n\t\t\t</el-dropdown>\r\n\t\t</el-button-group>\r\n\t\t<div class=\"batch-operate-group\">\r\n\t\t\t<el-button-group v-if=\"isBatchOperation\">\r\n\t\t\t\t<el-button size=\"mini\" type=\"primary\" v-if=\"selectedFiles.length\" icon=\"el-icon-delete\"\r\n\t\t\t\t\t@click=\"handleBatchDeleteBtnClick\">批量删除</el-button>\r\n\t\t\t\t<el-button size=\"mini\" type=\"primary\" v-if=\"selectedFiles.length && !fileType && fileType !== 6\"\r\n\t\t\t\t\ticon=\"el-icon-rank\" @click=\"handleBatchMoveBtnClick\">批量移动</el-button>\r\n\t\t\t\t<el-button size=\"mini\" type=\"primary\" v-if=\"selectedFiles.length && fileType !== 6\"\r\n\t\t\t\t\ticon=\"el-icon-download\" @click=\"handleBatchDownloadBtnClick\">批量下载</el-button>\r\n\t\t\t\t<el-button size=\"mini\" type=\"primary\" v-if=\"\r\n\t\t\t\t\tselectedFiles.length && fileType !== 6 && $route.name !== 'Share'\r\n\t\t\t\t\" icon=\"el-icon-share\" @click=\"handleBatchShareBtnClick\">批量分享</el-button>\r\n\t\t\t</el-button-group>\r\n\t\t</div>\r\n\r\n\t\t<!-- 全局搜索文件 -->\r\n\t\t<el-input v-if=\"fileType === 0\" class=\"select-file-input\" v-model=\"searchFile.fileName\" placeholder=\"搜索您的文件\"\r\n\t\t\tsize=\"mini\" maxlength=\"255\" :clearable=\"true\" @change=\"handleSearchInputChange\"\r\n\t\t\t@clear=\"$emit('getTableDataByType')\" @keyup.enter.native=\"handleSearchInputChange(searchFile.fileName)\">\r\n\t\t\t<i slot=\"prefix\" class=\"el-input__icon el-icon-search\" title=\"点击搜索\"\r\n\t\t\t\t@click=\"handleSearchInputChange(searchFile.fileName)\"></i>\r\n\t\t</el-input>\r\n\r\n\t\t<!-- 批量操作 -->\r\n\t\t<i class=\"batch-icon el-icon-finished\" :class=\"isBatchOperation ? 'active' : ''\"\r\n\t\t\t:title=\"isBatchOperation ? '取消批量操作' : '批量操作'\" v-if=\"fileModel === 1 && fileType !== 8\"\r\n\t\t\t@click=\"handleBatchOperationChange()\"></i>\r\n\t\t<i class=\"refresh-icon el-icon-refresh\" title=\"刷新文件列表\" @click=\"$emit('getTableDataByType')\"></i>\r\n\t\t<el-divider direction=\"vertical\"></el-divider>\r\n\t\t<template v-if=\"screenWidth > 768\">\r\n\t\t\t<!-- 文件展示模式 -->\r\n\t\t\t<i class=\"model-icon iconfont icon-liebiao1\" :class=\"{ active: fileGroupLable === 0 }\" title=\"列表模式\"\r\n\t\t\t\t@click=\"handleFileDisplayModelChange(0)\"></i>\r\n\t\t\t<i class=\"model-icon el-icon-s-grid\" :class=\"{ active: fileGroupLable === 1 }\" title=\"网格模式\"\r\n\t\t\t\t@click=\"handleFileDisplayModelChange(1)\"></i>\r\n\t\t\t<i class=\"model-icon el-icon-date\" :class=\"{ active: fileGroupLable === 2 }\" title=\"时间线模式\"\r\n\t\t\t\tv-if=\"fileType === 1\" @click=\"handleFileDisplayModelChange(2)\"></i>\r\n\t\t\t<el-divider direction=\"vertical\"></el-divider>\r\n\t\t</template>\r\n\r\n\t\t<!-- 操作栏收纳 -->\r\n\t\t<el-popover v-model=\"operatePopoverVisible\" placement=\"bottom\"\r\n\t\t\t:trigger=\"screenWidth <= 768 ? 'manual' : 'hover'\">\r\n\t\t\t<i slot=\"reference\" class=\"setting-icon el-icon-setting\"\r\n\t\t\t\t@click=\"operatePopoverVisible = !operatePopoverVisible\"></i>\r\n\t\t\t<!-- 选择表格列 -->\r\n\t\t\t<SelectColumn></SelectColumn>\r\n\t\t\t<!-- 文件展示模式 -->\r\n\t\t\t<div class=\"change-file-model\" v-if=\"screenWidth <= 768\">\r\n\t\t\t\t<div class=\"title\">查看模式</div>\r\n\t\t\t\t<el-radio-group v-model=\"fileGroupLable\" size=\"mini\" @change=\"handleFileDisplayModelChange\">\r\n\t\t\t\t\t<el-radio-button :label=\"0\">\r\n\t\t\t\t\t\t<i class=\"iconfont icon-liebiao1\"></i> 列表\r\n\t\t\t\t\t</el-radio-button>\r\n\t\t\t\t\t<el-radio-button :label=\"1\">\r\n\t\t\t\t\t\t<i class=\"el-icon-s-grid\"></i> 网格\r\n\t\t\t\t\t</el-radio-button>\r\n\t\t\t\t\t<el-radio-button :label=\"2\" v-if=\"fileType === 1\">\r\n\t\t\t\t\t\t<i class=\"el-icon-date\"></i> 时间线\r\n\t\t\t\t\t</el-radio-button>\r\n\t\t\t\t</el-radio-group>\r\n\t\t\t</div>\r\n\t\t\t<template v-if=\"fileGroupLable === 1 || fileGroupLable === 2\">\r\n\t\t\t\t<el-divider class=\"split-line\"></el-divider>\r\n\t\t\t\t<!-- 图标大小调整 -->\r\n\t\t\t\t<div class=\"change-grid-size\">\r\n\t\t\t\t\t<div class=\"title\">调整图标大小</div>\r\n\t\t\t\t\t<el-slider v-model=\"gridSize\" :min=\"20\" :max=\"150\" :step=\"10\"\r\n\t\t\t\t\t\t:format-tooltip=\"formatTooltip\"></el-slider>\r\n\t\t\t\t</div>\r\n\t\t\t</template>\r\n\t\t</el-popover>\r\n\r\n\t\t<!-- 多选文件下载，页面隐藏 -->\r\n\t\t<a target=\"_blank\" :href=\"batchDownloadLink\" ref=\"batchDownloadRef\"></a>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport SelectColumn from './SelectColumn.vue'\r\nimport { mapState } from 'vuex'\r\nexport default {\r\n\tname: 'OperationMenu',\r\n\tprops: {\r\n\t\t// 文件类型\r\n\t\tfileType: {\r\n\t\t\trequired: true,\r\n\t\t\ttype: Number\r\n\t\t},\r\n\t\t// 文件路径\r\n\t\tfilePath: {\r\n\t\t\trequired: true,\r\n\t\t\ttype: String\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tSelectColumn\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\t// 文件搜索数据\r\n\t\t\tsearchFile: {\r\n\t\t\t\tfileName: ''\r\n\t\t\t},\r\n\t\t\toperatePopoverVisible: false, //  收纳栏是否显示\r\n\t\t\tfileGroupLable: 0, //  文件展示模式\r\n\t\t\tdirImg: require('_a/images/file/dir.png'),\r\n\t\t\twordImg: require('_a/images/file/file_word.svg'),\r\n\t\t\texcelImg: require('_a/images/file/file_excel.svg'),\r\n\t\t\tpptImg: require('_a/images/file/file_ppt.svg')\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState({\r\n\t\t\tshowUploadMask: state => state.uploadFile.showUploadMask\r\n\t\t}),\r\n\t\t// 上传文件组件参数\r\n\t\tuploadFileParams() {\r\n\t\t\treturn {\r\n\t\t\t\tfilePath: this.filePath,\r\n\t\t\t\tisDir: 0\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 文件查看模式 0 列表模式 1 网格模式 2 时间线模式\r\n\t\tfileModel() {\r\n\t\t\treturn this.$store.getters.fileModel\r\n\t\t},\r\n\t\t// 图标大小\r\n\t\tgridSize: {\r\n\t\t\tget() {\r\n\t\t\t\treturn this.$store.getters.gridSize\r\n\t\t\t},\r\n\t\t\tset(val) {\r\n\t\t\t\tthis.$store.commit('changeGridSize', val)\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 被选中的文件列表\r\n\t\tselectedFiles() {\r\n\t\t\treturn this.$store.state.fileList.selectedFiles\r\n\t\t},\r\n\t\t// 是否批量操作\r\n\t\tisBatchOperation() {\r\n\t\t\treturn this.$store.state.fileList.isBatchOperation\r\n\t\t},\r\n\t\t// 屏幕宽度\r\n\t\tscreenWidth() {\r\n\t\t\treturn this.$store.state.common.screenWidth\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\t// 显示拖拽上传文件遮罩\r\n\t\tshowUploadMask() {\r\n\t\t\tthis.handleUploadFileBtnClick(3);\r\n\t\t},\r\n\t\tfileType(newValue, oldValue) {\r\n\t\t\tif (oldValue === 1 && this.fileModel === 2) {\r\n\t\t\t\tthis.$store.commit('changeFileModel', 0)\r\n\t\t\t\tthis.fileGroupLable = 0\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * 监听收纳栏状态\r\n\t\t * @description 打开时，body 添加点击事件的监听\r\n\t\t */\r\n\t\toperatePopoverVisible(newValue) {\r\n\t\t\tif (newValue === true) {\r\n\t\t\t\tdocument.body.addEventListener('click', this.closeOperatePopover)\r\n\t\t\t} else {\r\n\t\t\t\tdocument.body.removeEventListener('click', this.closeOperatePopover)\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\tthis.fileGroupLable = this.fileModel\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 新建文件夹按钮点击事件\r\n\t\t * @description 调用新建文件夹服务，并在弹窗确认回调事件中刷新文件列表\r\n\t\t */\r\n\t\thandleClickAddFolderBtn() {\r\n\t\t\tthis.$openDialog\r\n\t\t\t\t.addFolder({\r\n\t\t\t\t\tfilePath: this.$route.query.filePath || '/'\r\n\t\t\t\t})\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tif (res === 'confirm') {\r\n\t\t\t\t\t\tthis.$emit('getTableDataByType')\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t},\r\n\t\t/**\r\n\t\t * 新建 office 文件\r\n\t\t * @description 调用新建 office 文件服务，并在弹窗确认回调事件中刷新文件列表\r\n\t\t * @param {string} 文件扩展名 docx xlsx pptx\r\n\t\t */\r\n\t\thandleCreateFile(extendName) {\r\n\t\t\tthis.$openDialog\r\n\t\t\t\t.addFile({\r\n\t\t\t\t\textendName: extendName\r\n\t\t\t\t})\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tif (res === 'confirm') {\r\n\t\t\t\t\t\tthis.$emit('getTableDataByType')\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t},\r\n\t\t/**\r\n\t\t * 上传文件按钮点击事件\r\n\t\t * @description 通过Bus通信，开启全局上传文件流程\r\n\t\t * @param {boolean} uploadWay 上传方式 0-文件上传 1-文件夹上传 2-粘贴图片或拖拽上传\r\n\t\t */\r\n\t\thandleUploadFileBtnClick(uploadWay) {\r\n\t\t\tconsole.log('this.$openBox')\r\n\t\t\tconsole.log(this.$openBox)\r\n\t\t\tconsole.log('this.$openBox.uploadFile')\r\n\t\t\tconsole.log(this.$openBox.uploadFile)\r\n\t\t\tconst res = \"go\"\r\n\t\t\tswitch (res) {\r\n\t\t\t\tcase 'confirm': {\r\n\t\t\t\t\tthis.$common.goAccount('/settings/account')\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t\tcase 'go': {\r\n\t\t\t\t\tthis.$openBox.uploadFile({\r\n\t\t\t\t\t\tparams: this.uploadFileParams,\r\n\t\t\t\t\t\tuploadWay,\r\n\t\t\t\t\t\tserviceEl: this,\r\n\t\t\t\t\t\tcallType: 1 //  callType 调用此服务的方式：1 - 顶部栏，2 - 右键菜单\r\n\t\t\t\t\t})\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * 批量删除按钮点击事件\r\n\t * @description 区分 删除到回收站中 | 在回收站中彻底删除，调用相应的删除文件接口\r\n\t */\r\n\thandleBatchDeleteBtnClick() {\r\n\t\tthis.$openDialog\r\n\t\t\t.deleteFile({\r\n\t\t\t\tisBatchOperation: true,\r\n\t\t\t\tfileInfo: this.selectedFiles,\r\n\t\t\t\tdeleteMode: this.fileType === 6 ? 2 : 1 //  删除模式：1-删除到回收站 2-彻底删除\r\n\t\t\t})\r\n\t\t\t.then((res) => {\r\n\t\t\t\tif (res === 'confirm') {\r\n\t\t\t\t\tthis.$emit('getTableDataByType')\r\n\t\t\t\t\tthis.$store.dispatch('showStorage')\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t},\r\n\t/**\r\n\t * 批量移动按钮点击事件\r\n\t */\r\n\thandleBatchMoveBtnClick() {\r\n\t\tif (this.selectedFiles.length > 0) {\r\n\t\t\tthis.$openDialog\r\n\t\t\t\t.moveFile({\r\n\t\t\t\t\tisBatchOperation: true,\r\n\t\t\t\t\tfileInfo: this.selectedFiles\r\n\t\t\t\t})\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tif (res === 'confirm') {\r\n\t\t\t\t\t\tthis.$emit('getTableDataByType')\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t} else {\r\n\t\t\tthis.$message.warning('请先勾选文件')\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * 批量分享按钮点击事件\r\n\t */\r\n\thandleBatchShareBtnClick() {\r\n\t\tthis.$openDialog.shareFile({\r\n\t\t\tfileInfo: this.selectedFiles.map((item) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tuserFileId: item.userFileId\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\t},\r\n\t/**\r\n\t * 打包批量下载按钮点击事件\r\n\t */\r\n\thandleBatchDownloadBtnClick() {\r\n\t\tthis.$refs['batchDownloadRef'].click()\r\n\t},\r\n\t/**\r\n\t * 搜索输入框搜索事件\r\n\t * @param {string} value 搜索内容\r\n\t */\r\n\thandleSearchInputChange(value) {\r\n\t\tif (value === '') {\r\n\t\t\tthis.$emit('getTableDataByType')\r\n\t\t} else {\r\n\t\t\tthis.$emit('getSearchFileList', value)\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * 网格模式下，批量操作状态切换\r\n\t */\r\n\thandleBatchOperationChange() {\r\n\t\tthis.$store.commit('changeIsBatchOperation', !this.isBatchOperation)\r\n\t},\r\n\t/**\r\n\t * 文件查看模式切换\r\n\t * @param {number} label 0 列表 1 网格 2 时间线\r\n\t */\r\n\thandleFileDisplayModelChange(label) {\r\n\t\tthis.fileGroupLable = label\r\n\t\t// 关闭右键菜单事件\r\n\t\tthis.$openBox.contextMenu.close()\r\n\t\tthis.$store.commit('changeFileModel', label)\r\n\t\tthis.handleSearchInputChange(this.searchFile.fileName)\r\n\t\t// 关闭收纳栏\r\n\t\tthis.operatePopoverVisible = false\r\n\t},\r\n\t/**\r\n\t * 格式化图标大小显示\r\n\t * @param {number} val 改变后的数值\r\n\t */\r\n\tformatTooltip(val) {\r\n\t\treturn `${val}px`\r\n\t},\r\n\t/**\r\n\t * 关闭收纳栏\r\n\t */\r\n\tcloseOperatePopover(event) {\r\n\t\tif (!event.target.className.includes('setting-icon')) {\r\n\t\t\tthis.operatePopoverVisible = false\r\n\t\t}\r\n\t}\r\n}\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n@import '~_a/styles/varibles.styl';\r\n\r\n.operation-menu-wrapper.file-type-6 {\r\n  margin: 8px 0;\r\n  justify-content: flex-end;\r\n}\r\n\r\n.operation-menu-wrapper {\r\n  padding: 16px 0;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n\r\n  .create-operate-group {\r\n    .upload-drop {\r\n      float: left;\r\n      >>> .el-button {\r\n        border-radius: 4px 0 0 4px;\r\n      }\r\n    }\r\n    .create-drop {\r\n      float: left;\r\n    }\r\n  }\r\n\r\n  .batch-operate-group {\r\n    flex: 1;\r\n  }\r\n\r\n  .select-file-input {\r\n    margin-right: 8px;\r\n    width: 250px;\r\n\r\n    .el-icon-search {\r\n      cursor: pointer;\r\n      font-size: 16px;\r\n\r\n      &:hover {\r\n        color: $Primary;\r\n      }\r\n    }\r\n  }\r\n\r\n  .batch-icon,\r\n  .model-icon {\r\n    margin-right: 8px;\r\n    &:last-of-type {\r\n      margin-right: 0;\r\n    }\r\n  }\r\n\r\n  .model-icon.active {\r\n    color: $Primary;\r\n  }\r\n\r\n  .refresh-icon, .batch-icon, .model-icon, .setting-icon {\r\n    font-size: 20px;\r\n    cursor: pointer;\r\n    color: $SecondaryText;\r\n\r\n    &:hover {\r\n      color: $Primary;\r\n    }\r\n  }\r\n\r\n  .batch-icon.active {\r\n    color: $Primary;\r\n  }\r\n}\r\n\r\n.split-line {\r\n  margin: 8px 0;\r\n}\r\n\r\n.img-text-wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n  img {\r\n    margin-right: 4px;\r\n    height: 24px;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":";;;;;;;;;AAoHA,IAAAA,aAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,KAAA,GAAAD,OAAA;AAAA,IAAAE,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACA;EACAC,IAAA;EACAC,KAAA;IACA;IACAC,QAAA;MACAC,QAAA;MACAC,IAAA,EAAAC;IACA;IACA;IACAC,QAAA;MACAH,QAAA;MACAC,IAAA,EAAAG;IACA;EACA;EACAC,UAAA;IACAC,YAAA,EAAAA;EACA;EACAC,KAAA;IACA;MACA;MACAC,UAAA;QACAC,QAAA;MACA;MACAC,qBAAA;MAAA;MACAC,cAAA;MAAA;MACAC,MAAA,EAAApB,OAAA;MACAqB,OAAA,EAAArB,OAAA;MACAsB,QAAA,EAAAtB,OAAA;MACAuB,MAAA,EAAAvB,OAAA;IACA;EACA;EACAwB,QAAA;IACA,OAAAC,cAAA;MACAC,cAAA,EAAAC,KAAA,IAAAA,KAAA,CAAAC,UAAA,CAAAF;IACA;IACA;IACAG,iBAAA;MACA;QACAlB,QAAA,OAAAA,QAAA;QACAmB,KAAA;MACA;IACA;IACA;IACAC,UAAA;MACA,YAAAC,MAAA,CAAAC,OAAA,CAAAF,SAAA;IACA;IACA;IACAG,QAAA;MACAC,IAAA;QACA,YAAAH,MAAA,CAAAC,OAAA,CAAAC,QAAA;MACA;MACAE,IAAAC,GAAA;QACA,KAAAL,MAAA,CAAAM,MAAA,mBAAAD,GAAA;MACA;IACA;IACA;IACAE,cAAA;MACA,YAAAP,MAAA,CAAAL,KAAA,CAAAa,QAAA,CAAAD,aAAA;IACA;IACA;IACAE,iBAAA;MACA,YAAAT,MAAA,CAAAL,KAAA,CAAAa,QAAA,CAAAC,gBAAA;IACA;IACA;IACAC,YAAA;MACA,YAAAV,MAAA,CAAAL,KAAA,CAAAgB,MAAA,CAAAD,WAAA;IACA;EACA;EACAE,KAAA;IACA;IACAlB,eAAA;MACA,KAAAmB,wBAAA;IACA;IACAtC,SAAAuC,QAAA,EAAAC,QAAA;MACA,IAAAA,QAAA,eAAAhB,SAAA;QACA,KAAAC,MAAA,CAAAM,MAAA;QACA,KAAAnB,cAAA;MACA;IACA;IACA;AACA;AACA;AACA;IACAD,sBAAA4B,QAAA;MACA,IAAAA,QAAA;QACAE,QAAA,CAAAC,IAAA,CAAAC,gBAAA,eAAAC,mBAAA;MACA;QACAH,QAAA,CAAAC,IAAA,CAAAG,mBAAA,eAAAD,mBAAA;MACA;IACA;EACA;EACAE,QAAA;IACA,KAAAlC,cAAA,QAAAY,SAAA;EACA;EACAuB,OAAA;IACA;AACA;AACA;AACA;IACAC,wBAAA;MACA,KAAAC,WAAA,CACAC,SAAA;QACA9C,QAAA,OAAA+C,MAAA,CAAAC,KAAA,CAAAhD,QAAA;MACA,GACAiD,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA;UACA,KAAAC,KAAA;QACA;MACA;IACA;IACA;AACA;AACA;AACA;AACA;IACAC,iBAAAC,UAAA;MACA,KAAAR,WAAA,CACAS,OAAA;QACAD,UAAA,EAAAA;MACA,GACAJ,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA;UACA,KAAAC,KAAA;QACA;MACA;IACA;IACA;AACA;AACA;AACA;AACA;IACAjB,yBAAAqB,SAAA;MACAC,OAAA,CAAAC,GAAA;MACAD,OAAA,CAAAC,GAAA,MAAAC,QAAA;MACAF,OAAA,CAAAC,GAAA;MACAD,OAAA,CAAAC,GAAA,MAAAC,QAAA,CAAAzC,UAAA;MACA,MAAAiC,GAAA;MACA,QAAAA,GAAA;QACA;UAAA;YACA,KAAAS,OAAA,CAAAC,SAAA;YACA;UACA;QACA;UAAA;YACA,KAAAF,QAAA,CAAAzC,UAAA;cACA4C,MAAA,OAAA3C,gBAAA;cACAqC,SAAA;cACAO,SAAA;cACAC,QAAA;YACA;YACA;UACA;MACA;IACA;IAEA;AACA;AACA;AACA;IACAC,0BAAA;MACA,KAAAnB,WAAA,CACAoB,UAAA;QACAnC,gBAAA;QACAoC,QAAA,OAAAtC,aAAA;QACAuC,UAAA,OAAAvE,QAAA;MACA,GACAqD,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA;UACA,KAAAC,KAAA;UACA,KAAA9B,MAAA,CAAA+C,QAAA;QACA;MACA;IACA;IACA;AACA;AACA;IACAC,wBAAA;MACA,SAAAzC,aAAA,CAAA0C,MAAA;QACA,KAAAzB,WAAA,CACA0B,QAAA;UACAzC,gBAAA;UACAoC,QAAA,OAAAtC;QACA,GACAqB,IAAA,CAAAC,GAAA;UACA,IAAAA,GAAA;YACA,KAAAC,KAAA;UACA;QACA;MACA;QACA,KAAAqB,QAAA,CAAAC,OAAA;MACA;IACA;IACA;AACA;AACA;IACAC,yBAAA;MACA,KAAA7B,WAAA,CAAA8B,SAAA;QACAT,QAAA,OAAAtC,aAAA,CAAAgD,GAAA,CAAAC,IAAA;UACA;YACAC,UAAA,EAAAD,IAAA,CAAAC;UACA;QACA;MACA;IACA;IACA;AACA;AACA;IACAC,4BAAA;MACA,KAAAC,KAAA,qBAAAC,KAAA;IACA;IACA;AACA;AACA;AACA;IACAC,wBAAAC,KAAA;MACA,IAAAA,KAAA;QACA,KAAAhC,KAAA;MACA;QACA,KAAAA,KAAA,sBAAAgC,KAAA;MACA;IACA;IACA;AACA;AACA;IACAC,2BAAA;MACA,KAAA/D,MAAA,CAAAM,MAAA,iCAAAG,gBAAA;IACA;IACA;AACA;AACA;AACA;IACAuD,6BAAAC,KAAA;MACA,KAAA9E,cAAA,GAAA8E,KAAA;MACA;MACA,KAAA5B,QAAA,CAAA6B,WAAA,CAAAC,KAAA;MACA,KAAAnE,MAAA,CAAAM,MAAA,oBAAA2D,KAAA;MACA,KAAAJ,uBAAA,MAAA7E,UAAA,CAAAC,QAAA;MACA;MACA,KAAAC,qBAAA;IACA;IACA;AACA;AACA;AACA;IACAkF,cAAA/D,GAAA;MACA,UAAAA,GAAA;IACA;IACA;AACA;AACA;IACAc,oBAAAkD,KAAA;MACA,KAAAA,KAAA,CAAAC,MAAA,CAAAC,SAAA,CAAAC,QAAA;QACA,KAAAtF,qBAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}