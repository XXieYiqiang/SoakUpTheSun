{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"C:/Users/Administrator/Desktop/GimChat/gimChatVue/node_modules/@babel/runtime/helpers/interopRequireDefault.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _vue = _interopRequireDefault(require(\"vue\"));\nvar _Box = _interopRequireDefault(require(\"./Box.vue\"));\n// 导入组件\n\n// 使用基础 Vue 构造器，创建一个“子类”\nconst ContextMenuConstructor = _vue.default.extend(_Box.default);\nlet contextMenuInstance = null;\n/**\r\n * 初始化右键菜单实例\r\n * @param {string} selectedFile 文件信息，如果此值为 undefined，证明是在空白触右键\r\n * @param {object} domEvent 当前右键点击的元素\r\n * @param {} serviceEl 调用当前服务的组件实例\r\n * @param {} callType 是否组件本身\r\n */\nconst initInstanceContextMenu = (selectedFile, domEvent, serviceEl, callType) => {\n  contextMenuInstance = new ContextMenuConstructor({\n    el: document.createElement('div'),\n    data() {\n      return {\n        selectedFile,\n        domEvent,\n        serviceEl,\n        callType\n      };\n    }\n  });\n};\n/**\r\n * 右键菜单 Promise 函数\r\n * @returns {Promise} 抛出确认和取消回调函数\r\n */\nconst showContextMenuBox = obj => {\n  // 非首次调用服务时，在 DOM 中移除上个实例\n  if (contextMenuInstance !== null) {\n    document.body.removeChild(contextMenuInstance.$el);\n  }\n  let {\n    selectedFile,\n    domEvent,\n    serviceEl,\n    callType\n  } = obj;\n  return new Promise(reslove => {\n    initInstanceContextMenu(selectedFile, domEvent, serviceEl, callType);\n    contextMenuInstance.callback = res => {\n      reslove(res);\n      // 服务取消时卸载 DOM\n      if (res === 'cancel' && contextMenuInstance !== null) {\n        document.body.removeChild(contextMenuInstance.$el);\n        contextMenuInstance = null;\n      }\n    };\n    document.body.appendChild(contextMenuInstance.$el); //  挂载 DOM\n    _vue.default.nextTick(() => {\n      contextMenuInstance.handleOpenContextMenu(); //  开始计算右键菜单需要显示的位置\n    });\n  });\n};\n\n// 添加关闭事件\nshowContextMenuBox.close = () => {\n  if (contextMenuInstance !== null) {\n    document.body.removeChild(contextMenuInstance.$el);\n    contextMenuInstance = null;\n  }\n};\nvar _default = exports.default = showContextMenuBox;","map":{"version":3,"names":["_vue","_interopRequireDefault","require","_Box","ContextMenuConstructor","Vue","extend","ContextMenu","contextMenuInstance","initInstanceContextMenu","selectedFile","domEvent","serviceEl","callType","el","document","createElement","data","showContextMenuBox","obj","body","removeChild","$el","Promise","reslove","callback","res","appendChild","nextTick","handleOpenContextMenu","close","_default","exports","default"],"sources":["C:/Users/Administrator/Desktop/GimChat/gimChatVue/src/components/file/box/contextMenu/index.js"],"sourcesContent":["import Vue from 'vue'\r\n// 导入组件\r\nimport ContextMenu from './Box.vue'\r\n// 使用基础 Vue 构造器，创建一个“子类”\r\nconst ContextMenuConstructor = Vue.extend(ContextMenu)\r\n\r\nlet contextMenuInstance = null\r\n/**\r\n * 初始化右键菜单实例\r\n * @param {string} selectedFile 文件信息，如果此值为 undefined，证明是在空白触右键\r\n * @param {object} domEvent 当前右键点击的元素\r\n * @param {} serviceEl 调用当前服务的组件实例\r\n * @param {} callType 是否组件本身\r\n */\r\nconst initInstanceContextMenu = (\r\n\tselectedFile,\r\n\tdomEvent,\r\n\tserviceEl,\r\n\tcallType\r\n) => {\r\n\tcontextMenuInstance = new ContextMenuConstructor({\r\n\t\tel: document.createElement('div'),\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tselectedFile,\r\n\t\t\t\tdomEvent,\r\n\t\t\t\tserviceEl,\r\n\t\t\t\tcallType\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n}\r\n/**\r\n * 右键菜单 Promise 函数\r\n * @returns {Promise} 抛出确认和取消回调函数\r\n */\r\nconst showContextMenuBox = (obj) => {\r\n\t// 非首次调用服务时，在 DOM 中移除上个实例\r\n\tif (contextMenuInstance !== null) {\r\n\t\tdocument.body.removeChild(contextMenuInstance.$el)\r\n\t}\r\n\tlet { selectedFile, domEvent, serviceEl, callType } = obj\r\n\treturn new Promise((reslove) => {\r\n\t\tinitInstanceContextMenu(selectedFile, domEvent, serviceEl, callType)\r\n\t\tcontextMenuInstance.callback = (res) => {\r\n\t\t\treslove(res)\r\n\t\t\t// 服务取消时卸载 DOM\r\n\t\t\tif (res === 'cancel' && contextMenuInstance !== null) {\r\n\t\t\t\tdocument.body.removeChild(contextMenuInstance.$el)\r\n\t\t\t\tcontextMenuInstance = null\r\n\t\t\t}\r\n\t\t}\r\n\t\tdocument.body.appendChild(contextMenuInstance.$el) //  挂载 DOM\r\n\t\tVue.nextTick(() => {\r\n\t\t\tcontextMenuInstance.handleOpenContextMenu() //  开始计算右键菜单需要显示的位置\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// 添加关闭事件\r\nshowContextMenuBox.close = () => {\r\n\tif (contextMenuInstance !== null) {\r\n\t\tdocument.body.removeChild(contextMenuInstance.$el)\r\n\t\tcontextMenuInstance = null\r\n\t}\r\n}\r\n\r\nexport default showContextMenuBox\r\n"],"mappings":";;;;;;;AAAA,IAAAA,IAAA,GAAAC,sBAAA,CAAAC,OAAA;AAEA,IAAAC,IAAA,GAAAF,sBAAA,CAAAC,OAAA;AADA;;AAEA;AACA,MAAME,sBAAsB,GAAGC,YAAG,CAACC,MAAM,CAACC,YAAW,CAAC;AAEtD,IAAIC,mBAAmB,GAAG,IAAI;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,uBAAuB,GAAGA,CAC/BC,YAAY,EACZC,QAAQ,EACRC,SAAS,EACTC,QAAQ,KACJ;EACJL,mBAAmB,GAAG,IAAIJ,sBAAsB,CAAC;IAChDU,EAAE,EAAEC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;IACjCC,IAAIA,CAAA,EAAG;MACN,OAAO;QACNP,YAAY;QACZC,QAAQ;QACRC,SAAS;QACTC;MACD,CAAC;IACF;EACD,CAAC,CAAC;AACH,CAAC;AACD;AACA;AACA;AACA;AACA,MAAMK,kBAAkB,GAAIC,GAAG,IAAK;EACnC;EACA,IAAIX,mBAAmB,KAAK,IAAI,EAAE;IACjCO,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACb,mBAAmB,CAACc,GAAG,CAAC;EACnD;EACA,IAAI;IAAEZ,YAAY;IAAEC,QAAQ;IAAEC,SAAS;IAAEC;EAAS,CAAC,GAAGM,GAAG;EACzD,OAAO,IAAII,OAAO,CAAEC,OAAO,IAAK;IAC/Bf,uBAAuB,CAACC,YAAY,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,QAAQ,CAAC;IACpEL,mBAAmB,CAACiB,QAAQ,GAAIC,GAAG,IAAK;MACvCF,OAAO,CAACE,GAAG,CAAC;MACZ;MACA,IAAIA,GAAG,KAAK,QAAQ,IAAIlB,mBAAmB,KAAK,IAAI,EAAE;QACrDO,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACb,mBAAmB,CAACc,GAAG,CAAC;QAClDd,mBAAmB,GAAG,IAAI;MAC3B;IACD,CAAC;IACDO,QAAQ,CAACK,IAAI,CAACO,WAAW,CAACnB,mBAAmB,CAACc,GAAG,CAAC,EAAC;IACnDjB,YAAG,CAACuB,QAAQ,CAAC,MAAM;MAClBpB,mBAAmB,CAACqB,qBAAqB,CAAC,CAAC,EAAC;IAC7C,CAAC,CAAC;EACH,CAAC,CAAC;AACH,CAAC;;AAED;AACAX,kBAAkB,CAACY,KAAK,GAAG,MAAM;EAChC,IAAItB,mBAAmB,KAAK,IAAI,EAAE;IACjCO,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACb,mBAAmB,CAACc,GAAG,CAAC;IAClDd,mBAAmB,GAAG,IAAI;EAC3B;AACD,CAAC;AAAA,IAAAuB,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEcf,kBAAkB","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}