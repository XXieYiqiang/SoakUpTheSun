{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.filter.js\");\nrequire(\"core-js/modules/es.iterator.map.js\");\nvar _vuex = require(\"vuex\");\nvar _default = exports.default = {\n  name: 'FileGrid',\n  props: {\n    // 文件类型\n    fileType: {\n      required: true,\n      type: Number\n    },\n    // 文件路径\n    filePath: {\n      required: true,\n      type: String\n    },\n    fileList: Array,\n    //  文件列表\n    loading: Boolean\n  },\n  data() {\n    return {\n      fileListSorted: [],\n      officeFileType: ['ppt', 'pptx', 'doc', 'docx', 'xls', 'xlsx'],\n      selectedFile: {}\n    };\n  },\n  computed: {\n    /**\r\n     * gridSize: 图标大小\r\n     *  */\n    ...(0, _vuex.mapGetters)(['gridSize']),\n    // 是否批量操作\n    isBatchOperation() {\n      return this.$store.state.fileList.isBatchOperation;\n    },\n    // 批量操作模式 - 被选中的文件\n    selectedFileList() {\n      let res = this.fileListSorted.filter(item => item.checked);\n      return res;\n    },\n    // 屏幕宽度\n    screenWidth() {\n      return this.$store.state.common.screenWidth;\n    }\n  },\n  watch: {\n    // 文件平铺模式 排序-文件夹在前\n    fileList(newValue) {\n      this.fileListSorted = [...newValue].sort((pre, next) => {\n        return next.isDir - pre.isDir;\n      }).map(item => {\n        return {\n          ...item,\n          checked: false\n        };\n      });\n    },\n    // 批量操作模式 - 监听被选中的文件\n    selectedFileList(newValue) {\n      this.$store.commit('changeSelectedFiles', newValue);\n      this.$store.commit('changeIsBatchOperation', newValue.length !== 0);\n    }\n  },\n  methods: {\n    /**\r\n     * 文件鼠标右键事件\r\n     * @param {object} item 文件信息\r\n     * @param {number} index 文件索引\r\n     * @param {object} event 鼠标事件信息\r\n     */\n    handleContextMenu(item, index, event) {\n      // 阻止右键事件冒泡\n      event.cancelBubble = true;\n      // xs 以上的屏幕\n      if (this.screenWidth > 768) {\n        this.selectedFile = item;\n        if (!this.isBatchOperation) {\n          event.preventDefault();\n          this.$openBox.contextMenu({\n            selectedFile: item,\n            domEvent: event\n          }).then(res => {\n            this.selectedFile = {};\n            if (res === 'confirm') {\n              this.$emit('getTableDataByType'); //  刷新文件列表\n              this.$store.dispatch('showStorage'); //  刷新存储容量\n            }\n          });\n        }\n      }\n    },\n    /**\r\n     * 更多图标点击事件\r\n     * @description 打开右键菜单\r\n     * @param {object} item 当前行数据\r\n     * @param {object} event 当前右键元素\r\n     */\n    handleClickMore(item, event) {\n      this.selectedFile = item;\n      if (!this.isBatchOperation) {\n        event.preventDefault();\n        this.$openBox.contextMenu({\n          selectedFile: item,\n          domEvent: event\n        }).then(res => {\n          this.selectedFile = {};\n          if (res === 'confirm') {\n            this.$emit('getTableDataByType'); //  刷新文件列表\n            this.$store.dispatch('showStorage'); //  刷新存储容量\n          }\n        });\n      }\n    }\n  }\n};","map":{"version":3,"names":["_vuex","require","_default","exports","default","name","props","fileType","required","type","Number","filePath","String","fileList","Array","loading","Boolean","data","fileListSorted","officeFileType","selectedFile","computed","mapGetters","isBatchOperation","$store","state","selectedFileList","res","filter","item","checked","screenWidth","common","watch","newValue","sort","pre","next","isDir","map","commit","length","methods","handleContextMenu","index","event","cancelBubble","preventDefault","$openBox","contextMenu","domEvent","then","$emit","dispatch","handleClickMore"],"sources":["src/components/file/components/FileGrid.vue"],"sourcesContent":["<template>\r\n    <div class=\"file-grid-wrapper tech-grid-wrapper\">\r\n        <ul\r\n            class=\"file-list tech-file-list\"\r\n            v-loading=\"loading\"\r\n            element-loading-text=\"文件加载中……\"\r\n        >\r\n            <li\r\n                class=\"file-item tech-file-item\"\r\n                v-for=\"(item, index) in fileListSorted\"\r\n                :key=\"index\"\r\n                :title=\"$file.getFileNameComplete(item)\"\r\n                :style=\"`width: ${gridSize + 40}px; `\"\r\n                :class=\"item.userFileId === selectedFile.userFileId ? 'tech-active-item' : ''\"\r\n                @click=\"$file.handleFileNameClick(item, index, fileListSorted)\"\r\n                @contextmenu.prevent=\"handleContextMenu(item, index, $event)\"\r\n            >\r\n                <video\r\n                    :style=\"`height:${gridSize}px; width:${gridSize}px`\"\r\n                    v-if=\"$file.isVideoFile(item)\"\r\n                    :src=\"$file.setFileImg(item)\"\r\n                ></video>\r\n                <el-image\r\n                    class=\"file-img\"\r\n                    :src=\"$file.setFileImg(item)\"\r\n                    :style=\"`width: ${gridSize}px; height: ${gridSize}px;`\"\r\n                    fit=\"cover\"\r\n                    v-else\r\n                />\r\n                <div\r\n                    class=\"file-name tech-file-name\"\r\n                    v-html=\"$file.getFileNameComplete(item, true)\"\r\n                ></div>\r\n                <i\r\n                    class=\"file-operate el-icon-more tech-file-operate\"\r\n                    :class=\"`operate-more-${index}`\"\r\n                    v-if=\"screenWidth <= 768\"\r\n                    @click.stop=\"handleClickMore(item, $event)\"\r\n                ></i>\r\n                <div\r\n                    class=\"file-checked-wrapper tech-checked-wrapper\"\r\n                    :class=\"{ 'tech-checked': item.checked }\"\r\n                    v-show=\"isBatchOperation\"\r\n                    @click.stop.self=\"item.checked = !item.checked\"\r\n                >\r\n                    <el-checkbox\r\n                        class=\"file-checked tech-checkbox\"\r\n                        v-model=\"item.checked\"\r\n                        @click.stop=\"item.checked = !item.checked\"\r\n                    ></el-checkbox>\r\n                </div>\r\n            </li>\r\n        </ul>\r\n        <ul class=\"right-menu-list tech-right-menu-list\">\r\n            <li class=\"right-menu-item tech-menu-item\">\r\n                <i class=\"el-icon-folder-opened\"></i> 打开\r\n            </li>\r\n            <li class=\"right-menu-item tech-menu-item\">\r\n                <i class=\"el-icon-download\"></i> 下载\r\n            </li>\r\n            </ul>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\n\r\nexport default {\r\n    name: 'FileGrid',\r\n    props: {\r\n        // 文件类型\r\n        fileType: {\r\n            required: true,\r\n            type: Number\r\n        },\r\n        // 文件路径\r\n        filePath: {\r\n            required: true,\r\n            type: String\r\n        },\r\n        fileList: Array, //  文件列表\r\n        loading: Boolean\r\n    },\r\n    data() {\r\n        return {\r\n            fileListSorted: [],\r\n            officeFileType: ['ppt', 'pptx', 'doc', 'docx', 'xls', 'xlsx'],\r\n            selectedFile: {}\r\n        }\r\n    },\r\n    computed: {\r\n        /**\r\n         * gridSize: 图标大小\r\n         *  */\r\n        ...mapGetters(['gridSize']),\r\n        // 是否批量操作\r\n        isBatchOperation() {\r\n            return this.$store.state.fileList.isBatchOperation\r\n        },\r\n        // 批量操作模式 - 被选中的文件\r\n        selectedFileList() {\r\n            let res = this.fileListSorted.filter((item) => item.checked)\r\n            return res\r\n        },\r\n        // 屏幕宽度\r\n        screenWidth() {\r\n            return this.$store.state.common.screenWidth\r\n        }\r\n    },\r\n    watch: {\r\n        // 文件平铺模式 排序-文件夹在前\r\n        fileList(newValue) {\r\n            this.fileListSorted = [...newValue]\r\n                .sort((pre, next) => {\r\n                    return next.isDir - pre.isDir\r\n                })\r\n                .map((item) => {\r\n                    return {\r\n                        ...item,\r\n                        checked: false\r\n                    }\r\n                })\r\n        },\r\n        // 批量操作模式 - 监听被选中的文件\r\n        selectedFileList(newValue) {\r\n            this.$store.commit('changeSelectedFiles', newValue)\r\n            this.$store.commit('changeIsBatchOperation', newValue.length !== 0)\r\n        }\r\n    },\r\n    methods: {\r\n        /**\r\n         * 文件鼠标右键事件\r\n         * @param {object} item 文件信息\r\n         * @param {number} index 文件索引\r\n         * @param {object} event 鼠标事件信息\r\n         */\r\n        handleContextMenu(item, index, event) {\r\n            // 阻止右键事件冒泡\r\n            event.cancelBubble = true\r\n            // xs 以上的屏幕\r\n            if (this.screenWidth > 768) {\r\n                this.selectedFile = item\r\n                if (!this.isBatchOperation) {\r\n                    event.preventDefault()\r\n                    this.$openBox\r\n                        .contextMenu({\r\n                            selectedFile: item,\r\n                            domEvent: event\r\n                        })\r\n                        .then((res) => {\r\n                            this.selectedFile = {}\r\n                            if (res === 'confirm') {\r\n                                this.$emit('getTableDataByType') //  刷新文件列表\r\n                                this.$store.dispatch('showStorage') //  刷新存储容量\r\n                            }\r\n                        })\r\n                }\r\n            }\r\n        },\r\n        /**\r\n         * 更多图标点击事件\r\n         * @description 打开右键菜单\r\n         * @param {object} item 当前行数据\r\n         * @param {object} event 当前右键元素\r\n         */\r\n        handleClickMore(item, event) {\r\n            this.selectedFile = item\r\n            if (!this.isBatchOperation) {\r\n                event.preventDefault()\r\n                this.$openBox\r\n                    .contextMenu({\r\n                        selectedFile: item,\r\n                        domEvent: event\r\n                    })\r\n                    .then((res) => {\r\n                        this.selectedFile = {}\r\n                        if (res === 'confirm') {\r\n                            this.$emit('getTableDataByType') //  刷新文件列表\r\n                            this.$store.dispatch('showStorage') //  刷新存储容量\r\n                        }\r\n                    })\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n/* ================= 赛博朋克主题变量 (继承或重新定义) ================= */\r\n@bg-dark: #0f1219;\r\n@bg-panel: rgba(26, 31, 44, 0.7);\r\n@primary-color: #00f2ff; /* Cyber Cyan */\r\n@accent-color: #7d2ae8;  /* Neon Purple */\r\n@text-main: #e2e8f0; // 浅色主文本\r\n@text-sub: #94a3b8;  // 辅助文本\r\n@border-color: rgba(255, 255, 255, 0.08); // 用于主要边框\r\n@hover-bg: rgba(0, 242, 255, 0.1); // 悬停背景\r\n@active-bg: rgba(0, 242, 255, 0.15); // 选中背景\r\n@danger-color: #ff4949; // 危险操作颜色\r\n@context-bg: rgba(30, 35, 48, 0.95); // 右键菜单背景\r\n\r\n/* Mixin for scrollbar */\r\n.setScrollbar(@width, @track-color, @thumb-color) {\r\n  &::-webkit-scrollbar {\r\n    width: @width;\r\n    height: @width;\r\n  }\r\n  &::-webkit-scrollbar-track {\r\n    background: @track-color;\r\n  }\r\n  &::-webkit-scrollbar-thumb {\r\n    background: @thumb-color;\r\n    border-radius: @width / 2;\r\n  }\r\n}\r\n\r\n.file-grid-wrapper.tech-grid-wrapper {\r\n    border-top: 1px solid @border-color; // 顶部边框\r\n    padding: 20px; // 内部填充\r\n    background-color: @bg-dark; // 使用深色背景，如果外部容器已经设置，这里可以省略\r\n    color: @text-main; // 默认文本颜色\r\n}\r\n\r\n.file-list.tech-file-list {\r\n    height: 100%; // 自动适应父容器高度\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    align-items: flex-start;\r\n    align-content: flex-start;\r\n    list-style: none;\r\n    .setScrollbar(6px, transparent, rgba(148, 163, 184, 0.4)); // 赛博朋克滚动条\r\n    padding: 0; // 重置 ul 的默认 padding\r\n    margin: 0; // 重置 ul 的默认 margin\r\n}\r\n\r\n.file-item.tech-file-item {\r\n    margin: 0 16px 16px 0;\r\n    position: relative;\r\n    padding: 12px; // 增大内边距\r\n    text-align: center;\r\n    cursor: pointer;\r\n    z-index: 1;\r\n    background-color: @bg-panel; // 文件项背景色\r\n    border: 1px solid @border-color; // 边框\r\n    border-radius: 8px; // 圆角\r\n    box-shadow: 0 0 10px rgba(0, 242, 255, 0); // 默认无光效\r\n    transition: all 0.3s ease; // 平滑过渡\r\n\r\n    video, .file-img {\r\n        border-radius: 4px; // 媒体文件和图片圆角\r\n        object-fit: contain; // 图像适应容器\r\n    }\r\n\r\n    &:hover {\r\n        background: @hover-bg; // 悬停背景\r\n        border-color: @primary-color; // 悬停边框颜色\r\n        box-shadow: 0 0 15px @primary-color; // 悬停霓虹光效\r\n        transform: translateY(-2px); // 轻微上浮\r\n        \r\n        .file-name.tech-file-name {\r\n            color: @primary-color; // 悬停文件名颜色\r\n            text-shadow: 0 0 8px rgba(0, 242, 255, 0.7); // 悬停文本光效\r\n        }\r\n    }\r\n\r\n    &.tech-active-item {\r\n        background: @active-bg; // 选中背景\r\n        border-color: @primary-color; // 选中边框颜色\r\n        box-shadow: 0 0 20px @primary-color, inset 0 0 10px @primary-color; // 选中霓虹光效\r\n        transform: scale(1.02); // 轻微放大\r\n        \r\n        .file-name.tech-file-name {\r\n            color: @primary-color; // 选中文件名颜色\r\n            font-weight: bold;\r\n            text-shadow: 0 0 10px rgba(0, 242, 255, 0.9); // 选中文本光效\r\n        }\r\n    }\r\n\r\n    .file-name.tech-file-name {\r\n        margin-top: 10px; // 调整间距\r\n        height: 44px;\r\n        line-height: 22px;\r\n        font-size: 13px; // 调整字号\r\n        color: @text-main; // 默认文件名颜色\r\n        word-break: break-all;\r\n        /* setEllipsis(2); */ // Stylus mixin，这里需要手动实现或替换\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        display: -webkit-box;\r\n        -webkit-line-clamp: 2;\r\n        -webkit-box-orient: vertical;\r\n\r\n        ::v-deep .keyword {\r\n            color: @danger-color; // 关键词高亮\r\n            font-weight: bold;\r\n            text-shadow: 0 0 5px @danger-color; // 关键词光效\r\n        }\r\n    }\r\n\r\n    .file-operate.tech-file-operate {\r\n        position: absolute;\r\n        top: 8px;\r\n        right: 8px;\r\n        font-size: 18px;\r\n        color: @text-sub;\r\n        transition: color 0.2s;\r\n\r\n        &:hover {\r\n            color: @primary-color;\r\n        }\r\n    }\r\n\r\n    .file-checked-wrapper.tech-checked-wrapper {\r\n        position: absolute;\r\n        top: 0;\r\n        left: 0;\r\n        z-index: 2;\r\n        background: rgba(0, 0, 0, 0.4); // 选中遮罩背景，略带透明\r\n        width: 100%;\r\n        height: 100%;\r\n        border-radius: 8px; // 保持与文件项一致的圆角\r\n\r\n        .file-checked.tech-checkbox {\r\n            position: absolute;\r\n            top: 10px;\r\n            left: 10px; // 调整位置\r\n\r\n            // 覆盖 Element UI Checkbox 样式\r\n            ::v-deep .el-checkbox__input.is-checked .el-checkbox__inner,\r\n            ::v-deep .el-checkbox__input.is-indeterminate .el-checkbox__inner {\r\n                background-color: @primary-color;\r\n                border-color: @primary-color;\r\n            }\r\n            ::v-deep .el-checkbox__inner {\r\n                background-color: rgba(255, 255, 255, 0.1);\r\n                border: 1px solid @primary-color;\r\n            }\r\n            ::v-deep .el-checkbox__inner:hover {\r\n                border-color: @primary-color;\r\n            }\r\n            ::v-deep .el-checkbox__input.is-checked + .el-checkbox__label {\r\n                color: @primary-color;\r\n            }\r\n        }\r\n    }\r\n\r\n    .file-checked-wrapper.tech-checked {\r\n        background: rgba(0, 0, 0, 0); // 选中后透明\r\n    }\r\n}\r\n\r\n/* ================= 右键菜单样式 (el-menu context menu) ================= */\r\n.right-menu-list.tech-right-menu-list,\r\n.unzip-list { // 如果解压菜单也是自定义的，也应用样式\r\n    background: @context-bg; // 深色半透明背景\r\n    border: 1px solid @primary-color; // 霓虹边框\r\n    border-radius: 6px; // 略微圆角\r\n    box-shadow: 0 4px 15px rgba(0, 242, 255, 0.4); // 霓虹光效阴影\r\n    color: @text-main; // 主文本颜色\r\n    padding: 6px 0; // 调整内边距\r\n}\r\n\r\n.right-menu-list.tech-right-menu-list {\r\n    // 如果这个 ul 是作为右键菜单的实际容器，其定位和显示由 JS 控制\r\n    position: fixed; // 确保是 fixed\r\n    flex-direction: column;\r\n    z-index: 1000; // 确保在最上层\r\n    display: none; // 默认隐藏，由JS控制显示\r\n}\r\n\r\n.tech-menu-item {\r\n    padding: 0 16px;\r\n    height: 38px;\r\n    line-height: 38px;\r\n    cursor: pointer;\r\n    font-size: 14px;\r\n    transition: all 0.2s ease;\r\n\r\n    &:hover {\r\n        background: @hover-bg; // 悬停背景\r\n        color: @primary-color; // 悬停文本颜色\r\n        text-shadow: 0 0 5px rgba(0, 242, 255, 0.5); // 悬停文本光效\r\n        i {\r\n            color: @primary-color; // 悬停图标颜色\r\n        }\r\n    }\r\n    i {\r\n        margin-right: 8px;\r\n        color: @accent-color; // 默认图标颜色\r\n    }\r\n}\r\n\r\n// 解压子菜单的样式，如果存在\r\n.unzip-menu-item {\r\n    position: relative;\r\n    &:hover {\r\n        .unzip-list {\r\n            display: block; // 悬停显示\r\n        }\r\n    }\r\n    .unzip-list {\r\n        position: absolute;\r\n        top: 0;\r\n        left: 100%; // 子菜单在右侧\r\n        display: none; // 默认隐藏\r\n        min-width: 180px;\r\n        .tech-menu-item(); // 继承菜单项样式\r\n    }\r\n}\r\n\r\n</style>"],"mappings":";;;;;;;;;AAiEA,IAAAA,KAAA,GAAAC,OAAA;AAAA,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEA;EACAC,IAAA;EACAC,KAAA;IACA;IACAC,QAAA;MACAC,QAAA;MACAC,IAAA,EAAAC;IACA;IACA;IACAC,QAAA;MACAH,QAAA;MACAC,IAAA,EAAAG;IACA;IACAC,QAAA,EAAAC,KAAA;IAAA;IACAC,OAAA,EAAAC;EACA;EACAC,KAAA;IACA;MACAC,cAAA;MACAC,cAAA;MACAC,YAAA;IACA;EACA;EACAC,QAAA;IACA;AACA;AACA;IACA,OAAAC,gBAAA;IACA;IACAC,iBAAA;MACA,YAAAC,MAAA,CAAAC,KAAA,CAAAZ,QAAA,CAAAU,gBAAA;IACA;IACA;IACAG,iBAAA;MACA,IAAAC,GAAA,QAAAT,cAAA,CAAAU,MAAA,CAAAC,IAAA,IAAAA,IAAA,CAAAC,OAAA;MACA,OAAAH,GAAA;IACA;IACA;IACAI,YAAA;MACA,YAAAP,MAAA,CAAAC,KAAA,CAAAO,MAAA,CAAAD,WAAA;IACA;EACA;EACAE,KAAA;IACA;IACApB,SAAAqB,QAAA;MACA,KAAAhB,cAAA,OAAAgB,QAAA,EACAC,IAAA,EAAAC,GAAA,EAAAC,IAAA;QACA,OAAAA,IAAA,CAAAC,KAAA,GAAAF,GAAA,CAAAE,KAAA;MACA,GACAC,GAAA,CAAAV,IAAA;QACA;UACA,GAAAA,IAAA;UACAC,OAAA;QACA;MACA;IACA;IACA;IACAJ,iBAAAQ,QAAA;MACA,KAAAV,MAAA,CAAAgB,MAAA,wBAAAN,QAAA;MACA,KAAAV,MAAA,CAAAgB,MAAA,2BAAAN,QAAA,CAAAO,MAAA;IACA;EACA;EACAC,OAAA;IACA;AACA;AACA;AACA;AACA;AACA;IACAC,kBAAAd,IAAA,EAAAe,KAAA,EAAAC,KAAA;MACA;MACAA,KAAA,CAAAC,YAAA;MACA;MACA,SAAAf,WAAA;QACA,KAAAX,YAAA,GAAAS,IAAA;QACA,UAAAN,gBAAA;UACAsB,KAAA,CAAAE,cAAA;UACA,KAAAC,QAAA,CACAC,WAAA;YACA7B,YAAA,EAAAS,IAAA;YACAqB,QAAA,EAAAL;UACA,GACAM,IAAA,CAAAxB,GAAA;YACA,KAAAP,YAAA;YACA,IAAAO,GAAA;cACA,KAAAyB,KAAA;cACA,KAAA5B,MAAA,CAAA6B,QAAA;YACA;UACA;QACA;MACA;IACA;IACA;AACA;AACA;AACA;AACA;AACA;IACAC,gBAAAzB,IAAA,EAAAgB,KAAA;MACA,KAAAzB,YAAA,GAAAS,IAAA;MACA,UAAAN,gBAAA;QACAsB,KAAA,CAAAE,cAAA;QACA,KAAAC,QAAA,CACAC,WAAA;UACA7B,YAAA,EAAAS,IAAA;UACAqB,QAAA,EAAAL;QACA,GACAM,IAAA,CAAAxB,GAAA;UACA,KAAAP,YAAA;UACA,IAAAO,GAAA;YACA,KAAAyB,KAAA;YACA,KAAA5B,MAAA,CAAA6B,QAAA;UACA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}