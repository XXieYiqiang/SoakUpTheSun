{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.array.push.js\");\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.find.js\");\nrequire(\"core-js/modules/es.iterator.for-each.js\");\nvar _default = exports.default = {\n  name: \"SFURoom\",\n  data() {\n    return {\n      wsUrl: \"ws://192.168.43.143:8080/room/join\",\n      roomID: \"HyqdhQ3iENDqUvpVyTcZzp\",\n      uid: \"user_\" + Math.floor(Math.random() * 1000),\n      joined: false,\n      loading: false,\n      logs: [],\n      ws: null,\n      localStream: null,\n      upPC: null,\n      // 推流 PC (PeerConnection)\n      downPC: null,\n      // 拉流 PC (单个 PC 接收房间内所有人的流)\n\n      // 存储远端流：{ \"user_123\": MediaStream 对象 }\n      remoteStreams: {}\n    };\n  },\n  methods: {\n    log(msg) {\n      const time = new Date().toLocaleTimeString();\n      this.logs.unshift(`[${time}] ${msg}`);\n      if (this.logs.length > 50) this.logs.pop();\n      console.log(`[SFU] ${msg}`);\n    },\n    async joinRoom() {\n      if (!this.roomID || !this.uid) return alert(\"请输入房间号和UID\");\n      this.loading = true;\n      try {\n        // 1. 获取摄像头和麦克风\n        this.localStream = await navigator.mediaDevices.getUserMedia({\n          video: {\n            width: 640,\n            height: 360\n          },\n          audio: true\n        });\n        this.$refs.localVideo.srcObject = this.localStream;\n        this.log(\"本地媒体流就绪\");\n\n        // 2. 连接信令服务器\n        this.connectWebSocket();\n      } catch (e) {\n        this.log(\"无法获取摄像头: \" + e.message);\n        this.loading = false;\n      }\n    },\n    connectWebSocket() {\n      const url = `${this.wsUrl}?uid=${this.uid}&roomID=${this.roomID}`;\n      this.ws = new WebSocket(url);\n      this.ws.onopen = () => {\n        this.log(\"信令通道已连接\");\n        this.joined = true;\n        this.loading = false;\n        // 连接成功后开始推流\n        this.createUpstream();\n      };\n      this.ws.onmessage = event => {\n        const msg = JSON.parse(event.data);\n        this.handleSignal(msg);\n      };\n      this.ws.onclose = () => {\n        this.log(\"信令通道关闭\");\n        this.leaveRoom(false);\n      };\n    },\n    async handleSignal(msg) {\n      const {\n        event,\n        data\n      } = msg;\n      switch (event) {\n        case \"up_answer\":\n          await this.upPC.setRemoteDescription(new RTCSessionDescription({\n            type: 'answer',\n            sdp: data.sdp\n          }));\n          this.log(\"推流协商完成 (UpAnswer)\");\n          break;\n        case \"up_candidate\":\n          if (this.upPC) await this.upPC.addIceCandidate(data.candidate);\n          break;\n        case \"down_offer\":\n          this.handleDownOffer(data);\n          break;\n        case \"down_candidate\":\n          if (this.downPC) await this.downPC.addIceCandidate(data.candidate);\n          break;\n        case \"user_leave\":\n        case \"unpublish_stream\":\n          // 处理用户离开或停止推流\n          const targetId = data.uid || data.publisherId;\n          this.removeRemoteUser(targetId);\n          break;\n      }\n    },\n    // ================= 推流 (Publish) =================\n    async createUpstream() {\n      this.log(\"准备建立推流连接...\");\n      this.upPC = new RTCPeerConnection({\n        iceServers: [{\n          urls: \"stun:stun.l.google.com:19302\"\n        }]\n      });\n\n      // 添加轨道\n      this.localStream.getTracks().forEach(track => {\n        this.upPC.addTrack(track, this.localStream);\n      });\n      this.upPC.onicecandidate = e => {\n        if (e.candidate) this.sendSignal(\"up_candidate\", {\n          candidate: e.candidate\n        });\n      };\n      const offer = await this.upPC.createOffer();\n      await this.upPC.setLocalDescription(offer);\n      this.sendSignal(\"up_offer\", {\n        uid: this.uid,\n        sdp: offer.sdp\n      });\n    },\n    // ================= 拉流 (Subscribe) =================\n    async handleDownOffer(data) {\n      if (!this.downPC) this.initDownPC();\n      this.log(`收到订阅通知，来自流 ID: ${data.from}`);\n      try {\n        await this.downPC.setRemoteDescription(new RTCSessionDescription({\n          type: 'offer',\n          sdp: data.sdp\n        }));\n        const answer = await this.downPC.createAnswer();\n        await this.downPC.setLocalDescription(answer);\n        this.sendSignal(\"down_answer\", {\n          sdp: answer.sdp\n        });\n      } catch (e) {\n        this.log(\"拉流协商失败: \" + e.message);\n      }\n    },\n    // initDownPC() {\n    //   this.downPC = new RTCPeerConnection({\n    //     iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }]\n    //   });\n\n    //   this.downPC.onicecandidate = (e) => {\n    //     if (e.candidate) this.sendSignal(\"down_candidate\", { candidate: e.candidate });\n    //   };\n\n    //   // 【核心逻辑】绑定远端流到 UID\n    //   this.downPC.ontrack = (event) => {\n    //     // 后端 NewTrackLocalStaticRTP 的 streamID 会出现在 event.streams[0].id\n    //     const stream = event.streams[0];\n    //     if (!stream) return;\n\n    //     console.log('stream=={}',stream)\n\n    //     const remoteUid = stream.id; \n    //     this.log(`检测到远端轨道 [${event.track.kind}], 归属用户: ${remoteUid}`);\n\n    //     // Vue 2 响应式更新：如果该 UID 对应的流不存在，则添加\n    //     if (!this.remoteStreams[remoteUid]) {\n    //       this.$set(this.remoteStreams, remoteUid, stream);\n    //     }\n    //   };\n    // },\n    // ✅ 队列化处理 Offer，确保顺序\n    async enqueueDownOffer(data) {\n      this.offerQueue.push(data);\n      if (this.isDownNegotiating) return;\n      while (this.offerQueue.length > 0) {\n        const currentOffer = this.offerQueue.shift();\n        await this.processDownOffer(currentOffer);\n      }\n    },\n    async processDownOffer(data) {\n      if (!this.downPC) this.initDownPC();\n      this.isDownNegotiating = true;\n      this.log(`开始处理协商: 来自 ${data.from}`);\n      try {\n        // 1. 设置远端描述\n        await this.downPC.setRemoteDescription(new RTCSessionDescription({\n          type: 'offer',\n          sdp: data.sdp\n        }));\n\n        // 2. 创建并设置本地 Answer\n        const answer = await this.downPC.createAnswer();\n        await this.downPC.setLocalDescription(answer);\n\n        // 3. 反馈给后端\n        this.sendSignal(\"down_answer\", {\n          sdp: answer.sdp\n        });\n        this.log(\"协商成功，等待轨道同步...\");\n      } catch (e) {\n        this.log(\"协商流程异常: \" + e.message);\n      } finally {\n        // 给予浏览器一小段缓冲时间\n        await new Promise(resolve => setTimeout(resolve, 100));\n        this.isDownNegotiating = false;\n      }\n    },\n    async handleRemoteCandidate(pc, candidateInit) {\n      try {\n        if (pc && pc.remoteDescription && pc.remoteDescription.type) {\n          await pc.addIceCandidate(new RTCIceCandidate(candidateInit));\n        } else {\n          // 如果 SDP 还没准备好，可以存入临时数组，待 setRemoteDescription 后再添加\n          this.log(\"收到 Candidate 但 PC 尚未就绪，忽略或缓存\");\n        }\n      } catch (e) {\n        console.error(\"添加 Candidate 失败\", e);\n      }\n    },\n    initDownPC() {\n      this.downPC = new RTCPeerConnection({\n        iceServers: [{\n          urls: \"stun:stun.l.google.com:19302\"\n        }]\n      });\n      this.downPC.onicecandidate = e => {\n        if (e.candidate) this.sendSignal(\"down_candidate\", {\n          candidate: e.candidate\n        });\n      };\n      this.downPC.ontrack = event => {\n        // 重点：获取 Stream ID\n        const stream = event.streams[0];\n        if (!stream) return;\n        const remoteUid = stream.id;\n        this.log(`轨道就绪 [${event.track.kind}] 用户: ${remoteUid}`);\n\n        // Vue 2 响应式更新\n        if (!this.remoteStreams[remoteUid]) {\n          this.$set(this.remoteStreams, remoteUid, stream);\n        } else {\n          // 如果流已存在，但新轨道（如视频）刚加进来，确保视图刷新\n          const oldStream = this.remoteStreams[remoteUid];\n          if (!oldStream.getTracks().find(t => t.id === event.track.id)) {\n            oldStream.addTrack(event.track);\n          }\n        }\n      };\n\n      // 监控连接状态\n      this.downPC.onconnectionstatechange = () => {\n        this.log(`连接状态变化: ${this.downPC.connectionState}`);\n      };\n    },\n    removeRemoteUser(uid) {\n      if (this.remoteStreams[uid]) {\n        this.log(`清理用户流: ${uid}`);\n        this.$delete(this.remoteStreams, uid);\n      }\n    },\n    sendSignal(event, data) {\n      if (this.ws?.readyState === WebSocket.OPEN) {\n        this.ws.send(JSON.stringify({\n          event,\n          data\n        }));\n      }\n    },\n    leaveRoom(closeWs = true) {\n      this.joined = false;\n      if (this.upPC) this.upPC.close();\n      if (this.downPC) this.downPC.close();\n      if (this.localStream) this.localStream.getTracks().forEach(t => t.stop());\n      if (closeWs && this.ws) this.ws.close();\n      this.remoteStreams = {};\n      this.upPC = null;\n      this.downPC = null;\n      this.log(\"已离开房间并清理资源\");\n    }\n  },\n  beforeDestroy() {\n    this.leaveRoom();\n  }\n};","map":{"version":3,"names":["name","data","wsUrl","roomID","uid","Math","floor","random","joined","loading","logs","ws","localStream","upPC","downPC","remoteStreams","methods","log","msg","time","Date","toLocaleTimeString","unshift","length","pop","console","joinRoom","alert","navigator","mediaDevices","getUserMedia","video","width","height","audio","$refs","localVideo","srcObject","connectWebSocket","e","message","url","WebSocket","onopen","createUpstream","onmessage","event","JSON","parse","handleSignal","onclose","leaveRoom","setRemoteDescription","RTCSessionDescription","type","sdp","addIceCandidate","candidate","handleDownOffer","targetId","publisherId","removeRemoteUser","RTCPeerConnection","iceServers","urls","getTracks","forEach","track","addTrack","onicecandidate","sendSignal","offer","createOffer","setLocalDescription","initDownPC","from","answer","createAnswer","enqueueDownOffer","offerQueue","push","isDownNegotiating","currentOffer","shift","processDownOffer","Promise","resolve","setTimeout","handleRemoteCandidate","pc","candidateInit","remoteDescription","RTCIceCandidate","error","ontrack","stream","streams","remoteUid","id","kind","$set","oldStream","find","t","onconnectionstatechange","connectionState","$delete","readyState","OPEN","send","stringify","closeWs","close","stop","beforeDestroy"],"sources":["src/views/utils/test2.vue"],"sourcesContent":["<template>\r\n  <div class=\"sfu-room\">\r\n    <div class=\"controls\">\r\n      <h2>SFU 视频会议 (Vue 2 - ID 绑定版)</h2>\r\n      <div v-if=\"!joined\" class=\"login-form\">\r\n        <input v-model=\"roomID\" placeholder=\"房间号\" />\r\n        <input v-model=\"uid\" placeholder=\"我的UID\" />\r\n        <button @click=\"joinRoom\" :disabled=\"loading\">进入房间</button>\r\n      </div>\r\n      <div v-else class=\"actions\">\r\n        <span>房间: <b>{{ roomID }}</b> | 我的UID: <b>{{ uid }}</b></span>\r\n        <button class=\"btn-leave\" @click=\"leaveRoom\">离开房间</button>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"video-grid\">\r\n      <div class=\"video-card local\">\r\n        <video ref=\"localVideo\" autoplay playsinline muted></video>\r\n        <div class=\"label\">我 ({{ uid }})</div>\r\n      </div>\r\n\r\n      <div \r\n        v-for=\"(stream, remoteUid) in remoteStreams\" \r\n        :key=\"remoteUid\" \r\n        class=\"video-card remote\"\r\n      >\r\n        <video :src-object.prop=\"stream\" autoplay playsinline muted></video>\r\n        <div class=\"label\">\r\n          用户: {{ remoteUid }}\r\n          <span class=\"status-tag\">已同步</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"logs\">\r\n      <div v-for=\"(log, i) in logs\" :key=\"i\" class=\"log-item\">\r\n        {{ log }}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"SFURoom\",\r\n  data() {\r\n    return {\r\n      wsUrl: \"ws://192.168.43.143:8080/room/join\", \r\n      roomID: \"HyqdhQ3iENDqUvpVyTcZzp\",\r\n      uid: \"user_\" + Math.floor(Math.random() * 1000),\r\n      \r\n      joined: false,\r\n      loading: false,\r\n      logs: [],\r\n\r\n      ws: null,\r\n      localStream: null,\r\n      upPC: null,   // 推流 PC (PeerConnection)\r\n      downPC: null, // 拉流 PC (单个 PC 接收房间内所有人的流)\r\n      \r\n      // 存储远端流：{ \"user_123\": MediaStream 对象 }\r\n      remoteStreams: {} \r\n    };\r\n  },\r\n  methods: {\r\n    log(msg) {\r\n      const time = new Date().toLocaleTimeString();\r\n      this.logs.unshift(`[${time}] ${msg}`);\r\n      if (this.logs.length > 50) this.logs.pop();\r\n      console.log(`[SFU] ${msg}`);\r\n    },\r\n\r\n    async joinRoom() {\r\n      if (!this.roomID || !this.uid) return alert(\"请输入房间号和UID\");\r\n      this.loading = true;\r\n\r\n      try {\r\n        // 1. 获取摄像头和麦克风\r\n        this.localStream = await navigator.mediaDevices.getUserMedia({\r\n          video: { width: 640, height: 360 },\r\n          audio: true\r\n        });\r\n        this.$refs.localVideo.srcObject = this.localStream;\r\n        this.log(\"本地媒体流就绪\");\r\n\r\n        // 2. 连接信令服务器\r\n        this.connectWebSocket();\r\n      } catch (e) {\r\n        this.log(\"无法获取摄像头: \" + e.message);\r\n        this.loading = false;\r\n      }\r\n    },\r\n\r\n    connectWebSocket() {\r\n      const url = `${this.wsUrl}?uid=${this.uid}&roomID=${this.roomID}`;\r\n      this.ws = new WebSocket(url);\r\n\r\n      this.ws.onopen = () => {\r\n        this.log(\"信令通道已连接\");\r\n        this.joined = true;\r\n        this.loading = false;\r\n        // 连接成功后开始推流\r\n        this.createUpstream();\r\n      };\r\n\r\n      this.ws.onmessage = (event) => {\r\n        const msg = JSON.parse(event.data);\r\n        this.handleSignal(msg);\r\n      };\r\n\r\n      this.ws.onclose = () => {\r\n        this.log(\"信令通道关闭\");\r\n        this.leaveRoom(false);\r\n      };\r\n    },\r\n\r\n    async handleSignal(msg) {\r\n      const { event, data } = msg;\r\n\r\n      switch (event) {\r\n        case \"up_answer\":\r\n          await this.upPC.setRemoteDescription(new RTCSessionDescription({ type: 'answer', sdp: data.sdp }));\r\n          this.log(\"推流协商完成 (UpAnswer)\");\r\n          break;\r\n\r\n        case \"up_candidate\":\r\n          if (this.upPC) await this.upPC.addIceCandidate(data.candidate);\r\n          break;\r\n\r\n        case \"down_offer\":\r\n          this.handleDownOffer(data);\r\n          break;\r\n\r\n        case \"down_candidate\":\r\n          if (this.downPC) await this.downPC.addIceCandidate(data.candidate);\r\n          break;\r\n\r\n        case \"user_leave\":\r\n        case \"unpublish_stream\":\r\n          // 处理用户离开或停止推流\r\n          const targetId = data.uid || data.publisherId;\r\n          this.removeRemoteUser(targetId);\r\n          break;\r\n      }\r\n    },\r\n\r\n    // ================= 推流 (Publish) =================\r\n    async createUpstream() {\r\n      this.log(\"准备建立推流连接...\");\r\n      this.upPC = new RTCPeerConnection({\r\n        iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }]\r\n      });\r\n\r\n      // 添加轨道\r\n      this.localStream.getTracks().forEach(track => {\r\n        this.upPC.addTrack(track, this.localStream);\r\n      });\r\n\r\n      this.upPC.onicecandidate = (e) => {\r\n        if (e.candidate) this.sendSignal(\"up_candidate\", { candidate: e.candidate });\r\n      };\r\n\r\n      const offer = await this.upPC.createOffer();\r\n      await this.upPC.setLocalDescription(offer);\r\n      this.sendSignal(\"up_offer\", { uid: this.uid, sdp: offer.sdp });\r\n    },\r\n\r\n    // ================= 拉流 (Subscribe) =================\r\n    async handleDownOffer(data) {\r\n      if (!this.downPC) this.initDownPC();\r\n\r\n      this.log(`收到订阅通知，来自流 ID: ${data.from}`);\r\n      \r\n      try {\r\n        await this.downPC.setRemoteDescription(new RTCSessionDescription({ type: 'offer', sdp: data.sdp }));\r\n        const answer = await this.downPC.createAnswer();\r\n        await this.downPC.setLocalDescription(answer);\r\n        this.sendSignal(\"down_answer\", { sdp: answer.sdp });\r\n      } catch (e) {\r\n        this.log(\"拉流协商失败: \" + e.message);\r\n      }\r\n    },\r\n\r\n    // initDownPC() {\r\n    //   this.downPC = new RTCPeerConnection({\r\n    //     iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }]\r\n    //   });\r\n\r\n    //   this.downPC.onicecandidate = (e) => {\r\n    //     if (e.candidate) this.sendSignal(\"down_candidate\", { candidate: e.candidate });\r\n    //   };\r\n\r\n    //   // 【核心逻辑】绑定远端流到 UID\r\n    //   this.downPC.ontrack = (event) => {\r\n    //     // 后端 NewTrackLocalStaticRTP 的 streamID 会出现在 event.streams[0].id\r\n    //     const stream = event.streams[0];\r\n    //     if (!stream) return;\r\n\r\n    //     console.log('stream=={}',stream)\r\n\r\n    //     const remoteUid = stream.id; \r\n    //     this.log(`检测到远端轨道 [${event.track.kind}], 归属用户: ${remoteUid}`);\r\n\r\n    //     // Vue 2 响应式更新：如果该 UID 对应的流不存在，则添加\r\n    //     if (!this.remoteStreams[remoteUid]) {\r\n    //       this.$set(this.remoteStreams, remoteUid, stream);\r\n    //     }\r\n    //   };\r\n    // },\r\n    // ✅ 队列化处理 Offer，确保顺序\r\n    async enqueueDownOffer(data) {\r\n      this.offerQueue.push(data);\r\n      if (this.isDownNegotiating) return;\r\n\r\n      while (this.offerQueue.length > 0) {\r\n        const currentOffer = this.offerQueue.shift();\r\n        await this.processDownOffer(currentOffer);\r\n      }\r\n    },\r\n    async processDownOffer(data) {\r\n      if (!this.downPC) this.initDownPC();\r\n      \r\n      this.isDownNegotiating = true;\r\n      this.log(`开始处理协商: 来自 ${data.from}`);\r\n\r\n      try {\r\n        // 1. 设置远端描述\r\n        await this.downPC.setRemoteDescription(new RTCSessionDescription({ \r\n          type: 'offer', \r\n          sdp: data.sdp \r\n        }));\r\n\r\n        // 2. 创建并设置本地 Answer\r\n        const answer = await this.downPC.createAnswer();\r\n        await this.downPC.setLocalDescription(answer);\r\n\r\n        // 3. 反馈给后端\r\n        this.sendSignal(\"down_answer\", { sdp: answer.sdp });\r\n        this.log(\"协商成功，等待轨道同步...\");\r\n      } catch (e) {\r\n        this.log(\"协商流程异常: \" + e.message);\r\n      } finally {\r\n        // 给予浏览器一小段缓冲时间\r\n        await new Promise(resolve => setTimeout(resolve, 100));\r\n        this.isDownNegotiating = false;\r\n      }\r\n    },\r\n    async handleRemoteCandidate(pc, candidateInit) {\r\n      try {\r\n        if (pc && pc.remoteDescription && pc.remoteDescription.type) {\r\n          await pc.addIceCandidate(new RTCIceCandidate(candidateInit));\r\n        } else {\r\n          // 如果 SDP 还没准备好，可以存入临时数组，待 setRemoteDescription 后再添加\r\n          this.log(\"收到 Candidate 但 PC 尚未就绪，忽略或缓存\");\r\n        }\r\n      } catch (e) {\r\n        console.error(\"添加 Candidate 失败\", e);\r\n      }\r\n    },\r\n    initDownPC() {\r\n      this.downPC = new RTCPeerConnection({\r\n        iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }]\r\n      });\r\n\r\n      this.downPC.onicecandidate = (e) => {\r\n        if (e.candidate) this.sendSignal(\"down_candidate\", { candidate: e.candidate });\r\n      };\r\n\r\n      this.downPC.ontrack = (event) => {\r\n        // 重点：获取 Stream ID\r\n        const stream = event.streams[0];\r\n        if (!stream) return;\r\n\r\n        const remoteUid = stream.id; \r\n        this.log(`轨道就绪 [${event.track.kind}] 用户: ${remoteUid}`);\r\n\r\n        // Vue 2 响应式更新\r\n        if (!this.remoteStreams[remoteUid]) {\r\n          this.$set(this.remoteStreams, remoteUid, stream);\r\n        } else {\r\n          // 如果流已存在，但新轨道（如视频）刚加进来，确保视图刷新\r\n          const oldStream = this.remoteStreams[remoteUid];\r\n          if (!oldStream.getTracks().find(t => t.id === event.track.id)) {\r\n             oldStream.addTrack(event.track);\r\n          }\r\n        }\r\n      };\r\n      \r\n      // 监控连接状态\r\n      this.downPC.onconnectionstatechange = () => {\r\n        this.log(`连接状态变化: ${this.downPC.connectionState}`);\r\n      };\r\n    },\r\n\r\n    removeRemoteUser(uid) {\r\n      if (this.remoteStreams[uid]) {\r\n        this.log(`清理用户流: ${uid}`);\r\n        this.$delete(this.remoteStreams, uid);\r\n      }\r\n    },\r\n\r\n    sendSignal(event, data) {\r\n      if (this.ws?.readyState === WebSocket.OPEN) {\r\n        this.ws.send(JSON.stringify({ event, data }));\r\n      }\r\n    },\r\n\r\n    leaveRoom(closeWs = true) {\r\n      this.joined = false;\r\n      if (this.upPC) this.upPC.close();\r\n      if (this.downPC) this.downPC.close();\r\n      if (this.localStream) this.localStream.getTracks().forEach(t => t.stop());\r\n      if (closeWs && this.ws) this.ws.close();\r\n      this.remoteStreams = {};\r\n      this.upPC = null;\r\n      this.downPC = null;\r\n      this.log(\"已离开房间并清理资源\");\r\n    }\r\n  },\r\n  beforeDestroy() {\r\n    this.leaveRoom();\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.sfu-room { font-family: sans-serif; padding: 20px; background: #f4f7f9; min-height: 100vh; }\r\n.controls { background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }\r\n.login-form input { padding: 8px; margin-right: 10px; border: 1px solid #ccc; border-radius: 4px; }\r\nbutton { padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }\r\nbutton:hover { background: #0056b3; }\r\n.btn-leave { background: #dc3545; margin-left: 10px; }\r\n\r\n.video-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; }\r\n.video-card { background: #1a1a1a; border-radius: 10px; overflow: hidden; aspect-ratio: 16/9; position: relative; }\r\nvideo { width: 100%; height: 100%; object-fit: cover; }\r\n.local video { transform: scaleX(-1); }\r\n\r\n.label { position: absolute; bottom: 10px; left: 10px; background: rgba(0,0,0,0.7); color: white; padding: 4px 10px; border-radius: 20px; font-size: 12px; display: flex; align-items: center; }\r\n.status-tag { margin-left: 8px; color: #4caf50; font-weight: bold; }\r\n\r\n.logs { margin-top: 30px; background: #222; color: #00ff00; padding: 15px; height: 200px; overflow-y: auto; font-family: monospace; font-size: 12px; border-radius: 5px; }\r\n.log-item { margin-bottom: 4px; border-bottom: 1px solid #333; padding-bottom: 2px; }\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}