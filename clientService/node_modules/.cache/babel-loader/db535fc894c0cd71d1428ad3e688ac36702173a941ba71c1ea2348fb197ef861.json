{"ast":null,"code":"const state = {\n  token: localStorage.getItem('token') || '',\n  userInfo: (() => {\n    try {\n      return JSON.parse(localStorage.getItem('userInfo'));\n    } catch (e) {\n      console.error('解析 userInfo 失败', e);\n      return null; // 或返回默认空对象 {}\n    }\n  })()\n};\n\n//store.commit('user/CLEAR_USER');\nconst mutations = {\n  SET_TOKEN(state, token) {\n    state.token = token;\n    localStorage.setItem('token', token);\n  },\n  SET_USER_INFO(state, userInfo) {\n    state.userInfo = userInfo;\n    localStorage.setItem('userInfo', JSON.stringify(userInfo));\n  },\n  CLEAR_USER(state) {\n    state.token = '';\n    state.userInfo = null;\n    localStorage.removeItem('token');\n    localStorage.removeItem('userInfo');\n  }\n};\n\n//this.$store.dispatch('user/logout');\nconst actions = {\n  login({\n    commit\n  }, {\n    token,\n    userInfo\n  }) {\n    commit('SET_TOKEN', token);\n    commit('SET_USER_INFO', userInfo);\n  },\n  logout({\n    commit,\n    dispatch\n  }) {\n    commit('CLEAR_USER');\n    commit('message/CLEAR_USER_LIST', null, {\n      root: true\n    });\n  }\n};\n\n// const userInfo = this.$store.getters['user/userInfo'];\nconst getters = {\n  isLogin: state => !!state.token,\n  token: state => state.token,\n  userInfo: state => state.userInfo\n};\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions,\n  getters\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}