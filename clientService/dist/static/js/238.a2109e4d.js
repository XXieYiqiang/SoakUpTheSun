"use strict";(self["webpackChunkgim_chat"]=self["webpackChunkgim_chat"]||[]).push([[238],{3238:function(t,e,a){a.r(e),a.d(e,{default:function(){return g}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container tech-container"},[t._m(0),e("div",{staticClass:"content"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:7}},[e("el-card",{staticClass:"tech-card"},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("i",{staticClass:"el-icon-edit-outline tech-icon"}),e("span",[t._v("提示词设置 ")])]),e("div",{staticClass:"form-container"},[e("el-form",{ref:"form",staticClass:"tech-form",attrs:{model:t.formData,"label-width":"100px","label-position":t.labelPosition}},[e("el-form-item",{attrs:{label:"视频标题",prop:"title"}},[e("el-input",{staticClass:"tech-input",attrs:{placeholder:"输入视频标题"},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),e("el-form-item",{attrs:{label:"视频描述",prop:"userPrompt"}},[e("el-input",{staticClass:"tech-input",attrs:{type:"textarea",placeholder:"请输入视频描述",rows:"4"},model:{value:t.formData.userPrompt,callback:function(e){t.$set(t.formData,"userPrompt",e)},expression:"formData.userPrompt"}})],1),e("el-form-item",{attrs:{label:"视频风格",prop:"videoStyle"}},[e("el-select",{staticClass:"tech-select",staticStyle:{width:"100%"},attrs:{placeholder:"写实风格"},model:{value:t.formData.videoStyle,callback:function(e){t.$set(t.formData,"videoStyle",e)},expression:"formData.videoStyle"}},[e("el-option",{attrs:{label:"写实风格",value:"写实风格"}}),e("el-option",{attrs:{label:"卡通风格",value:"卡通风格"}}),e("el-option",{attrs:{label:"未来感风格",value:"未来感风格"}})],1)],1),e("el-form-item",{attrs:{label:"视频长度",prop:"videoLength"}},[e("el-select",{staticClass:"tech-select",staticStyle:{width:"100%"},attrs:{placeholder:"短片 (10s)"},model:{value:t.formData.videoLength,callback:function(e){t.$set(t.formData,"videoLength",e)},expression:"formData.videoLength"}},[e("el-option",{attrs:{label:"短片 (10s)",value:"10"}}),e("el-option",{attrs:{label:"中等长度 (15s)",value:"15"}}),e("el-option",{attrs:{label:"长片 (30s)",value:"30"}})],1)],1)],1)],1)]),e("el-card",{staticClass:"tech-card",staticStyle:{"margin-top":"20px"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("i",{staticClass:"el-icon-paperclip tech-icon"}),e("span",[t._v("文件上传")])]),e("el-upload",{staticClass:"tech-upload-area",attrs:{drag:"",action:"https://jsonplaceholder.typicode.com/posts/",multiple:""}},[e("i",{staticClass:"el-icon-upload"}),e("div",{staticClass:"el-upload__text",staticStyle:{width:"260px"}},[t._v("将文件拖到此处，或"),e("em",{staticClass:"neon-text-primary"},[t._v("点击上传")])])])],1),e("el-card",{staticClass:"tech-card",staticStyle:{"margin-top":"20px"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("i",{staticClass:"el-icon-s-tools tech-icon"}),e("span",[t._v("操作控制")])]),e("div",[e("el-button",{staticClass:"tech-button primary-btn",attrs:{type:"primary"},nativeOn:{click:function(e){return t.getVideoPrompt.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-cpu"}),t._v(" 生成提示词 ")])],1),e("div",[e("el-button",{staticClass:"tech-button primary-btn",nativeOn:{click:function(e){return t.saveFormData.apply(null,arguments)}}},[t._v("保存草稿")])],1),e("div",[e("el-button",{staticClass:"tech-button primary-btn",nativeOn:{click:function(e){return t.clearData.apply(null,arguments)}}},[t._v("清空内容")])],1),e("div",[e("el-button",{staticClass:"tech-button primary-btn",attrs:{type:"primary"},nativeOn:{click:function(e){return t.generateVideo.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-cpu"}),t._v(" 生成视频 ")])],1)])],1),e("el-col",{attrs:{span:17}},[e("el-card",{staticClass:"tech-card"},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("i",{staticClass:"el-icon-view tech-icon"}),e("span",[t._v("视频预览 ")])]),e("div",{staticClass:"preview-box"},[e("video-player",{key:t.videoKey,ref:"videoPlayer",staticClass:"video-player",attrs:{options:t.playerOptions,playsinline:!0,preload:!0,autoplay:!0,loop:!0,muted:!0}})],1)]),e("el-card",{staticClass:"tech-card",staticStyle:{"margin-top":"20px"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("i",{staticClass:"el-icon-s-operation tech-icon"}),e("span")]),e("el-timeline",{staticClass:"tech-timeline"},t._l(t.timelineData,function(a,s){return e("el-timeline-item",{key:s,attrs:{timestamp:t.getSegmentTimestamp(a),placement:"top"}},[e("el-card",{staticClass:"timeline-card"},[e("el-button",{staticClass:"copy-button",attrs:{type:"text",icon:"el-icon-document-copy"},on:{click:function(e){return t.copySegmentData(a)}}},[t._v(" 复制 ")]),e("span",{staticClass:"segment-title"},[t._v(t._s(a.segmentTitle))]),e("p",{staticClass:"segment-description-long"},[t._v(t._s(a.segmentDescription))]),e("div",{staticClass:"segment-detail-divider"}),e("div",{staticClass:"segment-details-grid"},[e("p",{staticClass:"segment-param"},[e("span",{staticClass:"param-label"},[t._v("关键字:")]),e("span",{staticClass:"param-value neon-text-accent"},[t._v(t._s(a.segmentKeywords))])]),e("p",{staticClass:"segment-param"},[e("span",{staticClass:"param-label"},[t._v("风格:")]),e("span",{staticClass:"param-value"},[t._v(t._s(a.shardingStyle))])]),e("p",{staticClass:"segment-param"},[e("span",{staticClass:"param-label"},[t._v("构图:")]),e("span",{staticClass:"param-value"},[t._v(t._s(a.fragmentedComposition))])]),e("p",{staticClass:"segment-param"},[e("span",{staticClass:"param-label"},[t._v("光影:")]),e("span",{staticClass:"param-value"},[t._v(t._s(a.fragmentedLightAndShadow))])]),e("p",{staticClass:"segment-param"},[e("span",{staticClass:"param-label"},[t._v("运镜:")]),e("span",{staticClass:"param-value"},[t._v(t._s(a.fragmentedCameraMovement))])])])],1)],1)}),1)],1),e("el-card",{staticClass:"tech-card",staticStyle:{"margin-top":"20px"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("i",{staticClass:"el-icon-folder-checked tech-icon"}),e("span",[t._v("最近完成 (RECENT LOG)")])])])],1)],1)],1)])},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"header"},[e("h2",{staticClass:"neon-title"},[t._v("AI 视频制作 "),e("span",{staticClass:"sub-text"})]),e("p",{staticClass:"sub-text"},[t._v("通过AI技术，只需输入视频标题，即可快速生成高清画质视频，支持自定义片段，实时预览效果。")])])}],l=a(35720);const o=t=>(0,l.A)({method:"post",url:"/api/ai/video/createPrompt",data:t}),r=t=>(0,l.A)({method:"post",url:"/api/ai/video/createVideo",data:t}),n=t=>(0,l.A)({method:"get",url:"/api/ai/video/queryResult",params:t});var c={data(){return{startTime:null,taskId:null,labelPosition:"top",formData:{title:"美女跳舞",userPrompt:"美女跳舞",videoStyle:"写实风格",videoLength:"15"},videoKey:0,playerOptions:{techOrder:["html5"],sources:[{type:"video/mp4",src:"https://tempfile.aiquickdraw.com/r/5407877d-1beb-450f-9f98-d250134c32fa_watermarked.mp4"}],poster:"https://vjs.zencdn.net/v/oceans.png",controls:!0,controlBar:{children:["playToggle","volumePanel","timeDivider","progressControl","fullscreenToggle"],align:"center"}},timelineData:[{segmentTitle:"片段 1：未来都市景观",beginTime:"0",endTime:"5",segmentDescription:"清晨，一架赛博朋克风格的无人机缓缓飞过未来都市的高耸入云的摩天大楼群。城市被浓雾笼罩，霓虹灯尚未熄灭，地面湿润反射着灯光。要求画面有极高的细节分辨率，色彩饱和度高。",segmentKeywords:"无人机, 赛博朋克, 霓虹灯, 摩天大楼",shardingStyle:"超现实写实风格",fragmentedComposition:"大景深航拍全景",fragmentedLightAndShadow:"强对比丁达尔光束",fragmentedCameraMovement:"慢速推拉摇移 (Dolly Zoom)"},{segmentTitle:"片段 2：街头武者对决",beginTime:"5",endTime:"10",segmentDescription:"一名身穿铠甲的武者在雨夜的日式街头与机械敌人对峙。武者拔出武士刀，动作干净利落，背景有破碎的全息广告牌。",segmentKeywords:"武士, 战斗, 雨夜, 全息投影, 机械敌人",shardingStyle:"卡通渲染 (Cel Shading)",fragmentedComposition:"中景特写，低角度拍摄",fragmentedLightAndShadow:"高光强调，水面反射光",fragmentedCameraMovement:"高速环绕运镜 (Orbit Shot)"},{segmentTitle:"片段 3：数据流涌动",beginTime:"10",endTime:"15",segmentDescription:"一个身着黑客服饰的女子，双手触摸着布满蓝色数据流的墙壁。画面主体清晰，背景虚焦，突出数据流动的动态感。",segmentKeywords:"黑客, 数据流, 蓝色, 动态",shardingStyle:"未来感风格",fragmentedComposition:"特写景别，三分法构图",fragmentedLightAndShadow:"环境光，蓝色背光",fragmentedCameraMovement:"稳定慢速平移 (Tracking Shot)"}]}},methods:{async generateVideo(){const t={segmentInfoList:this.timelineData},e=await r(t);console.log("respData",e),200==e.data.code&&e.data.data?(this.taskId=e.data.data,console.log("this.taskId =",this.taskId),this.startPollingTask(),this.$message({message:"操作成功！视频生成任务已开始！",type:"success",duration:3e3})):this.$message({message:"操作失败，请稍后进行重试！",type:"error",duration:3e3})},startPollingTask(){const t=this;console.log("taskId=begin",t.taskId),this.taskInterval=setInterval(async()=>{console.log("taskId=end",t.taskId);const e={taskId:t.taskId};console.log("param=",e);const a=await n(e);if(console.log("[startPollingTask]respData=",a),200==a.data.code&&a.data.data)console.log("视频url:",a.data.data),this.videoKey+=1,this.$set(this.playerOptions.sources,0,{type:"video/mp4",src:a.data.data}),console.log("图片视频url:",this.playerOptions.sources[0].src),clearInterval(this.taskInterval),this.$message({message:"视频生成完成！",type:"success",duration:3e3});else{const t=a.message;"2"===t?(clearInterval(this.taskInterval),this.$message.error("任务生成失败")):"3"===t?(clearInterval(this.taskInterval),log.info("操作失败，任务创建成功但生成失败"),this.$message.error("任务创建成功但生成失败")):"-1"===t&&(clearInterval(this.taskInterval),log.info("操作失败，请稍后重试！"),this.$message.error("操作失败，请稍后重试！"))}this.startTime||(this.startTime=(new Date).getTime());const s=(new Date).getTime();s-this.startTime>6e5&&(clearInterval(this.taskInterval),this.$message({message:"操作失败，视频生成超时，已停止查询结果。",type:"error",duration:3e3}))},8e3)},stopPollingTask(){this.taskInterval&&clearInterval(this.taskInterval)},saveFormData(){const t=this.$store.getters["user/token"];localStorage.setItem("formData="+t,JSON.stringify(this.formData)),this.$message({message:"数据已保存！",type:"success",duration:3e3})},loadFormData(){const t=this.$store.getters["user/token"],e=localStorage.getItem("formData="+t);e&&(this.formData=JSON.parse(e))},clearData(){this.formData={title:"",userPrompt:"",videoStyle:"",videoLength:""};const t=this.$store.getters["user/token"];localStorage.removeItem("formData="+t)},async getVideoPrompt(){console.log("getVideoPrompt");let t={...this.formData};const e=await o(t);console.log("resData=",e),200==e.data.code&&e.data.data&&e.data.data.length>0?(this.timelineData=e.data.data,this.$message({message:"提示词已生成，分片信息已更新！",type:"success",duration:3e3})):this.$message({message:"提示词生成失败或数据为空。",type:"error",duration:3e3})},copySegmentData(t){const e=[`分片标题：${t.segmentTitle}`,`详细的画面描述：${t.segmentDescription}`,`关键字：${t.segmentKeywords}`,`风格：${t.shardingStyle}`,`构图描述：${t.fragmentedComposition}`,`光影描述：${t.fragmentedLightAndShadow}`,`运镜描述：${t.fragmentedCameraMovement}`].join("\n");navigator.clipboard?navigator.clipboard.writeText(e).then(()=>{this.$message({message:"分片信息已成功复制到剪贴板！",type:"success",duration:2e3})}).catch(t=>{this.$message({message:`复制失败：${t}`,type:"error",duration:3e3})}):this.$message({message:"您的浏览器不支持 navigator.clipboard，请手动复制。",type:"warning",duration:4e3})},formatSecondsToTime(t){const e=parseInt(t);if(isNaN(e)||e<0)return"00:00";const a=Math.floor(e/60),s=e%60,i=String(a).padStart(2,"0"),l=String(s).padStart(2,"0");return`${i}:${l}`},getSegmentTimestamp(t){const e=this.formatSecondsToTime(t.beginTime||0),a=this.formatSecondsToTime(t.endTime||0);return`${e} - ${a}`}},mounted(){this.loadFormData()},beforeDestroy(){this.stopPollingTask()}},m=c,d=a(81656),p=(0,d.A)(m,s,i,!1,null,"389ed646",null),g=p.exports}}]);