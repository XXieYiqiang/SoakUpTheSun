# â˜€ï¸ SoakUpTheSun - è§†éšœäººå£«å…¨æ ˆäº‘è¾…åŠ©å¹³å°(æŒç»­å¼€å‘ä¸­)

<div align="center">

[![Spring Cloud](https://img.shields.io/badge/Spring%20Cloud-Alibaba-blue?style=for-the-badge&logo=spring)](https://spring.io/)
[![Go](https://img.shields.io/badge/Go-1.18+-00ADD8?style=for-the-badge&logo=go)](https://go.dev/)
[![Vue.js](https://img.shields.io/badge/Vue.js-2.x-4FC08D?style=for-the-badge&logo=vue.js)](https://vuejs.org/)
[![Python](https://img.shields.io/badge/Python-AI-yellow?style=for-the-badge&logo=python)](https://www.python.org/)

[![Redis](https://img.shields.io/badge/Redis-Redisson-red?logo=redis)](https://redis.io/)
[![RocketMQ](https://img.shields.io/badge/RocketMQ-Messaging-orange?logo=apache)](https://rocketmq.apache.org/)
[![Elasticsearch](https://img.shields.io/badge/Elasticsearch-Search-green?logo=elasticsearch)](https://www.elastic.co/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](https://opensource.org/licenses/MIT)

</div>

<div align="center">
  <strong>
    <a href="README.md">English</a> | 
    <a href="README_CN.md">ä¸­æ–‡è¯´æ˜</a>
  </strong>
</div>

---

> **"Be their eyes, Online." / äº‘ç«¯å€Ÿçœ¼ï¼Œæ¸©æš–è§†ç•Œ**

**SoakUpTheSun** æ˜¯ä¸€ä¸ªåŸºäº **Java + Go + Python** çš„é«˜å¹¶å‘å¼‚æ„å¾®æœåŠ¡å¹³å°ã€‚æˆ‘ä»¬æ‘’å¼ƒäº†ä¼ ç»Ÿçš„çº¿ä¸‹æ•‘æ´æ¨¡å¼ï¼Œæ„å»ºäº†ä¸€å¥—åŸºäº **Go SFU å®æ—¶æµåª’ä½“** + **Redis çƒ­æ± åŒ¹é…** çš„çº¯çº¿ä¸ŠååŠ©ä½“ç³»ã€‚

é€šè¿‡æ•´åˆ **RocketMQ å¼‚æ­¥è§£è€¦**ã€**Lua åŸå­é”** ä¸ **AI è§†è§‰åˆ†æ** æŠ€æœ¯ï¼Œæˆ‘ä»¬è®©è§†éšœäººå£«åªéœ€ç‚¹å‡»å±å¹•ï¼Œå³å¯è·¨è¶Šåœ°åŸŸé™åˆ¶ï¼Œæ¯«ç§’çº§è¿æ¥åˆ°å…¨çƒå¿—æ„¿è€…ã€‚

**ç›®å‰ä¸ºä¸€ä¸ªå­¦ä¹ ç±»å‹çš„é¡¹ç›®ï¼Œæ‚¨å¯ä»¥å­¦ä¹ åˆ°ï¼Œç§’æ€åœºæ™¯ï¼Œå¤§æ‰¹é‡åˆ†å‘ï¼Œç¼“å­˜å‡»ç©¿ï¼Œç¼“å­˜ç©¿é€ï¼Œå³æ—¶é€šè®¯ï¼ŒåŒ¹é…ï¼ŒAIæ¨¡å‹çš„è‡ªéƒ¨ç½²ä½¿ç”¨ç­‰å¸¸è§åœºæ™¯çš„è§£å†³æ–¹æ¡ˆã€‚
æ¯ä¸€ä¸ªåŠŸèƒ½çš„å…·ä½“å®ç°å›¾åŠå…¶åŠŸèƒ½å›¾ç”±äºç¯‡å¹…é—®é¢˜ï¼Œæ— æ³•å…·ä½“å±•ç°ï¼Œæ‚¨å¯ä»¥è”ç³»æœ«å°¾çš„é‚®ç®±ï¼Œæˆ‘å°†æŠŠå®Œæ•´çš„æ¶æ„å›¾å‘é€ç»™æ‚¨ã€‚**
## ğŸ— ç³»ç»Ÿå…¨æ™¯æ¶æ„ (System Topology)

æœ¬ç³»ç»Ÿé‡‡ç”¨å¼‚æ„å¾®æœåŠ¡æ¶æ„ï¼Œæ ¸å¿ƒé“¾è·¯å…¨å¼‚æ­¥åŒ–è®¾è®¡ã€‚

![img.png](readmeImg/img.png)

> **å›¾è§£è¯´æ˜**ï¼šç³»ç»Ÿåˆ†ä¸º Java ä¸šåŠ¡ä¸­å°ã€Go æµåª’ä½“å±‚ä¸ Python AI ç®—åŠ›å±‚ã€‚æ ¸å¿ƒäº¤äº’é€šè¿‡ Redis çƒ­æ± è¿›è¡Œè°ƒåº¦ï¼Œåˆ©ç”¨ RocketMQ å®ç°æµé‡å‰Šå³°ã€‚
> 
> ## ğŸš€ æ ¸å¿ƒåŠŸèƒ½äº®ç‚¹

- **âš¡ï¸ æ¯«ç§’çº§åœ¨çº¿çƒ­æ± åŒ¹é… (Hot Pool Matching)**
  åˆ©ç”¨ `Redis Set` ç»´æŠ¤å®æ—¶åœ¨çº¿å¿—æ„¿è€…æ± ã€‚åŒºåˆ«äºä¼ ç»Ÿæ•°æ®åº“æŸ¥è¯¢ï¼Œæˆ‘ä»¬ä»…åŒ¹é…å½“å‰ä¸»åŠ¨ `activate` çš„ç”¨æˆ·ï¼Œç»“åˆ Elasticsearch å…œåº•ç­–ç•¥ï¼Œç¡®ä¿æ¥é€šç‡ > 99%ã€‚

- **ğŸ¥ è‡ªç ” Go SFU æµåª’ä½“æœåŠ¡**
  åŸºäº Pion æ¡†æ¶æ·±åº¦å®šåˆ¶çš„ SFU æœåŠ¡å™¨ï¼Œæ”¯æŒ WebRTC ä¿¡ä»¤äº¤äº’ä¸ RTP åŒ…è½¬å‘ã€‚é’ˆå¯¹å¼±ç½‘ç¯å¢ƒä¼˜åŒ–ï¼Œç«¯åˆ°ç«¯å»¶è¿Ÿæ§åˆ¶åœ¨ 200ms ä»¥å†…ã€‚

- **ğŸ›¡ï¸ é«˜å¹¶å‘çŸ­é“¾æ¥é˜²å¾¡ä½“ç³»**
  é›†æˆ **å¸ƒéš†è¿‡æ»¤å™¨ (Bloom Filter)** ä¸ **Redis ä»¤ç‰Œæ¡¶**ã€‚åœ¨ç”Ÿæˆ 6 ä½çŸ­ç å‰è¿›è¡Œ O(1) æé€Ÿåˆ¤é‡ï¼Œæœ‰æ•ˆé˜²æ­¢ ID ç¢°æ’ä¸æ¶æ„éå†æ”»å‡»ã€‚

- **ğŸ”„ æµ·é‡æ•°æ®å¼‚æ­¥åˆ‡ç‰‡å¯¼å…¥**
  é‡‡ç”¨ **TaskQueue + å¼‚æ­¥çº¿ç¨‹æ± ** æ–¹æ¡ˆå¤„ç† 10W+ è¡Œçº§åˆ«çš„ Excel å¯¼å…¥ã€‚é€šè¿‡ Mybatis-Plus æ‰¹é‡æ’å…¥ä¸ ES åŒå†™ï¼Œé¿å…é•¿äº‹åŠ¡é”æ­»æ•°æ®åº“ã€‚

- **ğŸ’° Redis Lua åŸå­åº“å­˜ç§’æ€**
  åœ¨å…¬ç›Šå¥–å“å…‘æ¢åœºæ™¯ä¸­ï¼Œå°†â€œæŸ¥è¯¢åº“å­˜â€ä¸â€œæ‰£å‡åº“å­˜â€å°è£…ä¸ºå•ä¸€ Lua è„šæœ¬ï¼Œåœ¨ Redis å•çº¿ç¨‹æ¨¡å‹ä¸­åŸå­æ‰§è¡Œï¼Œå½»åº•æœç»è¶…å–ã€‚

## ğŸ›  æŠ€æœ¯æ ˆæ¸…å•

| é¢†åŸŸ | æŠ€æœ¯é€‰å‹ | æ ¸å¿ƒä½œç”¨ |
| :--- | :--- | :--- |
| **æœåŠ¡æ²»ç†** | Spring Cloud Alibaba | Nacos (æ³¨å†Œ/é…ç½®), OpenFeign (RPC) |
| **éŸ³è§†é¢‘** | **Go (Golang) + Pion** | WebRTC ä¿¡ä»¤äº¤æ¢, RTP åª’ä½“æµè½¬å‘ |
| **AI è®¡ç®—** | Python + OpenCV | è®¡ç®—æœºè§†è§‰åˆ†æ (OCR/ç‰©ä½“è¯†åˆ«) |
| **æŒä¹…åŒ–** | MySQL 8.0 | ä¸šåŠ¡æ•°æ®å­˜å‚¨ |
| **ç¼“å­˜/é”** | Redis (Redisson) | åˆ†å¸ƒå¼é”, **çƒ­æ± (Set)**, **å¸ƒéš†è¿‡æ»¤å™¨**, Luaè„šæœ¬ |
| **æœç´¢** | Elasticsearch 7.x | å¿—æ„¿è€…å¤šç»´åŒ¹é… (Painless Script), å€’æ’ç´¢å¼• |
| **æ¶ˆæ¯é˜Ÿåˆ—** | RocketMQ | å›¾ç‰‡åˆ†æä»»åŠ¡å‰Šå³°, å¼‚æ­¥è§£è€¦, Excelä»»åŠ¡åˆ†å‘ |
| **ä»»åŠ¡è°ƒåº¦** | XXL-Job | åˆ†å¸ƒå¼å®šæ—¶ä»»åŠ¡ (ç§¯åˆ†ç»“ç®—) |
| **å¯¹è±¡å­˜å‚¨** | Tencent COS | å›¾ç‰‡/è§†é¢‘æ–‡ä»¶æµ·é‡å­˜å‚¨ |


## ğŸ§© æ ¸å¿ƒè®¾è®¡éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ (Design Challenges)

### ğŸ”´ éš¾ç‚¹ 1ï¼šé«˜å¹¶å‘ä¸‹çš„â€œè¶…å–â€ä¸â€œæ’å•â€
**åœºæ™¯æè¿°**ï¼šåœ¨ç´§æ€¥å‘¼æ•‘æ¨¡å¼ä¸‹ï¼Œå¤šä¸ªè§†éšœç”¨æˆ·å¯èƒ½åŒæ—¶åŒ¹é…åˆ°åŒä¸€ä¸ªåœ¨çº¿å¿—æ„¿è€…ï¼›æˆ–åœ¨å¥–å“ç§’æ€æ—¶ï¼Œåº“å­˜è¢«æ‰£å‡ä¸ºè´Ÿæ•°ã€‚
**è§£å†³æ–¹æ¡ˆ**ï¼š
* **åŸå­æ€§ä¿éšœ**ï¼šæ”¾å¼ƒ Javaå±‚é¢çš„é”ï¼Œå°†â€œæŸ¥è¯¢çŠ¶æ€â€ä¸â€œé”å®šçŠ¶æ€â€å°è£…ä¸º **Redis Lua è„šæœ¬**ï¼Œåˆ©ç”¨ Redis å•çº¿ç¨‹ç‰¹æ€§å®ç°åŸå­æ‰§è¡Œã€‚
* **åˆ†å¸ƒå¼é”å…œåº•**ï¼šåœ¨ Lua æ‰§è¡ŒæˆåŠŸåï¼Œå¼•å…¥ **Redisson çœ‹é—¨ç‹— (Watchdog)** æœºåˆ¶ï¼Œé˜²æ­¢ä¸šåŠ¡é€»è¾‘æ‰§è¡Œè¶…æ—¶å¯¼è‡´çš„é”å¼‚å¸¸é‡Šæ”¾ï¼Œç¡®ä¿æ•°æ®å¼ºä¸€è‡´æ€§ã€‚

### ğŸŸ¡ éš¾ç‚¹ 2ï¼šçŸ­é“¾æ¥ç³»ç»Ÿçš„å®‰å…¨æ€§ä¸æ€§èƒ½å¹³è¡¡
**åœºæ™¯æè¿°**ï¼šè§†é¢‘æˆ¿é—´é“¾æ¥ä»… 6 ä½å­—ç¬¦ï¼Œææ˜“è¢«é»‘å®¢æš´åŠ›éå†æˆ–å‘ç”Ÿ ID ç¢°æ’ã€‚
**è§£å†³æ–¹æ¡ˆ**ï¼š
* **æé€ŸéªŒé‡**ï¼šå¼•å…¥ **å¸ƒéš†è¿‡æ»¤å™¨ (Bloom Filter)**ï¼Œåœ¨ç”ŸæˆçŸ­ç å‰è¿›è¡Œ O(1) å¤æ‚åº¦çš„å†…å­˜çº§éªŒé‡ï¼Œé˜»æ–­ 99% çš„æ— æ•ˆæ•°æ®åº“æŸ¥è¯¢ã€‚
* **æµé‡æ¸…æ´—**ï¼šé…åˆ **Redis ä»¤ç‰Œæ¡¶ç®—æ³•** å¯¹è¯·æ±‚ IP è¿›è¡Œé™æµï¼Œé˜²æ­¢æ¶æ„æ‰«æã€‚

### ğŸ”µ éš¾ç‚¹ 3ï¼šæµ·é‡ç§¯åˆ†æ•°æ®çš„å…¨é‡ç»“ç®— OOM
**åœºæ™¯æè¿°**ï¼šå¹³å°æ¯æ—¥äº§ç”Ÿæ•°ç™¾ä¸‡æ¡è¯„ä»·æµæ°´ï¼Œå…¨é‡åŠ è½½è‡³å†…å­˜è¿›è¡Œç§¯åˆ†è®¡ç®—ä¼šå¯¼è‡´ JVM é¢‘ç¹ Full GC ç”šè‡³ OOMã€‚
**è§£å†³æ–¹æ¡ˆ**ï¼š
* **æµå¼å¤„ç†**ï¼šæ‘’å¼ƒ `LIMIT offset`ï¼Œè®¾è®¡åŸºäºä¸»é”® ID çš„ **æ¸¸æ ‡åˆ†é¡µ (Cursor Pagination)** æœºåˆ¶ï¼Œä¿è¯æŸ¥è¯¢æ€§èƒ½ä¸éšæ•°æ®é‡å¢åŠ è€Œè¡°å‡ã€‚
* **å†…å­˜èšåˆ**ï¼šåˆ©ç”¨ Java 8 Stream API åœ¨åº”ç”¨å±‚è¿›è¡Œå°æ‰¹æ¬¡èšåˆè®¡ç®—ï¼Œå°† 2000 æ¬¡æ•°æ®åº“ Update åˆå¹¶ä¸º 1 æ¬¡æ‰¹é‡æäº¤ï¼Œå¤§å¹…é™ä½ I/O å¼€é”€ã€‚


## ğŸ“‚ è¯¦ç»†ç›®å½•ç»“æ„ (Detailed Structure)

```bash

SoakUpTheSun/
â”œâ”€â”€ ğŸ“‚ clientService/               # [å‰ç«¯] Vue.js äº¤äº’ç«¯
â”‚   â”œâ”€â”€ public/                     # é™æ€èµ„æº (Markdown CSS, Fonts)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/                    # Axios æ¥å£å°è£… (user.js)
â”‚   â”‚   â”œâ”€â”€ assets/                 # èµ„æºæ–‡ä»¶ (styles, images)
â”‚   â”‚   â”œâ”€â”€ libs/                   # å…¨å±€å·¥å…·åº“ (Map, WebSocketæ’ä»¶)
â”‚   â”‚   â”œâ”€â”€ store/                  # Vuex çŠ¶æ€ç®¡ç† (User, MessageDispatcher)
â”‚   â”‚   â”œâ”€â”€ utils/                  # æ ¸å¿ƒå·¥å…· (auth.js, request.js)
â”‚   â”‚   â””â”€â”€ views/                  # é¡µé¢è§†å›¾ (ChatRoom, JoinRoom, UserHome)
â”‚   â””â”€â”€ vue.config.js               # å‰ç«¯ä»£ç†ä¸æ‰“åŒ…é…ç½®
â”‚
â”œâ”€â”€ ğŸ“‚ sfu/                         # [æµåª’ä½“] Go è‡ªç ” SFU æœåŠ¡å™¨ (WebRTC)
â”‚   â”œâ”€â”€ internal/
â”‚   â”‚   â”œâ”€â”€ api/room/               # æˆ¿é—´ç®¡ç† API (Join, Close, Save)
â”‚   â”‚   â”œâ”€â”€ cache/                  # Redis ç¼“å­˜æ“ä½œå°è£…
â”‚   â”‚   â”œâ”€â”€ config/                 # ç³»ç»Ÿé…ç½® (JWT, MySQL, Log)
â”‚   â”‚   â”œâ”€â”€ ws/                     # WebSocket ä¿¡ä»¤å¤„ç† (æ ¸å¿ƒæ¡æ‰‹é€»è¾‘)
â”‚   â”‚   â””â”€â”€ app/                    # åº”ç”¨ç¨‹åºå¯åŠ¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
â”‚   â”œâ”€â”€ utils/                      # å·¥å…·åŒ… (Base58, JWT, Encrypt)
â”‚   â”œâ”€â”€ config.yaml                 # æµåª’ä½“ç«¯å£ä¸ ICE é…ç½®
â”‚   â””â”€â”€ main.go                     # Go ç¨‹åºå…¥å£
â”‚
â”œâ”€â”€ ğŸ“‚ volunteer/                   # [åç«¯] å¿—æ„¿è€…æ ¸å¿ƒä¸šåŠ¡æ¨¡å— (æœ€æ ¸å¿ƒ)
â”‚   â”œâ”€â”€ src/main/java/org/hgc/suts/volunteer/
â”‚   â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â”‚   â”œâ”€â”€ manager/            # Redis ç®¡ç†å™¨
â”‚   â”‚   â”‚   â””â”€â”€ scheduledTask/      # XXL-Job å®šæ—¶ä»»åŠ¡ (ç§¯åˆ†ç»“ç®—)
â”‚   â”‚   â”œâ”€â”€ controller/             # Web æ¥å£å±‚ (Facadeæ¨¡å¼)
â”‚   â”‚   â”œâ”€â”€ facade/                 # é—¨é¢æ¨¡å¼å°è£…å¤æ‚ä¸šåŠ¡
â”‚   â”‚   â”œâ”€â”€ mq/                     # RocketMQ æ¶ˆæ¯é©±åŠ¨
â”‚   â”‚   â”‚   â”œâ”€â”€ consumer/           # æ¶ˆè´¹è€… (EasyExcelç›‘å¬, ä»»åŠ¡æ‰§è¡Œ)
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ easyExcel/      # âš¡ï¸ å¼‚æ­¥åˆ‡ç‰‡å¯¼å…¥ (ReadExcelDistributionListener)
â”‚   â”‚   â”‚   â”œâ”€â”€ event/              # é¢†åŸŸäº‹ä»¶å¯¹è±¡
â”‚   â”‚   â”‚   â””â”€â”€ producer/           # æ¶ˆæ¯ç”Ÿäº§è€…
â”‚   â”‚   â””â”€â”€ service/
â”‚   â”‚       â”œâ”€â”€ impl/               # ä¸šåŠ¡é€»è¾‘å®ç°
â”‚   â”‚       â”‚   â”œâ”€â”€ VolunteerMatchServiceImpl.java  # ğŸš€ æ··åˆåŒè½¨åŒ¹é…ç­–ç•¥
â”‚   â”‚       â”‚   â””â”€â”€ VolunteerPrizesServiceImpl.java # å¥–å“å…‘æ¢é€»è¾‘
â”‚   â””â”€â”€ src/main/resources/
â”‚       â”œâ”€â”€ lua/                    # âš¡ï¸ Redis åŸå­è„šæœ¬åº“
â”‚       â”‚   â”œâ”€â”€ redeem_volunteer_prizes_stock_synchronize.lua # åº“å­˜æ‰£å‡
â”‚       â”‚   â””â”€â”€ volunteer_active_match.lua                    # çƒ­æ± åŒ¹é…
â”‚       â””â”€â”€ scripts/
â”‚           â””â”€â”€ volunteer_match.painless  # ğŸ” ES åŠ¨æ€æƒé‡æ‰“åˆ†è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ“‚ picture/                     # [åç«¯] å›¾ç‰‡å¤„ç†ä¸ AI å¯¹æ¥æœåŠ¡
â”‚   â”œâ”€â”€ src/main/java/org/hgc/suts/picture/
â”‚   â”‚   â”œâ”€â”€ common/tensentCos/      # è…¾è®¯äº‘ COS å¯¹è±¡å­˜å‚¨å°è£…
â”‚   â”‚   â”œâ”€â”€ mq/consumer/            # ç›‘å¬å›¾ç‰‡ä¸Šä¼ /è§†é¢‘å¸§åˆ†ææ¶ˆæ¯
â”‚   â”‚   â””â”€â”€ ws/                     # AI å®æ—¶åˆ†æ WebSocket é€šé“
â”‚
â”œâ”€â”€ ğŸ“‚ user/                        # [åç«¯] ç”¨æˆ·è®¤è¯ä¸é‰´æƒä¸­å¿ƒ
â”‚   â”œâ”€â”€ src/main/java/org/hgc/suts/user/
â”‚   â”‚   â”œâ”€â”€ common/biz/user/        # UserContext ä¸Šä¸‹æ–‡ä¸æ‹¦æˆªå™¨
â”‚   â”‚   â””â”€â”€ remote/                 # OpenFeign è¿œç¨‹è°ƒç”¨å®¢æˆ·ç«¯
â”‚
â”œâ”€â”€ ğŸ“‚ shortlink/                   # [åç«¯] çŸ­é“¾æ¥ç”ŸæˆæœåŠ¡
â”‚   â””â”€â”€ src/main/java/org/hgc/suts/shortlink/
â”‚       â”œâ”€â”€ config/                 # ğŸ›¡ï¸ å¸ƒéš†è¿‡æ»¤å™¨é…ç½® (RBloomFilter)
â”‚       â””â”€â”€ service/impl/           # çŸ­ç ç”Ÿæˆä¸ 302 è·³è½¬é€»è¾‘
â”‚
â”œâ”€â”€ ğŸ“‚ docs/                        # é¡¹ç›®æ–‡æ¡£èµ„æº
â””â”€â”€ pom.xml                         # Maven çˆ¶å·¥ç¨‹ä¾èµ–ç®¡ç†
```
## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
* JDK 17+ / Go 1.25+
* MySQL 8.0 / Redis 5.0+ / RocketMQ 5+
* Nacos 2.0+

### éƒ¨ç½²æ­¥éª¤

**1. åŸºç¡€è®¾æ–½å¯åŠ¨**
```bash

docker-compose up -d mysql redis rocketmq nacos elasticsearch
cd clientService && npm install && npm run serve
---
```


## ğŸ¤ è´¡çŒ®ä¸è”ç³»

**SoakUpTheSun** æ˜¯ä¸€ä¸ªæŠ€æœ¯é©±åŠ¨çš„å…¬ç›Šé¡¹ç›®ã€‚å¦‚æœä½ å¯¹ **æ— éšœç¢è®¾è®¡** æˆ– **é«˜å¯ç”¨æ¶æ„** æ„Ÿå…´è¶£ï¼Œæ¬¢è¿æäº¤ PRã€‚

* **Author:** XXieYiqiang
* **Email:** a1103938364@gmail.com

---
*å¦‚æœä½ å–œæ¬¢çš„è¯ï¼Œå¸Œæœ›ä½ èƒ½ç»™æˆ‘ä¸€é¢—star*
